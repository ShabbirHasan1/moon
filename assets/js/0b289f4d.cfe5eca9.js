"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[21575],{46049:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>m,frontMatter:()=>i,metadata:()=>c,toc:()=>u});var r=t(24246),s=t(71670),a=t(33337),o=t(39798);const i={slug:"v0.17",title:"moon v0.17 - Webhooks, extended YAML, and improved runtime performance",authors:["milesj"],tags:["notifier","runner","config","editors","vscode"],image:"./img/v0.17.png"},l=void 0,c={permalink:"/blog/v0.17",editUrl:"https://github.com/moonrepo/moon/tree/master/website/blog/2022-10-21_v0.17.mdx",source:"@site/blog/2022-10-21_v0.17.mdx",title:"moon v0.17 - Webhooks, extended YAML, and improved runtime performance",description:"With this release, we're landing the first iteration of our notifier service, starting with",date:"2022-10-21T00:00:00.000Z",tags:[{inline:!0,label:"notifier",permalink:"/blog/tags/notifier"},{inline:!0,label:"runner",permalink:"/blog/tags/runner"},{inline:!0,label:"config",permalink:"/blog/tags/config"},{inline:!0,label:"editors",permalink:"/blog/tags/editors"},{inline:!0,label:"vscode",permalink:"/blog/tags/vscode"}],readingTime:3.18,hasTruncateMarker:!0,authors:[{name:"Miles Johnson",title:"Founder, developer",url:"https://github.com/milesj",imageURL:"/img/authors/miles.jpg",key:"milesj"}],frontMatter:{slug:"v0.17",title:"moon v0.17 - Webhooks, extended YAML, and improved runtime performance",authors:["milesj"],tags:["notifier","runner","config","editors","vscode"],image:"./img/v0.17.png"},unlisted:!1,prevItem:{title:"moon v0.18 - Improved configuration and initialization flow",permalink:"/blog/v0.18"},nextItem:{title:"New VS Code extension!",permalink:"/blog/vscode-extension"}},d={image:t(16518).Z,authorsImageUrls:[void 0]},u=[{value:"Breaking changes",id:"breaking-changes",level:2},{value:"Minor changes to ID formatting",id:"minor-changes-to-id-formatting",level:3},{value:"Task <code>type</code> has been renamed to <code>platform</code>",id:"task-type-has-been-renamed-to-platform",level:3},{value:"Webhook events (experimental)",id:"webhook-events-experimental",level:2},{value:"YAML anchors and aliases",id:"yaml-anchors-and-aliases",level:2},{value:"VS Code extension",id:"vs-code-extension",level:2},{value:"Other changes",id:"other-changes",level:2},{value:"What&#39;s next?",id:"whats-next",level:2}];function h(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"With this release, we're landing the first iteration of our notifier service, starting with\nwebhooks! We've also spent some time working on quality of life improvements."}),"\n",(0,r.jsx)(n.h2,{id:"breaking-changes",children:"Breaking changes"}),"\n",(0,r.jsx)(n.p,{children:"To start, we have a few breaking changes this release to be aware of!"}),"\n",(0,r.jsx)(n.h3,{id:"minor-changes-to-id-formatting",children:"Minor changes to ID formatting"}),"\n",(0,r.jsx)(n.p,{children:"An ID refers to many things \u2014 project names, task names, target segments, so on and so forth. When\nparsing these values, we format them to remove unwanted characters, as these IDs are used in many\ncontexts, many of which need to be strict."}),"\n",(0,r.jsxs)(n.p,{children:["Previously, we would remove unwanted characters entirely. Instead, we now replace them with dashes\n(",(0,r.jsx)(n.code,{children:"-"}),") for better readability. Take the following for example:"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"ID"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Old"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"New"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"domain.com"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"domaincom"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"domain-com"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{style:{textAlign:"left"},children:["build",":esm"]}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"buildesm"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"build-esm"})]})]})]}),"\n",(0,r.jsxs)(n.h3,{id:"task-type-has-been-renamed-to-platform",children:["Task ",(0,r.jsx)(n.code,{children:"type"})," has been renamed to ",(0,r.jsx)(n.code,{children:"platform"})]}),"\n",(0,r.jsxs)(n.p,{children:["This setting was renamed for a few reasons. To start, tasks actually have a\n",(0,r.jsx)(n.a,{href:"../docs/concepts/task#types",children:"type internally"})," that is not configured, but is inferred based on\nwhat's configured. This was a bit confusing."]}),"\n",(0,r.jsx)(n.p,{children:"And secondly, our toolchain refers to language integrations as platforms, and since this setting\ndetermines which tool to run with, we wanted to align on the platform terminology."}),"\n",(0,r.jsxs)(a.Z,{groupId:"task-type",defaultValue:"before",values:[{label:"Before",value:"before"},{label:"After",value:"after"}],children:[(0,r.jsx)(o.Z,{value:"before",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"tasks:\n  clean:\n    command: 'rm -rf ./dist'\n    type: 'system'\n"})})}),(0,r.jsx)(o.Z,{value:"after",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"tasks:\n  clean:\n    command: 'rm -rf ./dist'\n    platform: 'system'\n"})})})]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["Because of this change, the ",(0,r.jsx)(n.code,{children:"$taskType"})," token was also renamed to ",(0,r.jsx)(n.code,{children:"$taskPlatform"}),"!"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"webhook-events-experimental",children:"Webhook events (experimental)"}),"\n",(0,r.jsx)(n.p,{children:"Looking to gather metrics for your pipelines? Gain insight into run durations and failures? Maybe\nyou want to send Slack or Discord notifications? With our new notifier system, this is now possible\nthrough webhooks!"}),"\n",(0,r.jsxs)(n.p,{children:["Simply enable the ",(0,r.jsx)(n.a,{href:"../docs/config/workspace#webhookurl",children:(0,r.jsx)(n.code,{children:"notifier.webhookUrl"})})," setting to start\nreceiving events from your CI environments."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title=".moon/workspace.yml"',children:"notifier:\n  webhookUrl: 'https://api.company.com/some/endpoint'\n"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["View the ",(0,r.jsx)(n.a,{href:"../docs/guides/webhooks",children:"official guide on webhooks"})," for a full list of events and an\nexample payload structure!"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"yaml-anchors-and-aliases",children:"YAML anchors and aliases"}),"\n",(0,r.jsxs)(n.p,{children:["We've updated our YAML configuration files to support extended syntax,\n",(0,r.jsxs)(n.a,{href:"https://support.atlassian.com/bitbucket-cloud/docs/yaml-anchors/",children:["anchors (",(0,r.jsx)(n.code,{children:"&"}),") and aliases (",(0,r.jsx)(n.code,{children:"*"}),")"]}),".\nWith this new syntax, you're now able to reduce the amount of duplication required in your config\nfiles, especially when declaring tasks, as demonstrated below!"]}),"\n",(0,r.jsxs)(a.Z,{groupId:"yaml",defaultValue:"before",values:[{label:"Before",value:"before"},{label:"After",value:"after"}],children:[(0,r.jsx)(o.Z,{value:"before",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"tasks:\n  astro:\n    command: 'astro'\n    local: true\n\n  dev:\n    command: 'astro dev'\n    inputs:\n      - '@group(astro)'\n    local: true\n\n  build:\n    command: 'astro build'\n    inputs:\n      - '@group(astro)'\n    outputs:\n      - 'dist'\n\n  check:\n    command: 'astro check'\n    inputs:\n      - '@group(astro)'\n    deps:\n      - '~:typecheck'\n\n  preview:\n    command: 'astro preview'\n    inputs:\n      - '@group(astro)'\n    deps:\n      - '~:build'\n    local: true\n"})})}),(0,r.jsx)(o.Z,{value:"after",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"_astro: &astro\n  command: 'astro'\n  inputs:\n    - '@group(astro)'\n\ntasks:\n  dev:\n    <<: *astro\n    args: 'dev'\n    local: true\n\n  build:\n    <<: *astro\n    args: 'build'\n    outputs:\n      - 'dist'\n\n  check:\n    <<: *astro\n    args: 'check'\n\n  preview:\n    <<: *astro\n    args: 'preview'\n    deps:\n      - '~:build'\n    local: true\n"})})})]}),"\n",(0,r.jsx)(n.h2,{id:"vs-code-extension",children:"VS Code extension"}),"\n",(0,r.jsxs)(n.p,{children:["If you missed the ",(0,r.jsx)(n.a,{href:"./vscode-extension",children:"announcement earlier this week"}),", we released the initial\nversion of our new VS Code extension! Give it a try and\n",(0,r.jsx)(n.a,{href:"../docs/editors/vscode",children:"refer to the documentation"})," for more information."]}),"\n",(0,r.jsx)(n.h2,{id:"other-changes",children:"Other changes"}),"\n",(0,r.jsxs)(n.p,{children:["View the\n",(0,r.jsx)(n.a,{href:"https://github.com/moonrepo/moon/releases/tag/%40moonrepo%2Fcli%400.17.0",children:"official release"})," for a\nfull list of changes."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Increased runtime performance and reduced memory consumption."}),"\n",(0,r.jsxs)(n.li,{children:["Template enum variables can now define objects for their\n",(0,r.jsx)(n.a,{href:"../docs/config/template#values",children:(0,r.jsx)(n.code,{children:"values"})}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Task ",(0,r.jsx)(n.code,{children:"deps"})," can now omit the ",(0,r.jsx)(n.code,{children:"~:"})," prefix for tasks within the current project."]}),"\n",(0,r.jsxs)(n.li,{children:["The ",(0,r.jsx)(n.code,{children:"moon check"})," command can now use the ",(0,r.jsx)(n.code,{children:"--report"})," option."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"whats-next",children:"What's next?"}),"\n",(0,r.jsx)(n.p,{children:"Expect the following in the v0.18 release!"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Workflow improvements for ",(0,r.jsx)(n.code,{children:"moon init"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"Benchmarks and performance tuning."}),"\n",(0,r.jsx)(n.li,{children:"Individual stdout/stderr log files when running tasks."}),"\n"]})]})}function m(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},39798:(e,n,t)=>{t.d(n,{Z:()=>o});t(27378);var r=t(40624);const s={tabItem:"tabItem_wHwb"};var a=t(24246);function o(e){let{children:n,hidden:t,className:o}=e;return(0,a.jsx)("div",{role:"tabpanel",className:(0,r.Z)(s.tabItem,o),hidden:t,children:n})}},33337:(e,n,t)=>{t.d(n,{Z:()=>m});var r=t(27378),s=t(40624),a=t(83457),o=t(35595),i=t(76457);const l={tabList:"tabList_J5MA",tabItem:"tabItem_l0OV"};var c=t(24246);function d(e){let{className:n,block:t,selectedValue:r,selectValue:o,tabValues:i}=e;const d=[],{blockElementScrollPositionUntilNextRender:u}=(0,a.o5)(),h=e=>{const n=e.currentTarget,t=d.indexOf(n),s=i[t].value;s!==r&&(u(n),o(s))},m=e=>{let n=null;switch(e.key){case"Enter":h(e);break;case"ArrowRight":{const t=d.indexOf(e.currentTarget)+1;n=d[t]??d[0];break}case"ArrowLeft":{const t=d.indexOf(e.currentTarget)-1;n=d[t]??d[d.length-1];break}}n?.focus()};return(0,c.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.Z)("tabs",{"tabs--block":t},n),children:i.map((e=>{let{value:n,label:t,attributes:a}=e;return(0,c.jsx)("li",{role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:e=>d.push(e),onKeyDown:m,onClick:h,...a,className:(0,s.Z)("tabs__item",l.tabItem,a?.className,{"tabs__item--active":r===n}),children:t??n},n)}))})}function u(e){let{lazy:n,children:t,selectedValue:s}=e;const a=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=a.find((e=>e.props.value===s));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return(0,c.jsx)("div",{className:"margin-top--md",children:a.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==s})))})}function h(e){const n=(0,o.Y)(e);return(0,c.jsxs)("div",{className:(0,s.Z)("tabs-container",l.tabList),children:[(0,c.jsx)(d,{...n,...e}),(0,c.jsx)(u,{...n,...e})]})}function m(e){const n=(0,i.Z)();return(0,c.jsx)(h,{...e,children:(0,o.h)(e.children)},String(n))}},35595:(e,n,t)=>{t.d(n,{Y:()=>m,h:()=>c});var r=t(27378),s=t(3620),a=t(9834),o=t(30654),i=t(70784),l=t(55643);function c(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function d(e){const{values:n,children:t}=e;return(0,r.useMemo)((()=>{const e=n??function(e){return c(e).map((e=>{let{props:{value:n,label:t,attributes:r,default:s}}=e;return{value:n,label:t,attributes:r,default:s}}))}(t);return function(e){const n=(0,i.l)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function u(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function h(e){let{queryString:n=!1,groupId:t}=e;const a=(0,s.k6)(),i=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,o._X)(i),(0,r.useCallback)((e=>{if(!i)return;const n=new URLSearchParams(a.location.search);n.set(i,e),a.replace({...a.location,search:n.toString()})}),[i,a])]}function m(e){const{defaultValue:n,queryString:t=!1,groupId:s}=e,o=d(e),[i,c]=(0,r.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!u({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const r=t.find((e=>e.default))??t[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:o}))),[m,f]=h({queryString:t,groupId:s}),[p,g]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[s,a]=(0,l.Nk)(t);return[s,(0,r.useCallback)((e=>{t&&a.set(e)}),[t,a])]}({groupId:s}),b=(()=>{const e=m??p;return u({value:e,tabValues:o})?e:null})();(0,a.Z)((()=>{b&&c(b)}),[b]);return{selectedValue:i,selectValue:(0,r.useCallback)((e=>{if(!u({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);c(e),f(e),g(e)}),[f,g,o]),tabValues:o}}},16518:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/v0.17-b3ee056e98fbfd5e347375782f5dd335.png"},71670:(e,n,t)=>{t.d(n,{Z:()=>i,a:()=>o});var r=t(27378);const s={},a=r.createContext(s);function o(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);