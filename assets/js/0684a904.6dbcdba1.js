"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[50670],{25408:(e,o,n)=>{n.r(o),n.d(o,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>s,metadata:()=>r,toc:()=>d});var t=n(24246),i=n(71670);const s={slug:"proto-v0.9",title:"proto v0.9 - New GitHub action, plugin unpacking, and more",authors:["milesj"],tags:["proto","action","github"],image:"./img/proto/v0.9.png"},a=void 0,r={permalink:"/blog/proto-v0.9",editUrl:"https://github.com/moonrepo/moon/tree/master/website/blog/2023-05-23_proto-v0.9.mdx",source:"@site/blog/2023-05-23_proto-v0.9.mdx",title:"proto v0.9 - New GitHub action, plugin unpacking, and more",description:"This is a small release that provides many internal improvements.",date:"2023-05-23T00:00:00.000Z",tags:[{inline:!0,label:"proto",permalink:"/blog/tags/proto"},{inline:!0,label:"action",permalink:"/blog/tags/action"},{inline:!0,label:"github",permalink:"/blog/tags/github"}],readingTime:1.68,hasTruncateMarker:!0,authors:[{name:"Miles Johnson",title:"Founder, developer",url:"https://github.com/milesj",imageURL:"/img/authors/miles.jpg",key:"milesj"}],frontMatter:{slug:"proto-v0.9",title:"proto v0.9 - New GitHub action, plugin unpacking, and more",authors:["milesj"],tags:["proto","action","github"],image:"./img/proto/v0.9.png"},unlisted:!1,prevItem:{title:"moon v1.7 - Next-generation configuration and errors",permalink:"/blog/moon-v1.7"},nextItem:{title:"moon v1.6 - Persistent tasks and task extending RFC",permalink:"/blog/moon-v1.6"}},l={image:n(17498).Z,authorsImageUrls:[void 0]},d=[{value:"New <code>moonrepo/setup-proto</code> GitHub action",id:"new-moonreposetup-proto-github-action",level:2},{value:"Added <code>install.unpack</code> to TOML plugin",id:"added-installunpack-to-toml-plugin",level:2},{value:"Initial support for <code>node-gyp</code>",id:"initial-support-for-node-gyp",level:2},{value:"Other changes",id:"other-changes",level:2}];function c(e){const o={a:"a",blockquote:"blockquote",code:"code",h2:"h2",p:"p",pre:"pre",...(0,i.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.p,{children:"This is a small release that provides many internal improvements."}),"\n",(0,t.jsxs)(o.h2,{id:"new-moonreposetup-proto-github-action",children:["New ",(0,t.jsx)(o.code,{children:"moonrepo/setup-proto"})," GitHub action"]}),"\n",(0,t.jsxs)(o.p,{children:["If you're using proto in GitHub Actions and would love to automate the workflow as much as possible,\nwell look no further, as we're introducing the\n",(0,t.jsx)(o.a,{href:"https://github.com/moonrepo/setup-proto",children:"moonrepo/setup-proto"})," action. Thanks to\n",(0,t.jsx)(o.a,{href:"https://github.com/tomdavidson",children:"Tom Davidson"})," for the initial spike of work!"]}),"\n",(0,t.jsxs)(o.p,{children:["This action will automatically install the ",(0,t.jsx)(o.code,{children:"proto"})," binary globally, and cache the toolchain at\n",(0,t.jsx)(o.code,{children:"~/.proto"})," (be sure to run ",(0,t.jsx)(o.code,{children:"proto use"})," to download and install tools)."]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-yaml",children:"# ...\njobs:\n  ci:\n    name: 'CI'\n    runs-on: 'ubuntu-latest'\n    steps:\n      - uses: 'actions/checkout@v4'\n      - uses: 'moonrepo/setup-proto@v0'\n      - run: 'proto use'\n"})}),"\n",(0,t.jsxs)(o.blockquote,{children:["\n",(0,t.jsxs)(o.p,{children:["If you're using moon, be sure to use\n",(0,t.jsx)(o.a,{href:"https://github.com/moonrepo/setup-moon-action",children:"moonrepo/setup-moon"})," instead."]}),"\n"]}),"\n",(0,t.jsxs)(o.h2,{id:"added-installunpack-to-toml-plugin",children:["Added ",(0,t.jsx)(o.code,{children:"install.unpack"})," to TOML plugin"]}),"\n",(0,t.jsxs)(o.p,{children:["Our ",(0,t.jsx)(o.a,{href:"./proto-v0.7#toml-plugins",children:"TOML plugins"})," have been quite popular, and the community has been\nusing them to much success. However, the plugin assumed that all downloaded files are archives (tar,\nzip) and will attempt to unpack them based on file extension. This is not always the case, as some\ndownloads are just raw executables."]}),"\n",(0,t.jsxs)(o.p,{children:["Because of this, unpacking would sometimes fail, or we'd be unable to extract the correct file\nextension. To work around this limitation, we're introducing a new setting, ",(0,t.jsx)(o.code,{children:"install.unpack"}),", that\ncontrols whether the downloaded file should be unpacked or not. By default this setting is ",(0,t.jsx)(o.code,{children:"true"}),"."]}),"\n",(0,t.jsxs)(o.p,{children:["Here's an example using ",(0,t.jsx)(o.a,{href:"/moon",children:"moon"}),"."]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-toml",children:'# ...\n\n[platform.linux]\ndownload-file = "moon-{arch}-unknown-linux-{libc}"\n\n[platform.macos]\ndownload-file = "moon-{arch}-apple-darwin"\n\n[platform.windows]\ndownload-file = "moon-{arch}-pc-windows-msvc.exe"\n\n[install]\ndownload-url = "https://github.com/moonrepo/moon/releases/download/v{version}/{download_file}"\nunpack = false\n'})}),"\n",(0,t.jsxs)(o.h2,{id:"initial-support-for-node-gyp",children:["Initial support for ",(0,t.jsx)(o.code,{children:"node-gyp"})]}),"\n",(0,t.jsxs)(o.p,{children:["The ",(0,t.jsxs)(o.a,{href:"https://github.com/nodejs/node-gyp",children:[(0,t.jsx)(o.code,{children:"node-gyp"})," binary"]})," is required for building Node.js native\naddons, and was previously not supported in proto. We will now create a ",(0,t.jsx)(o.code,{children:"node-gyp"})," binary in\n",(0,t.jsx)(o.code,{children:"~/.proto/bin"})," when the ",(0,t.jsx)(o.code,{children:"npm"})," tool is installed. Why npm? Because ",(0,t.jsx)(o.code,{children:"node-gyp"})," comes packaged with npm\ninstead of Node.js... for some reason."]}),"\n",(0,t.jsx)(o.p,{children:"With that being said, this is currently experimental, as we haven't tested it thoroughly, and are\nunaware of all the possible edge cases. So keep that in mind!"}),"\n",(0,t.jsx)(o.h2,{id:"other-changes",children:"Other changes"}),"\n",(0,t.jsxs)(o.p,{children:["View the ",(0,t.jsx)(o.a,{href:"https://github.com/moonrepo/proto/releases/tag/v0.9.0",children:"official release"})," for a full list\nof changes."]})]})}function p(e={}){const{wrapper:o}={...(0,i.a)(),...e.components};return o?(0,t.jsx)(o,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},17498:(e,o,n)=>{n.d(o,{Z:()=>t});const t=n.p+"assets/images/v0.9-c189afd32d83182c9ce2677593363d17.png"},71670:(e,o,n)=>{n.d(o,{Z:()=>r,a:()=>a});var t=n(27378);const i={},s=t.createContext(i);function a(e){const o=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function r(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(s.Provider,{value:o},e.children)}}}]);