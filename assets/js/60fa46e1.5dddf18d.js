"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[64043],{51448:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>m,frontMatter:()=>a,metadata:()=>i,toc:()=>c});var t=s(24246),o=s(71670);const a={slug:"moon-v1.1",title:"moon v1.1 - Task debugging and improvements",authors:["milesj"],tags:["tokens","tasks"],image:"./img/moon/v1.1.png"},r=void 0,i={permalink:"/blog/moon-v1.1",editUrl:"https://github.com/moonrepo/moon/tree/master/website/blog/2023-04-03_moon-v1.1.mdx",source:"@site/blog/2023-04-03_moon-v1.1.mdx",title:"moon v1.1 - Task debugging and improvements",description:"With this release, we're introducing some quality of life task improvements.",date:"2023-04-03T00:00:00.000Z",tags:[{inline:!0,label:"tokens",permalink:"/blog/tags/tokens"},{inline:!0,label:"tasks",permalink:"/blog/tags/tasks"}],readingTime:1.775,hasTruncateMarker:!0,authors:[{name:"Miles Johnson",title:"Founder, developer",url:"https://github.com/milesj",imageURL:"/img/authors/miles.jpg",key:"milesj"}],frontMatter:{slug:"moon-v1.1",title:"moon v1.1 - Task debugging and improvements",authors:["milesj"],tags:["tokens","tasks"],image:"./img/moon/v1.1.png"},unlisted:!1,prevItem:{title:"proto v0.5 - Version aliasing and global binaries",permalink:"/blog/proto-v0.5"},nextItem:{title:"proto v0.4 - Rust support, user configs, and more",permalink:"/blog/proto-v0.4"}},l={image:s(14943).Z,authorsImageUrls:[void 0]},c=[{value:"Token variable support in task commands",id:"token-variable-support-in-task-commands",level:2},{value:"Run targets in closest project",id:"run-targets-in-closest-project",level:2},{value:"View resolved task information",id:"view-resolved-task-information",level:2},{value:"Other changes",id:"other-changes",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"With this release, we're introducing some quality of life task improvements."}),"\n",(0,t.jsx)(n.h2,{id:"token-variable-support-in-task-commands",children:"Token variable support in task commands"}),"\n",(0,t.jsxs)(n.p,{children:["moon supports a concept known as ",(0,t.jsx)(n.a,{href:"/docs/concepts/token",children:"tokens"})," where values are injected into tasks\nduring project graph creation. This allows for dynamic values in your tasks, such as the current\nproject language, or the current task name, and is crucial for task inheritance to work."]}),"\n",(0,t.jsx)(n.p,{children:"However, tokens were only supported by task args, inputs, and outputs, but not commands... until\nnow. Commands can now use token variables (but not token functions). For example, this is useful for\nreferencing shared scripts from the workspace root."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="moon.yml"',children:"tasks:\n  precheck:\n    command: '$workspaceRoot/scripts/precheck.sh'\n"})}),"\n",(0,t.jsx)(n.h2,{id:"run-targets-in-closest-project",children:"Run targets in closest project"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.a,{href:"/docs/commands/run",children:(0,t.jsx)(n.code,{children:"moon run"})})," command can run targets in an array of different formats, but\nwas unable to run targets based on the current working directory. Well no more! You can now run\ntasks from the closest project based on file path by omitting ",(0,t.jsx)(n.code,{children:":"})," from the target name."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"$ cd packages/components\n\n# Runs `components:build` internally\n$ moon run build\n"})}),"\n",(0,t.jsx)(n.h2,{id:"view-resolved-task-information",children:"View resolved task information"}),"\n",(0,t.jsxs)(n.p,{children:["Debugging task issues can be a quite a pain, as there can be many points of failure. Are inputs too\ngreedy? Are outputs not being created? Does it exist at all? To help with this, you can now view\ntask information by running ",(0,t.jsx)(n.a,{href:"/docs/commands/task",children:(0,t.jsx)(n.code,{children:"moon task <target>"})}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"$ moon task app:build\n"})}),"\n",(0,t.jsxs)(n.p,{children:["This command will display ",(0,t.jsx)(n.em,{children:"resolved"})," information, including inherited settings, and path resolved\ninputs and outputs. Here's an example:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"RUNTIME:BUILD\n\nID: build\nProject: runtime\nPlatform: node\nType: build\n\nPROCESS\n\nCommand: packemon build --addFiles --addExports --declaration\nEnvironment variables:\n - NODE_ENV = production\nWorking directory: /Projects/moon/packages/runtime\nRuns dependencies: Concurrently\nRuns in CI: Yes\n\nDEPENDS ON\n\n - types:build\n\nINPUTS\n\n - .moon/*.yml\n - packages/runtime/src/**/*\n - packages/runtime/tsconfig.*.json\n - packages/runtime/types/**/*\n - packages/runtime/package.json\n - packages/runtime/tsconfig.json\n - tsconfig.options.json\n\nOUTPUTS\n\n - packages/runtime/cjs\n"})}),"\n",(0,t.jsx)(n.h2,{id:"other-changes",children:"Other changes"}),"\n",(0,t.jsxs)(n.p,{children:["View the ",(0,t.jsx)(n.a,{href:"https://github.com/moonrepo/moon/releases/tag/v1.1.0",children:"official release"})," for a full list of\nchanges."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Support pnpm v8's new lockfile format."}),"\n",(0,t.jsxs)(n.li,{children:["Better handling for task's that execute the ",(0,t.jsx)(n.code,{children:"moon"})," binary."]}),"\n",(0,t.jsxs)(n.li,{children:["Updated ",(0,t.jsx)(n.code,{children:"noop"})," tasks to be cacheable, so that they can be used for cache hit early returns."]}),"\n"]})]})}function m(e={}){const{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},14943:(e,n,s)=>{s.d(n,{Z:()=>t});const t=s.p+"assets/images/v1.1-1447beccba44240528518a0af56c91f2.png"},71670:(e,n,s)=>{s.d(n,{Z:()=>i,a:()=>r});var t=s(27378);const o={},a=t.createContext(o);function r(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);