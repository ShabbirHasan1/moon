"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[29769],{66950:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>h,contentTitle:()=>d,default:()=>u,frontMatter:()=>l,metadata:()=>c,toc:()=>g});var t=a(24246),o=a(71670),i=a(27378),r=a(26675);function s(){const e=(0,i.useRef)(null);return(0,i.useEffect)((()=>{e.current&&(0,r.A)(e.current,{edges:[{data:{source:"node",target:"node-lang"}},{data:{source:"node",target:"node-platform"}},{data:{source:"node",target:"node-tool"}},{data:{source:"node-platform",target:"node-lang"}},{data:{source:"node-tool",target:"node-lang"}},{data:{source:"node-platform",target:"node-tool"}},{data:{source:"deno",target:"deno-lang"}},{data:{source:"deno",target:"deno-platform"}},{data:{source:"deno-platform",target:"deno-lang"}},{data:{source:"bun",target:"bun-lang"}},{data:{source:"moon",target:"system"}},{data:{source:"moon",target:"go"}},{data:{source:"moon",target:"bun"}},{data:{source:"moon",target:"deno"}},{data:{source:"moon",target:"node"}}],nodes:[{data:{id:"moon",label:"moon",type:"xl"}},{data:{id:"system",label:"System (Fallback)",type:"md"}},{data:{id:"node",label:"Node (Tier 3)",type:"lg"}},{data:{id:"node-lang",label:"Language (1)"}},{data:{id:"node-platform",label:"Platform (2)"}},{data:{id:"node-tool",label:"Toolchain (3)"}},{data:{id:"deno",label:"Deno (Tier 2)",type:"lg"}},{data:{id:"deno-lang",label:"Language (1)"}},{data:{id:"deno-platform",label:"Platform (2)"}},{data:{id:"bun",label:"Bun (Tier 1)",type:"lg"}},{data:{id:"bun-lang",label:"Language (1)"}},{data:{id:"go",label:"Go (Tier 0)",type:"lg"}}]})}),[]),(0,t.jsx)("div",{id:"lang-graph",ref:e,className:"p-1 mb-2 rounded bg-slate-800",style:{height:"600px",width:"100%"}})}const l={title:"Languages"},d=void 0,c={id:"how-it-works/languages",title:"Languages",description:"Although moon is currently focusing on the JavaScript ecosystem, our long-term vision is to be a",source:"@site/docs/how-it-works/languages.mdx",sourceDirName:"how-it-works",slug:"/how-it-works/languages",permalink:"/docs/how-it-works/languages",draft:!1,unlisted:!1,editUrl:"https://github.com/moonrepo/moon/tree/master/website/docs/how-it-works/languages.mdx",tags:[],version:"current",frontMatter:{title:"Languages"},sidebar:"docs",previous:{title:"How it works",permalink:"/docs/how-it-works"},next:{title:"Project graph",permalink:"/docs/how-it-works/project-graph"}},h={},g=[{value:"Enabling a language",id:"enabling-a-language",level:2},{value:"System language and platform",id:"system-language-and-platform",level:2},{value:"Tier structure and responsibilities",id:"tier-structure-and-responsibilities",level:2},{value:"Tier 0 = Unsupported",id:"tier-0--unsupported",level:3},{value:"Tier 1 = Language",id:"tier-1--language",level:3},{value:"Tier 2 = Platform",id:"tier-2--platform",level:3},{value:"Tier 3 = Toolchain",id:"tier-3--toolchain",level:3}];function p(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["Although moon is currently focusing on the JavaScript ecosystem, our long-term vision is to be a\nmulti-language task runner and monorepo management tool. To that end, we've designed our languages\nto work like plugins, where their functionality is implemented in isolation, and is ",(0,t.jsx)(n.em,{children:"opt-in"}),"."]}),"\n",(0,t.jsx)(s,{}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsx)(n.p,{children:"We do not support third-party language plugins at this time, but are working towards it!"})}),"\n",(0,t.jsx)(n.h2,{id:"enabling-a-language",children:"Enabling a language"}),"\n",(0,t.jsxs)(n.p,{children:["moon ",(0,t.jsx)(n.a,{href:"../#supported-languages",children:"supported languages"})," are opt-in, and ",(0,t.jsx)(n.em,{children:"are not"})," enabled by default. We\nchose this pattern to avoid unnecessary overhead, especially for the future when we have 10 or more\nbuilt-in languages."]}),"\n",(0,t.jsxs)(n.p,{children:["To enable a supported language, simply define a configuration block with the language's name in\n",(0,t.jsx)(n.a,{href:"../config/toolchain",children:(0,t.jsx)(n.code,{children:".moon/toolchain.yml"})}),". Even an empty block will enable the language."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title=".moon/toolchain.yml"',children:"# Enable Node.js\nnode: {}\n\n# Enable Node.js with custom settings\nnode:\n  packageManager: 'pnpm'\n\n# Enable Deno\ndeno: {}\n"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"For unsupported languages, use the system platform. Continue reading to learn more!"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"system-language-and-platform",children:"System language and platform"}),"\n",(0,t.jsxs)(n.p,{children:["When working with moon, you'll most likely have tasks that run built-in system commands that do not\nbelong to any of the supported languages. For example, you may have a task that runs ",(0,t.jsx)(n.code,{children:"git"})," or\n",(0,t.jsx)(n.code,{children:"docker"})," commands, or common commands like ",(0,t.jsx)(n.code,{children:"rm"}),", ",(0,t.jsx)(n.code,{children:"cp"}),", ",(0,t.jsx)(n.code,{children:"mv"}),", etc."]}),"\n",(0,t.jsxs)(n.p,{children:["For these cases, moon provides a special language/platform called ",(0,t.jsx)(n.code,{children:"system"}),", that is always enabled.\nThis platform is a catch-all, an escape-hatch, a fallback, and provides the following:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Runs a system command or a binary found on ",(0,t.jsx)(n.code,{children:"PATH"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Wraps the execution in a shell. ",(0,t.jsx)(n.code,{children:"SHELL"})," or ",(0,t.jsx)(n.code,{children:"/bin/sh"})," on Unix, and ",(0,t.jsx)(n.code,{children:"pwsh"})," on Windows."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["To run system commands, set a task's ",(0,t.jsx)(n.a,{href:"../config/project#platform-1",children:(0,t.jsx)(n.code,{children:"platform"})}),' setting to "system".']}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="moon.yml"',children:"tasks:\n  example:\n    command: 'git status'\n    platform: 'system'\n"})}),"\n",(0,t.jsx)(n.h2,{id:"tier-structure-and-responsibilities",children:"Tier structure and responsibilities"}),"\n",(0,t.jsxs)(n.p,{children:["As mentioned in our introduction,\n",(0,t.jsx)(n.a,{href:"../#supported-languages",children:"language support is divided up into tiers"}),", where each tier introduces\nmore internal integrations and automations, but requires more work to properly implement."]}),"\n",(0,t.jsx)(n.p,{children:"Internally each tier maps to a Rust crate, as demonstrated by the graph at the top of the article."}),"\n",(0,t.jsx)(n.h3,{id:"tier-0--unsupported",children:"Tier 0 = Unsupported"}),"\n",(0,t.jsxs)(n.p,{children:["The zero tier represents all languages ",(0,t.jsx)(n.em,{children:"not directly"})," supported by moon. This tier merely exists as\na mechanism for running non-supported language binaries via the\n",(0,t.jsx)(n.a,{href:"#system-language-and-platform",children:"system platform"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="moon.yml"',children:"tasks:\n  example:\n    command: 'ruby'\n    platform: 'system'\n"})}),"\n",(0,t.jsx)(n.h3,{id:"tier-1--language",children:"Tier 1 = Language"}),"\n",(0,t.jsx)(n.p,{children:"The first tier is the language itself. This is the most basic level of support, and is the only tier\nthat is required to be implemented for a language to be considered minimally supported. This tier is\nin charge of:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Declaring metadata about the language. For example, the name of the binary, supported file\nextensions, available dependency/package/version managers, names of config/manifest/lock files,\netc."}),"\n",(0,t.jsx)(n.li,{children:"Helpers for parsing lockfiles and manifest files, and interacting with the language's ecosystem\n(for example, Node.js module resolution)."}),"\n",(0,t.jsx)(n.li,{children:"Mechanisms for detecting the language of a project based on config files and other criteria."}),"\n",(0,t.jsxs)(n.li,{children:["Maps to a project's ",(0,t.jsx)(n.a,{href:"../config/project#language",children:(0,t.jsx)(n.code,{children:"language"})})," setting."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="moon.yml"',children:"language: 'javascript'\n"})}),"\n",(0,t.jsx)(n.h3,{id:"tier-2--platform",children:"Tier 2 = Platform"}),"\n",(0,t.jsx)(n.p,{children:"The second tier requires the language functionality from tier 1, and eventually the toolchain\nfunctionality from tier 3, and provides interoperability with moon's internals. This is the most\ncomplex of all tiers, and the tier is in charge of:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Determining when, where, and how to install dependencies for a project or the workspace."}),"\n",(0,t.jsx)(n.li,{children:"Loading project aliases and inferring implicit relationships between projects."}),"\n",(0,t.jsx)(n.li,{children:"Syncing a project and ensuring a healthy project state."}),"\n",(0,t.jsx)(n.li,{children:"Hashing efficiently for dependency installs and target runs."}),"\n",(0,t.jsxs)(n.li,{children:["Prepending ",(0,t.jsx)(n.code,{children:"PATH"})," with appropriate lookups to execute a task."]}),"\n",(0,t.jsx)(n.li,{children:"Running a target's command with proper arguments, environment variables, and flags."}),"\n",(0,t.jsxs)(n.li,{children:["Maps to a project's ",(0,t.jsx)(n.a,{href:"../config/project#platform",children:(0,t.jsx)(n.code,{children:"platform"})})," or task's\n",(0,t.jsx)(n.a,{href:"../config/project#platform-1",children:(0,t.jsx)(n.code,{children:"platform"})})," setting."]}),"\n",(0,t.jsxs)(n.li,{children:["Supports a configuration block by name in ",(0,t.jsx)(n.a,{href:"../config/toolchain",children:(0,t.jsx)(n.code,{children:".moon/toolchain.yml"})}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="moon.yml"',children:"tasks:\n  example:\n    command: 'webpack'\n    platform: 'node'\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title=".moon/toolchain.yml"',children:"node: {}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"tier-3--toolchain",children:"Tier 3 = Toolchain"}),"\n",(0,t.jsxs)(n.p,{children:["The third tier is toolchain support via ",(0,t.jsx)(n.a,{href:"/proto",children:"proto"}),". This is the final tier, as the toolchain is\nunusable unless the platform has been entirely integrated, and as such, the platform depends on this\ntier. This tier handles:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Downloading and installing a language into the toolchain."}),"\n",(0,t.jsx)(n.li,{children:"Installing and deduping project dependencies."}),"\n",(0,t.jsx)(n.li,{children:"Detecting appropriate versions of tools to use."}),"\n",(0,t.jsx)(n.li,{children:"Determining which binary to use and execute targets with."}),"\n",(0,t.jsxs)(n.li,{children:["Supports a ",(0,t.jsx)(n.code,{children:"version"})," field in the named configuration block in\n",(0,t.jsx)(n.a,{href:"../config/toolchain",children:(0,t.jsx)(n.code,{children:".moon/toolchain.yml"})}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title=".moon/toolchain.yml"',children:"node:\n  version: '18.0.0'\n"})})]})}function u(e={}){const{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(p,{...e})}):p(e)}},26675:(e,n,a)=>{a.d(n,{A:()=>r});var t=a(76355),o=a(58406),i=a.n(o);function r(e,n){return(0,t.Z)({container:e,elements:n,layout:{fit:!0,name:"dagre",nodeDimensionsIncludeLabels:!0,spacingFactor:1},style:[{selector:"edges",style:{"arrow-scale":2,"curve-style":"straight","line-cap":"round","line-color":"#c9eef6","line-opacity":.25,"overlay-color":"#c9eef6","target-arrow-color":"#c9eef6","target-arrow-shape":"tee",width:3}},{selector:"node",style:{"background-fill":"linear-gradient","background-gradient-direction":"to-bottom-right","background-gradient-stop-colors":"#d7dfe9 #bdc9db #97a1af",color:"#fff",height:60,label:"data(label)","overlay-color":"#99aab7","overlay-shape":"ellipse",padding:0,shape:"ellipse","text-halign":"center","text-margin-y":6,"text-valign":"bottom","underlay-shape":"ellipse",width:60}},{selector:'node[type="run-task"], node[type="sm"]',style:{"background-gradient-stop-colors":"#6e58d1 #4a2ec6 #3b259e"}},{selector:'node[type="run-target"], node[type="sm"]',style:{"background-gradient-stop-colors":"#6e58d1 #4a2ec6 #3b259e"}},{selector:'node[type="sync-project"], node[type="md"]',style:{"background-gradient-stop-colors":"#ffafff #ff79ff #cc61cc",height:80,width:80}},{selector:'node[type="install-deps"], node[type="lg"]',style:{"background-gradient-stop-colors":"#afe6f2 #79d5e9 #61aaba",height:100,width:100}},{selector:'node[type="setup-tool"], node[type="xl"]',style:{"background-gradient-stop-colors":"#ff9da6 #ff5b6b #cc4956",height:120,width:120}},{selector:'node[id="sync-workspace"]',style:{"background-gradient-stop-colors":"#b7a9f9 #9a87f7 #8c75f5",height:120,width:120}}]})}t.Z.use(i())}}]);