<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://moonrepo.dev/blog</id>
    <title>moonrepo Blog</title>
    <updated>2024-09-02T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://moonrepo.dev/blog"/>
    <subtitle>moonrepo Blog</subtitle>
    <icon>https://moonrepo.dev/img/favicon.svg</icon>
    <entry>
        <title type="html"><![CDATA[moon v1.28 - Task presets, OS tasks, meta tokens, and more]]></title>
        <id>https://moonrepo.dev/blog/moon-v1.28</id>
        <link href="https://moonrepo.dev/blog/moon-v1.28"/>
        <updated>2024-09-02T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[In this release, we've focused on developer experience and quality-of-life improvements.]]></summary>
        <content type="html"><![CDATA[<p>In this release, we've focused on developer experience and quality-of-life improvements.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-task-presets">New task presets<a class="hash-link" aria-label="Direct link to New task presets" title="Direct link to New task presets" href="https://moonrepo.dev/blog/moon-v1.28#new-task-presets">​</a></h2>
<p>For the longest time, moon has supported the <a href="https://moonrepo.dev/docs/config/project#local"><code>local</code></a> setting for
tasks. This setting was added early on to reduce the amount of options configuration necessary for
tasks that "should only run locally". However, after years of supporting this setting, we've
discovered a few short-comings with it:</p>
<ul>
<li>The name is confusing. It's not apparent what "local" really means for newcomers.</li>
<li>This setting also changes non-local related options, like <code>persistent</code> and <code>cache</code>, which isn't
apparent to the user.</li>
<li>Setting the value to <code>false</code> doesn't inverse the options values. For example, enabling <code>runInCI</code>.</li>
</ul>
<p>At this point we thought to ourselves "how can we improve this experience?". Instead of reworking
<code>local</code>, we've opted to introduce a new task setting called <a href="https://moonrepo.dev/docs/config/project#preset"><code>preset</code></a>,
which configures a collection of task options, and deprecate the <code>local</code> setting. Presets are a much
better pattern, as it allows us to support multiple presets, and uniquely name our presets. For
example, old <code>local</code> tasks can be rewritten as such:</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">moon.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token comment" style="color:#97a1af;font-style:italic"># Before</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">start</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'vite dev'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">local</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># After</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">start</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'vite dev'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">preset</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'server'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To start, we're introducing 2 presets: <code>server</code> and <code>watcher</code>. Check out the
<a href="https://moonrepo.dev/docs/config/project#preset">documentation for more information</a> on what these presets configure!
If you have ideas for other presets, we would love to hear them.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-os-specific-tasks">New OS specific tasks<a class="hash-link" aria-label="Direct link to New OS specific tasks" title="Direct link to New OS specific tasks" href="https://moonrepo.dev/blog/moon-v1.28#new-os-specific-tasks">​</a></h2>
<p>When moon was originally designed, it was meant to be a very simple but easily configurable task
runner. But since then, moon has grown drastically, and so has the requirements of its users. One
such request was being able to define tasks that only run for certain operating systems.</p>
<p>This wasn't possible before; but is now thanks to the new
<a href="https://moonrepo.dev/docs/config/project#os"><code>os</code> task option</a>. This option can be configured with "linux", "macos", or
"windows" to target those specific systems, and can be a single value, or list of values.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">moon.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build-linux</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'cargo build --target x86_64-unknown-linux-gnu'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">os</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'linux'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build-macos</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'cargo build --target x86_64-apple-darwin'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">os</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'macos'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build-windows</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'cargo build --target x86_64-pc-windows-msvc'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">os</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'windows'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When a task is ran on a non-compatible system, it will be converted to a no-operation task, so that
dependency chains still resolve correctly.</p>
<blockquote>
<p>In the future, we will look into supporting system architecture as well.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-meta-token-function">New <code>@meta</code> token function<a class="hash-link" aria-label="Direct link to new-meta-token-function" title="Direct link to new-meta-token-function" href="https://moonrepo.dev/blog/moon-v1.28#new-meta-token-function">​</a></h2>
<p>In our last release, we introduced the <a href="https://moonrepo.dev/docs/config/project#metadata-1"><code>project.metadata</code></a> setting
as a means for consumers to define their own metadata. This is great but it provided no other
benefit, as it required consumers to open up config files to discover this metadata, or consumers to
write custom abstractions/tooling. We want to improve the integration of this information within
moon, so to start, we're introducing a new token function <a href="https://moonrepo.dev/docs/concepts/token#meta"><code>@meta(key)</code></a>.</p>
<p>The <a href="https://moonrepo.dev/docs/concepts/token#meta"><code>@meta(key)</code></a> token function can be used to access project metdata
from both the <a href="https://moonrepo.dev/docs/config/project#project"><code>project</code></a> and
<a href="https://moonrepo.dev/docs/config/project#metadata-1"><code>project.metadata</code></a> settings. The former values will be used
as-is, while the latter values will be JSON stringified (since consumers can define anything).</p>
<p>With this new token, our task composition has grown even deeper. For example, you can define a task
at the top-level that a project inherits, and then define metadata within that project for the task!
With that said, this is more of a stopgap solution until we support true variables within
configuration.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.moon/tasks.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">script</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'compile --label @meta(name) --compress @meta(compression)'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">&lt;project&gt;/moon.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">project</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'example'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">compression</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">9</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And lastly, while we're on the topic of tokens, we're also introducing <code>$projectName</code>,
<code>$projectChannel</code>, and <code>$projectOwner</code> token variables, as an easier alternative solution.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-disallowrunincimismatch-experiment">New <code>disallowRunInCiMismatch</code> experiment<a class="hash-link" aria-label="Direct link to new-disallowrunincimismatch-experiment" title="Direct link to new-disallowrunincimismatch-experiment" href="https://moonrepo.dev/blog/moon-v1.28#new-disallowrunincimismatch-experiment">​</a></h2>
<p>Have you ever ran <a href="https://moonrepo.dev/docs/commands/ci"><code>moon ci</code></a> in CI and encountered a scenario where tasks that
<em>should</em> have run didn't run? Or the dependency of a task never runs causing the dependent to fail?
If so, this may apply to you!</p>
<p>This scenario is most likely caused by an invalid relationship where the dependent is
<a href="https://moonrepo.dev/docs/config/project#runinci"><code>runInCI</code></a> enabled, but the dependency is
<a href="https://moonrepo.dev/docs/config/project#runinci"><code>runInCI</code></a> disabled. For example:</p>
<div class="language-yml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">moon.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token comment" style="color:#97a1af;font-style:italic"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">runInCI</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">analyze</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token comment" style="color:#97a1af;font-style:italic"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">deps</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">'build'</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">runInCI</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">true</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Because <code>build</code> is disabled, its outputs may not be created. Additionally, if <code>build</code> is affected by
touched files, the <code>analyze</code> task will not run automatically unless it was also affected. We try our
best to accomdate these scenarios and "detect" when things should run or not, but it's fallible, as
there's many ways that tasks can relate to each other.</p>
<p>To try and remedy this going forward, we're introducing the new <code>disallowRunInCiMismatch</code> experiment
that will <em>hard error</em> if an invalid relationship is configured. We want to try and capture how
often users are configuring this, whether intentionally or accidentally. If the error becomes a
blocker, the experiment can be disabled as so:</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.moon/workspace.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">experiments</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">disallowRunInCiMismatch</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">false</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes" href="https://moonrepo.dev/blog/moon-v1.28#other-changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.28.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>We've sunset the CI insights feature in moonbase. We will no longer be tracking CI run history.
This is a retroactive change that applies to all moon versions.</li>
<li>Added <code>codeowners.requiredApprovals</code> setting to <code>.moon/workspace.yml</code>, that will apply
requirements to all paths.</li>
<li>Updated the terminal checkpoint (4 squares) colors to better reflect their state.</li>
<li>Updated <code>MOON_TOOLCHAIN_FORCE_GLOBALS</code> to support filtering by tool IDs, instead of applying to
everything.</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="os" term="os"/>
        <category label="task" term="task"/>
        <category label="meta" term="meta"/>
        <category label="token" term="token"/>
        <category label="toolchain" term="toolchain"/>
        <category label="preset" term="preset"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[proto v0.40 - Config mode, progress bars, and more]]></title>
        <id>https://moonrepo.dev/blog/proto-v0.40</id>
        <link href="https://moonrepo.dev/blog/proto-v0.40"/>
        <updated>2024-08-16T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[This is a small release that includes many quality of life improvements.]]></summary>
        <content type="html"><![CDATA[<p>This is a small release that includes many quality of life improvements.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new---config-mode-global-option">New <code>--config-mode</code> global option<a class="hash-link" aria-label="Direct link to new---config-mode-global-option" title="Direct link to new---config-mode-global-option" href="https://moonrepo.dev/blog/proto-v0.40#new---config-mode-global-option">​</a></h2>
<p>When proto is ran, we find and load all applicable <a href="https://moonrepo.dev/docs/proto/config"><code>.prototools</code> files</a>. For
the most part, we would traverse upwards, and sometimes load <code>~/.proto/.prototools</code>, while other
times not. It was quite confusing when certain config files were loaded. This was further
exacerbated by the <code>--include-global</code> and <code>--only-local</code> options, which were only available to some
commands (and have been removed entirely).</p>
<p>To remedy and standardize this, we're introducing a new global option
<a href="https://moonrepo.dev/docs/proto/config#resolution-mode"><code>--config-mode</code></a> (<code>-c</code>), which controls how configuration are
loaded. This option supports the following values.</p>
<ul>
<li><code>global</code> - Only load <code>~/.proto/.prototools</code>.</li>
<li><code>local</code> - Only load <code>./.prototools</code> in the current directory.</li>
<li><code>upwards</code> - Load <code>.prototools</code> while traversing upwards, but do not load <code>~/.proto/.prototools</code>.</li>
<li><code>upwards-global</code> / <code>all</code> - Load <code>.prototools</code> while traversing upwards, and do load
<code>~/.proto/.prototools</code>.</li>
</ul>
<p>Now what is the default mode? As mentioned above, we wanted to standardize the default across all
commands, but the problem is, is that each command has different requirements. So in the end, the
default mode is actually 2 different modes depending on the command being ran, which is:</p>
<ul>
<li>For <code>activate</code>, <code>install</code>, <code>outdated</code>, <code>status</code> commands -&gt; <code>upwards</code> mode</li>
<li>All other commands -&gt; <code>upwards-global</code> mode</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="improved-progress-bars">Improved progress bars<a class="hash-link" aria-label="Direct link to Improved progress bars" title="Direct link to Improved progress bars" href="https://moonrepo.dev/blog/proto-v0.40#improved-progress-bars">​</a></h2>
<p>We've improved (or added) the progress bars for <a href="https://moonrepo.dev/docs/proto/commands/install"><code>proto install</code></a>,
<a href="https://moonrepo.dev/docs/proto/commands/upgrade"><code>proto upgrade</code></a>, and the auto-install flow for
<a href="https://moonrepo.dev/docs/proto/commands/run"><code>proto run</code></a>. The progress bars will now display the current phase
(download, unpack, etc), and the download phase will now include current / total downloaded bytes.</p>
<p>Furthermore, when installing multiple tools, we now display a progress bar for each tool.</p>
<div style="margin-bottom:1rem;margin-top:1rem;text-align:center"><img src="https://moonrepo.dev/assets/images/v0.40-progress-9b4c68fcd969d5312791dc1234379127.png" width="100%" alt="" class="inline-block"></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="improved-http-requests">Improved HTTP requests<a class="hash-link" aria-label="Direct link to Improved HTTP requests" title="Direct link to Improved HTTP requests" href="https://moonrepo.dev/blog/proto-v0.40#improved-http-requests">​</a></h2>
<p>For historical context, requests made from the proto CLI itself use a different HTTP client than
requests made from a WASM plugin. The reason for this is that the Rust-based HTTP client that proto
uses is not compatible within WASM, so plugins use a different library. This disconnect meant that
WASM requests did <em>not</em> inherit the <a href="https://moonrepo.dev/docs/proto/config#settingshttp"><code>[settings.http]</code></a> settings,
which meant in some cases, requests would fail or not authenticate correctly, and there was no
work-around.</p>
<p>This is a very tricky problem to solve, but we have implemented a possible solution through a
concept known as <a href="https://moonrepo.dev/docs/guides/wasm-plugins#host-functions--macros">host functions</a>. Host functions
are basically functions that exist on the host machine (proto), and can be called from the guest
runtime (WASM). This new host function utilizes the same HTTP client as proto to make requests,
which results in WASM no longer being disconnected.</p>
<p>However, since there is a cost for calling host functions from the guest, and then serializing the
response from the host back to the guest, there is a small chance that performance will be affected.
We will continue to monitor the implementation, so please report any issues!</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes" href="https://moonrepo.dev/blog/proto-v0.40#other-changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/proto/releases/tag/v0.40.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Removed <code>--include-global</code> and <code>--only-local</code> flags from all applicable commands. Use the new
<code>--config-mode</code> instead.</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="config" term="config"/>
        <category label="mode" term="mode"/>
        <category label="progress" term="progress"/>
        <category label="install" term="install"/>
        <category label="http" term="http"/>
        <category label="request" term="request"/>
        <category label="fetch" term="fetch"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[proto v0.39 - Mid-year quality of life improvements]]></title>
        <id>https://moonrepo.dev/blog/proto-v0.39</id>
        <link href="https://moonrepo.dev/blog/proto-v0.39"/>
        <updated>2024-07-26T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[This is a small release that includes many quality of life improvements.]]></summary>
        <content type="html"><![CDATA[<p>This is a small release that includes many quality of life improvements.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="improved-proto-activate-performance">Improved <code>proto activate</code> performance<a class="hash-link" aria-label="Direct link to improved-proto-activate-performance" title="Direct link to improved-proto-activate-performance" href="https://moonrepo.dev/blog/proto-v0.39#improved-proto-activate-performance">​</a></h2>
<p>In <a href="https://moonrepo.dev/blog/proto-v0.38">v0.38</a> we released the <a href="https://moonrepo.dev/docs/proto/commands/activate"><code>proto activate</code></a> command
as a means of bootstrapping your shell with necessary paths and variables. Since then, we've fixed a
handful of bugs and focused on performance for this release.</p>
<p>In this release, we've reduced the time it took to execute activation from 200-300ms down to
10-20ms. We've also fixed some syntax isses around Bash and Zsh shells.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="merged-proto-install-and-proto-use-commands">Merged <code>proto install</code> and <code>proto use</code> commands<a class="hash-link" aria-label="Direct link to merged-proto-install-and-proto-use-commands" title="Direct link to merged-proto-install-and-proto-use-commands" href="https://moonrepo.dev/blog/proto-v0.39#merged-proto-install-and-proto-use-commands">​</a></h2>
<p>When proto was first built we had separate commands for installing all tools
(<a href="https://moonrepo.dev/docs/proto/commands/use"><code>proto use</code></a>), and installing a single tool
(<a href="https://moonrepo.dev/docs/proto/commands/install"><code>proto install</code></a>). For historical reasons, this was loosely based
off of nvm, but we have diverged heavily since then.</p>
<p>Going forward, the <code>proto use</code> command is now deprecated, and all of its functionality has been
merged into <code>proto install</code>. To install all tools, simply don't pass arguments to the command!</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token comment" style="color:#97a1af;font-style:italic"># Install all tools</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ proto </span><span class="token function" style="color:#ff94ff;font-weight:bold">install</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Install a single tool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ proto </span><span class="token function" style="color:#ff94ff;font-weight:bold">install</span><span class="token plain"> </span><span class="token function" style="color:#ff94ff;font-weight:bold">node</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We like this change, as it aligns with package/dependency manager based workflows.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="customize-built-in-tools">Customize built-in tools<a class="hash-link" aria-label="Direct link to Customize built-in tools" title="Direct link to Customize built-in tools" href="https://moonrepo.dev/blog/proto-v0.39#customize-built-in-tools">​</a></h2>
<p>proto ships with a handful of <a href="https://moonrepo.dev/docs/proto/tools#built-in">official built-in plugins</a> for popular
tools like Node.js, Go, and more. While this is great as it reduces configuration boilerplate, it
may cause an inconvenience for adoption or migration related reasons. To support these workflows,
we're introducing a new setting, <a href="https://moonrepo.dev/docs/proto/config#builtin-plugins"><code>settings.builtin-plugins</code></a>,
that can be used to disable all built-in plugins, or only allow a few select plugins.</p>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.prototools</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">settings</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Disable all</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">builtin-plugins</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token boolean" style="color:#94dded">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Enable some</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">builtin-plugins</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">"node"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"bun"</span><span class="token punctuation" style="color:#cad4e2">]</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="pin-proto-itself">Pin proto itself<a class="hash-link" aria-label="Direct link to Pin proto itself" title="Direct link to Pin proto itself" href="https://moonrepo.dev/blog/proto-v0.39#pin-proto-itself">​</a></h2>
<p>proto has yet to reach an official v1 release, as we're constantly fine-tuning and reworking APIs.
Because of this, we may accidentally introduce unexpected changes, or introduce breaking changes
that you were relying on. To help mitigate these issues, you can now
<a href="https://moonrepo.dev/docs/proto/config#lock-proto-version">pin the version of proto itself</a> in <code>.prototools</code>.</p>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.prototools</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key property" style="color:#b7a9f9">proto</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"0.39.0"</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When this pin exists, all proto shims will attempt to execute proto using that exact version. This
allows for the global <code>proto</code> binary to differ in version from what is executed.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes" href="https://moonrepo.dev/blog/proto-v0.39#other-changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/proto/releases/tag/v0.39.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added <code>PROTO_NO_MODIFY_PROFILE</code> and <code>PROTO_NO_MODIFY_PATH</code> environment variables to <code>proto setup</code>
(for automated workflows).</li>
<li>Updated <code>proto status</code> to display and include versions from ecosystem files (<code>.nvmrc</code>, etc).</li>
<li>Updated <code>github://</code> plugin locators to support monorepos. Append the project name (that tags are
prefixed with) to the path: <code>github://moonrepo/tools/node_tool</code></li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="activate" term="activate"/>
        <category label="install" term="install"/>
        <category label="github" term="github"/>
        <category label="locator" term="locator"/>
        <category label="pin" term="pin"/>
        <category label="builtin" term="builtin"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[moon v1.27 - Task scripts, Docker settings, and more]]></title>
        <id>https://moonrepo.dev/blog/moon-v1.27</id>
        <link href="https://moonrepo.dev/blog/moon-v1.27"/>
        <updated>2024-07-14T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[In this release, we're adding improved Docker support, and a long-awaited task request.]]></summary>
        <content type="html"><![CDATA[<p>In this release, we're adding improved Docker support, and a long-awaited task request.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="experimental-pipeline-enabled-by-default">Experimental pipeline enabled by default<a class="hash-link" aria-label="Direct link to Experimental pipeline enabled by default" title="Direct link to Experimental pipeline enabled by default" href="https://moonrepo.dev/blog/moon-v1.27#experimental-pipeline-enabled-by-default">​</a></h2>
<p>In our last release, we <a href="https://moonrepo.dev/blog/moon-v1.26#new-experimental-pipeline">introduced a new action pipeline</a>
that is more performant, accurate, and resilient, but was hidden behind an experimental flag. Since
then, we've seen many users enable it successfully, and no issues have been reported! And with that,
we're enabling the experiment by default.</p>
<p>If you run into an issue with this new pipeline, you can disable the experiment in
<code>.moon/workspace.yml</code>, like so. If you do encounter an issue, please report it to GitHub or Discord!</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.moon/workspace.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">experiments</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">actionPipelineV2</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">false</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-task-scripts">New task scripts<a class="hash-link" aria-label="Direct link to New task scripts" title="Direct link to New task scripts" href="https://moonrepo.dev/blog/moon-v1.27#new-task-scripts">​</a></h2>
<p>Since the beginning, tasks in moon have been modeled around a single command and its arguments; they
are a 1-to-1 relationship. It was designed this way as it was a hard requirement for task
inheritance to work correctly. If you have multiple tasks in the chain that need to be merged
together, how will arguments be handled? Do they merge, overwrite, or replace? Do they prepend or
append? Or maybe you want to keep the arguments but rename the binary/command itself? And many more
such combinations.</p>
<p>But because of this limitation, tasks did not support executing multiple commands (via <code>&amp;&amp;</code> or <code>;</code>),
as this breaks argument merging (which command should the arguments belong too?). Tasks also did not
support redirects, pipes, and other shell scripting syntax. Over the year we've slowly tried to
support these in tasks, and while they technically do in some capacity, the experience is subpar.</p>
<p>To remedy this, we're introducing a new task field called <a href="https://moonrepo.dev/docs/config/project#script"><code>script</code></a>,
which is an alternative to <a href="https://moonrepo.dev/docs/config/project#command"><code>command</code></a> +
<a href="https://moonrepo.dev/docs/config/project#args"><code>args</code></a>. Scripts support everything mentioned above, and can be defined
as such (using a very contrived example).</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">moon.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">script</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'rm -rf ./out &amp;&amp; ./doBuild.sh out &amp;&amp; ./genStats.sh &gt; stats.json'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">outputs</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'out'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Scripts do support multiple commands, redirects, and pipes, while command/args do not.</li>
<li>Scripts do not support argument task inheritance merging, while command/args do.</li>
<li>Scripts do not support passthrough arguments (after <code>--</code>), while command/args do.</li>
<li>Scripts can only be defined with a string, while command/args support a string or array.</li>
<li>Both scripts and commands support the toolchain.</li>
<li>Both scripts and commands support task tokens and variables.</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_WCGJ alert alert--info"><div class="admonitionHeading_GCBg"><span class="admonitionIcon_L39b"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_pbrs"><p>For a full list of comparisons, and more information on commands vs scripts, head over to the
<a href="https://moonrepo.dev/docs/concepts/task#commands-vs-scripts">official task documentation</a>!</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="improved-docker-integration">Improved Docker integration<a class="hash-link" aria-label="Direct link to Improved Docker integration" title="Direct link to Improved Docker integration" href="https://moonrepo.dev/blog/moon-v1.27#improved-docker-integration">​</a></h2>
<p>As it turns out, a lot of moon users rely heavily on our Docker integration, which hasn't seen some
love in quite a while. We felt it was time to change that.</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="new-moon-docker-file-command">New <code>moon docker file</code> command<a class="hash-link" aria-label="Direct link to new-moon-docker-file-command" title="Direct link to new-moon-docker-file-command" href="https://moonrepo.dev/blog/moon-v1.27#new-moon-docker-file-command">​</a></h3>
<p>Since our release of Docker in moon (v0.15), we've provided an <a href="https://moonrepo.dev/docs/guides/docker">in-depth guide</a>
on why our integration exists, and what it aims to solve. However, the guide required a bit of
manual non-trivial setup, which left users confused more than we like. To remedy this, we're
introducing a new command, <a href="https://moonrepo.dev/docs/commands/docker/file"><code>moon docker file</code></a>, which will generate a
multi-staged <code>Dockerfile</code> for a project.</p>
<p>To demonstrate this, here's what the <code>Dockerfile</code> looks like for our website.</p>
<div class="language-docker codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-docker codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token comment" style="color:#97a1af;font-style:italic">#### BASE STAGE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic">#### Installs moon.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">FROM</span><span class="token instruction"> node:latest </span><span class="token instruction keyword" style="color:#b7a9f9">AS</span><span class="token instruction"> base</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">WORKDIR</span><span class="token instruction"> /app</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Install moon binary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">RUN</span><span class="token instruction"> curl -fsSL https://moonrepo.dev/install/moon.sh | bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">ENV</span><span class="token instruction"> PATH=</span><span class="token instruction string" style="color:#c9e166">"/root/.moon/bin:$PATH"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic">#### SKELETON STAGE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic">#### Scaffolds repository skeleton structures.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">FROM</span><span class="token instruction"> base </span><span class="token instruction keyword" style="color:#b7a9f9">AS</span><span class="token instruction"> skeleton</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Copy entire repository and scaffold</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">COPY</span><span class="token instruction"> . .</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">RUN</span><span class="token instruction"> moon docker scaffold website</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic">#### BUILD STAGE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic">#### Builds the project.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">FROM</span><span class="token instruction"> base </span><span class="token instruction keyword" style="color:#b7a9f9">AS</span><span class="token instruction"> build</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Copy toolchain</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">COPY</span><span class="token instruction"> </span><span class="token instruction options property" style="color:#b7a9f9">--from</span><span class="token instruction options punctuation" style="color:#cad4e2">=</span><span class="token instruction options string" style="color:#c9e166">skeleton</span><span class="token instruction"> /root/.proto /root/.proto</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Copy workspace configs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">COPY</span><span class="token instruction"> </span><span class="token instruction options property" style="color:#b7a9f9">--from</span><span class="token instruction options punctuation" style="color:#cad4e2">=</span><span class="token instruction options string" style="color:#c9e166">skeleton</span><span class="token instruction"> /app/.moon/docker/workspace .</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Install dependencies</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">RUN</span><span class="token instruction"> moon docker setup</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Copy project sources</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">COPY</span><span class="token instruction"> </span><span class="token instruction options property" style="color:#b7a9f9">--from</span><span class="token instruction options punctuation" style="color:#cad4e2">=</span><span class="token instruction options string" style="color:#c9e166">skeleton</span><span class="token instruction"> /app/.moon/docker/sources .</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Build the project</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">RUN</span><span class="token instruction"> moon run website:build</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Prune extraneous dependencies</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">RUN</span><span class="token instruction"> moon docker prune</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic">#### START STAGE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic">#### Runs the project.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">FROM</span><span class="token instruction"> base </span><span class="token instruction keyword" style="color:#b7a9f9">AS</span><span class="token instruction"> start</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Copy built sources</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">COPY</span><span class="token instruction"> </span><span class="token instruction options property" style="color:#b7a9f9">--from</span><span class="token instruction options punctuation" style="color:#cad4e2">=</span><span class="token instruction options string" style="color:#c9e166">build</span><span class="token instruction"> /root/.proto /root/.proto</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">COPY</span><span class="token instruction"> </span><span class="token instruction options property" style="color:#b7a9f9">--from</span><span class="token instruction options punctuation" style="color:#cad4e2">=</span><span class="token instruction options string" style="color:#c9e166">build</span><span class="token instruction"> /app /app</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">CMD</span><span class="token instruction"> moon run website:start</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="new-docker-settings">New <code>docker</code> settings<a class="hash-link" aria-label="Direct link to new-docker-settings" title="Direct link to new-docker-settings" href="https://moonrepo.dev/blog/moon-v1.27#new-docker-settings">​</a></h3>
<p>To further improve our Docker support, we're also introducing new <code>docker</code> settings to both
<a href="https://moonrepo.dev/docs/config/workspace#docker"><code>.moon/workspace.yml</code></a> and
<a href="https://moonrepo.dev/docs/config/project#docker"><code>moon.yml</code></a>. These settings allow you to customize the scaffold,
prune, and <code>Dockerfile</code> generation flows.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.moon/workspace.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">docker</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">prune</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">installToolchainDeps</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">scaffold</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">include</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'*.config.js'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">moon.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">docker</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">file</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'node:latest'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">buildTask</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'build'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">startTask</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'start'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes" href="https://moonrepo.dev/blog/moon-v1.27#other-changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.27.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added support for <a href="https://murex.rocks/" target="_blank" rel="noopener noreferrer">murex</a> shells.</li>
<li>Improved the "automatically install dependencies if a manifest/lockfile has changed" flow. This
should trigger less than before.</li>
<li>We now generate JSON schemas for our configuration files to <code>.moon/cache/schemas</code>, so that they
can be dynamically created based on the current moon version and environment.</li>
<li>When writing JSON and YAML files, we attempt to write back to the file with its original
indentation.</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="action" term="action"/>
        <category label="pipeline" term="pipeline"/>
        <category label="task" term="task"/>
        <category label="script" term="script"/>
        <category label="command" term="command"/>
        <category label="docker" term="docker"/>
        <category label="dockerfile" term="dockerfile"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[proto v0.38 - Shell activation / hooks]]></title>
        <id>https://moonrepo.dev/blog/proto-v0.38</id>
        <link href="https://moonrepo.dev/blog/proto-v0.38"/>
        <updated>2024-07-07T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[In this release, we're introducing a long requested feature, shell hooks!]]></summary>
        <content type="html"><![CDATA[<p>In this release, we're introducing a long requested feature, shell hooks!</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-experimental-shell-activation-workflow">New experimental shell activation workflow<a class="hash-link" aria-label="Direct link to New experimental shell activation workflow" title="Direct link to New experimental shell activation workflow" href="https://moonrepo.dev/blog/proto-v0.38#new-experimental-shell-activation-workflow">​</a></h2>
<p>You've most likely used another version manager before proto, and may have used a workflow where
<code>PATH</code> was automatically updated with versioned binaries of specific tools, or environment variables
were injected into your shell. This functionality is what's known as shell hooks, and proto now has
experimental support for them through a feature known as
<a href="https://moonrepo.dev/docs/proto/workflows#shell-activation">shell activation</a>!</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="how-it-works">How it works<a class="hash-link" aria-label="Direct link to How it works" title="Direct link to How it works" href="https://moonrepo.dev/blog/proto-v0.38#how-it-works">​</a></h3>
<p>For example, say you're using Zsh as your shell. You could now append the following expression at
the bottom of your shell profile, which evaluates our new
<a href="https://moonrepo.dev/docs/proto/commands/activate"><code>proto activate</code></a> command.</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token builtin class-name" style="color:#ff94ff;font-weight:bold">eval</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"</span><span class="token string variable" style="color:#fef9c3">$(</span><span class="token string variable" style="color:#fef9c3">proto activate </span><span class="token string variable function" style="color:#ff94ff;font-weight:bold">zsh</span><span class="token string variable" style="color:#fef9c3">)</span><span class="token string" style="color:#c9e166">"</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When the current working directory changes (via <code>cd</code>), or the CLI prompt changes, this activation
workflow will trigger the following:</p>
<ul>
<li>Download and install necessary proto plugins (if they do not exist)</li>
<li>Load and resolve all <code>.prototools</code> configurations up the file system</li>
<li>Detect and resolve versions for all configured tools</li>
<li>Export environment variables defined in <code>[env]</code> and <code>[tools.*.env]</code></li>
<li>Prepend <code>PATH</code> with binary directories for detected tools</li>
</ul>
<p>Pretty awesome right? We think so. But as mentioned above, this feature is highly experimental, and
may not work properly across all shells (we're unable to test everything). So if you run into an
issue, please report it!</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="unlocked-features">Unlocked features<a class="hash-link" aria-label="Direct link to Unlocked features" title="Direct link to Unlocked features" href="https://moonrepo.dev/blog/proto-v0.38#unlocked-features">​</a></h3>
<p>This new workflow unlocks some functionality that was previously not possible with proto shims/bins
directly, and they are:</p>
<ul>
<li>Directory paths to globally installed packages are now automatically prepended to <code>PATH</code>.
Previously, you would need to add them manually. This was non-trivial if they were installed to
versioned locations.</li>
<li>Directory paths to pre-installed binaries within a tool are also prepended to <code>PATH</code>. For example,
Rust/Cargo and Python provide a lot of executables that were ignored by our shims.</li>
<li>This workflow is 1 step closer to replacing <a href="https://direnv.net/" target="_blank" rel="noopener noreferrer">direnv</a> itself.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes" href="https://moonrepo.dev/blog/proto-v0.38#other-changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/proto/releases/tag/v0.38.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added support for <a href="https://murex.rocks/" target="_blank" rel="noopener noreferrer">murex</a> shells.</li>
<li>Added a <code>--include-global</code> flag to <code>proto use</code>, that will also install globally configured tools.</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="shell" term="shell"/>
        <category label="activate" term="activate"/>
        <category label="hook" term="hook"/>
        <category label="murex" term="murex"/>
        <category label="env" term="env"/>
        <category label="path" term="path"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[moon v1.26 - New experimental pipeline, trace profiles, and more]]></title>
        <id>https://moonrepo.dev/blog/moon-v1.26</id>
        <link href="https://moonrepo.dev/blog/moon-v1.26"/>
        <updated>2024-06-24T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[In this release, we focused primarily on a next-generation actions pipeline.]]></summary>
        <content type="html"><![CDATA[<p>In this release, we focused primarily on a next-generation actions pipeline.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-experimental-pipeline">New experimental pipeline<a class="hash-link" aria-label="Direct link to New experimental pipeline" title="Direct link to New experimental pipeline" href="https://moonrepo.dev/blog/moon-v1.26#new-experimental-pipeline">​</a></h2>
<p>The <a href="https://moonrepo.dev/docs/how-it-works/action-graph">action pipeline</a> or just "pipeline", is the system in which we
actually run tasks in topological order when <a href="https://moonrepo.dev/docs/commands/run"><code>moon run</code></a>,
<a href="https://moonrepo.dev/docs/commands/check"><code>moon check</code></a>, or <a href="https://moonrepo.dev/docs/commands/ci"><code>moon ci</code></a> is executed. The pipeline is
powered by the <a href="https://moonrepo.dev/docs/how-it-works/action-graph">action graph</a> (also known as a task graph or
dependency graph) and is quite complex, as we need to efficiently run tasks on our thread pool,
ensure dependency tasks are ran before running dependent tasks, handle signals (ctrl + c), and much
more.</p>
<p>Our current implementation "works" but could be much better, as it still has some problematic edge
cases, <a href="https://github.com/moonrepo/moon/issues/902" target="_blank" rel="noopener noreferrer">doesn't always shutdown correctly</a>, and is
pretty much tech debt at this point. To remedy this, we spent the last month working on a new action
pipeline that aims to solve all of these problems, with a more modern implementation. Some such
improvements are:</p>
<ul>
<li>Increased performance with better concurrency handling and scheduling. Threads in the pool should
now be constantly utilized.</li>
<li>More accurately monitors signals (ctrl+c) and shutdowns. We now use Rust channels internally to
manage this state.</li>
<li>The CLI will now wait for aborted/cancelled task handles to exit before the entire CLI exits. This
should alleviate zombie processes.</li>
</ul>
<p>With all that said, unlike previous releases that replaced the old feature with a new feature, we
chose to gate this new pipeline behind an experimental flag. We want to ensure this works correctly
in all cases, before enabling it by default. So please test it and report back any issues! We've
successfully been using it on moon's repository without issue.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.moon/workspace.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">experiments</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">actionPipelineV2</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">true</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="generate-trace-profiles">Generate trace profiles<a class="hash-link" aria-label="Direct link to Generate trace profiles" title="Direct link to Generate trace profiles" href="https://moonrepo.dev/blog/moon-v1.26#generate-trace-profiles">​</a></h2>
<p>A major goal of moon is to be extremely efficient and to optimize as much as possible. To help
accomplish this goal, we're introducing the global CLI <code>--dump</code> flag, which will generate a trace
profile that can be loaded and reviewed in <code>chrome://tracing</code>.</p>
<p>This will display a flame graph with labeled operations, their timing information, and any
associated data. This is the first step in capturing this kind of information, and it will only get
better moving forward.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="additional-shell-support">Additional shell support<a class="hash-link" aria-label="Direct link to Additional shell support" title="Direct link to Additional shell support" href="https://moonrepo.dev/blog/moon-v1.26#additional-shell-support">​</a></h2>
<p>Based on the work in <a href="https://moonrepo.dev/proto">proto</a>, we now have built-in support for additional command line
shells. To start, we've updated the <a href="https://moonrepo.dev/docs/config/project#unixshell"><code>unixShell</code></a> and
<a href="https://moonrepo.dev/docs/config/project#windowsshell"><code>windowsShell</code></a> task options to support the following new
shells:</p>
<ul>
<li>Unix: <code>ion</code>, <code>nu</code> (nushell), <code>pwsh</code> (powershell), <code>xonsh</code>.</li>
<li>Windows: <code>elvish</code>, <code>fish</code>, <code>nu</code> (nushell), <code>xonsh</code></li>
</ul>
<p>And furthermore, we've added Nushell completion support to the
<a href="https://moonrepo.dev/docs/commands/completions"><code>moon completions</code></a> command!</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes" href="https://moonrepo.dev/blog/moon-v1.26#other-changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.26.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Updated CLI command execution to be more performant, and to reduce our usage of concurrent locks.</li>
<li>Updated proto to v0.37.1 (from v0.36.2).</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="action" term="action"/>
        <category label="pipeline" term="pipeline"/>
        <category label="trace" term="trace"/>
        <category label="profile" term="profile"/>
        <category label="shell" term="shell"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[proto v0.37 - Calver support and self diagnosis]]></title>
        <id>https://moonrepo.dev/blog/proto-v0.37</id>
        <link href="https://moonrepo.dev/blog/proto-v0.37"/>
        <updated>2024-06-16T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[This is a small release, but includes 2 very important features.]]></summary>
        <content type="html"><![CDATA[<p>This is a small release, but includes 2 very important features.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="calender-versioning-support">Calender versioning support<a class="hash-link" aria-label="Direct link to Calender versioning support" title="Direct link to Calender versioning support" href="https://moonrepo.dev/blog/proto-v0.37#calender-versioning-support">​</a></h2>
<p>For the most part, tools use <a href="http://semver.org/" target="_blank" rel="noopener noreferrer">semver</a> (semantic versions) for their releases,
but every so often you run into a tool that uses another format, <a href="https://calver.org/" target="_blank" rel="noopener noreferrer">calver</a>
(calendar versions). Some examples of calver are <code>2024-02</code>, <code>2024-10-23</code>, and <code>2024-12-9.123</code>.</p>
<p>Calendar based versions were not supported previously as the syntax between semver and calver are
different enough that they could not be parsed successfully. Well no longer, as we spent the time
writing our own custom parser to differentiate between the 2 formats. This process is quite
complicated, and has many restrictions and caveats, so we took the time to document it under the
name <a href="https://moonrepo.dev/docs/proto/version-spec">version specification</a>.</p>
<p>The biggest difference between semver and calver syntax, is that semver is dot-separated, while
calver is dash-separated. The day part (patch) is also optional in calver.</p>
<div class="theme-admonition theme-admonition-caution admonition_WCGJ alert alert--warning"><div class="admonitionHeading_GCBg"><span class="admonitionIcon_L39b"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_pbrs"><p>We wrote a ton of tests to cover all the formats and edge cases we could think of, but if you run
into a tool that fails to parse versions correctly, please report an issue immediately! All of our
built-in tools have been tested against.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-proto-diagnose-command">New <code>proto diagnose</code> command<a class="hash-link" aria-label="Direct link to new-proto-diagnose-command" title="Direct link to new-proto-diagnose-command" href="https://moonrepo.dev/blog/proto-v0.37#new-proto-diagnose-command">​</a></h2>
<p>A common issue within the community that we've seen is commands not being available after installing
a tool. Most of the time, this is caused by certain proto paths not existing within <code>PATH</code>. To help
remedy these issues moving forward, we're introducing a new command,
<a href="https://moonrepo.dev/docs/proto/commands/diagnose"><code>proto diagnose</code></a> (or <code>doctor</code>) that will attempt to find all issues
with your proto installation.</p>
<div class="codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-text codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ proto diagnose</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">Shell: zsh</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">Shell profile: ~/.zshrc</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">Errors</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  Issue: Bin directory (~/.proto/bin) was found BEFORE the shims directory (~/.proto/shims) on PATH</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  Resolution: Ensure the shims path comes before the bin path in your shell</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">Warnings</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  Issue: Missing PROTO_HOME environment variable (Will default to ~/.proto if not defined)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  Resolution: Export PROTO_HOME="$HOME/.proto" from your shell</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In the future, we'll expand on this command by also bubbling up issues from your installed tools.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes" href="https://moonrepo.dev/blog/proto-v0.37#other-changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/proto/releases/tag/v0.37.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Improved command execution. May see some slight performance gains.</li>
<li>Updated wasmtime to v21 (from v17).</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="calver" term="calver"/>
        <category label="calendar" term="calendar"/>
        <category label="version" term="version"/>
        <category label="diagnose" term="diagnose"/>
        <category label="doctor" term="doctor"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[proto v0.36 - Static registry, plugin searching, and more]]></title>
        <id>https://moonrepo.dev/blog/proto-v0.36</id>
        <link href="https://moonrepo.dev/blog/proto-v0.36"/>
        <updated>2024-06-03T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[In this release, we're taking the first step in supporting a plugin registry.]]></summary>
        <content type="html"><![CDATA[<p>In this release, we're taking the first step in supporting a plugin registry.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-static-registry">New static registry<a class="hash-link" aria-label="Direct link to New static registry" title="Direct link to New static registry" href="https://moonrepo.dev/blog/proto-v0.36#new-static-registry">​</a></h2>
<p>Our long-term plan for proto is to provide a server-based registry in which users could publish and
manage plugins, and immediately make them available to the community. However, this is quite a
mountain of work, and will take some time, but making plugins available <em>now</em> is a priority.</p>
<p>As a temporary solution, we're introducing a static registry, in which available plugins are defined
in static JSON files, located in the official
<a href="https://github.com/moonrepo/proto/tree/master/registry" target="_blank" rel="noopener noreferrer">moonrepo/proto</a> repository. This will help
unblock new features moving forward.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-proto-plugin-search-command">New <code>proto plugin search</code> command<a class="hash-link" aria-label="Direct link to new-proto-plugin-search-command" title="Direct link to new-proto-plugin-search-command" href="https://moonrepo.dev/blog/proto-v0.36#new-proto-plugin-search-command">​</a></h2>
<p>Because of the static registry work above, we're now able to introduce a new command,
<a href="https://moonrepo.dev/docs/proto/commands/plugin/search"><code>proto plugin search</code></a>, that can be used to search for plugins
provided by the community. No longer will you need to browse the documentation, or search Google for
available plugins.</p>
<div class="codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-text codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ proto plugin search moon</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">Plugins</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">Available for query: moon</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"> Plugin  Author    Format  Description                                                          Locator</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"> moon    moonrepo  TOML    moon is a multi-language build system and codebase management tool.  https://raw.githubusercontent.com/moonrepo/moon/master/proto-plugin.toml</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-proto-unpin-command">New <code>proto unpin</code> command<a class="hash-link" aria-label="Direct link to new-proto-unpin-command" title="Direct link to new-proto-unpin-command" href="https://moonrepo.dev/blog/proto-v0.36#new-proto-unpin-command">​</a></h2>
<p>Additionally, a command that probably should have existed from the start, but did not, is now
available. The <a href="https://moonrepo.dev/docs/proto/commands/unpin"><code>proto unpin</code></a> command does exactly as its name says, it
unpins (removes) a version from a <code>.prototools</code> file.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="plugin-locator-syntax-changes">Plugin locator syntax changes<a class="hash-link" aria-label="Direct link to Plugin locator syntax changes" title="Direct link to Plugin locator syntax changes" href="https://moonrepo.dev/blog/proto-v0.36#plugin-locator-syntax-changes">​</a></h2>
<p>We've decided to slightly change the syntax of plugin locator strings by embracing the common
protocol syntax. Instead of <code>source:</code> and <code>github:</code>, we now use <code>file://</code>, <code>https://</code>, and
<code>github://</code>. The former syntax will continue to work for the time being, but will be removed
entirely in the future.</p>
<ul>
<li><code>source:./file.wasm</code> -&gt; <code>file://./file.wasm</code></li>
<li><code>source:https://url.com/file.wasm</code> -&gt; <code>https://url.com/file.wasm</code></li>
<li><code>github:org/repo</code> -&gt; <code>github://org/repo</code></li>
</ul>
<blockquote>
<p>If a <code>proto</code> command modifies a <code>.prototools</code> file, the file will be saved with the new syntax.
Don't be surprised when this happens!</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes" href="https://moonrepo.dev/blog/proto-v0.36#other-changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/proto/releases/tag/v0.36.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Updated <code>proto uninstall</code> to also remove entries from <code>.prototools</code> if the version was
uninstalled.</li>
<li>Updated some error messages to include copy for work arounds.</li>
<li>We now lock the bin/shims directory when creating/removing files.<!-- -->
<ul>
<li>This is an experiment to help avoid race conditions where multiple proto processes are all
trying to write to the same location.</li>
<li>If this results in too large of a performance hit, we'll remove the locking.</li>
</ul>
</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="registry" term="registry"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[moon v1.25 - New task runner and console reporter]]></title>
        <id>https://moonrepo.dev/blog/moon-v1.25</id>
        <link href="https://moonrepo.dev/blog/moon-v1.25"/>
        <updated>2024-05-27T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[In this release, we focused primarily on rewriting our task runner, and improving our console.]]></summary>
        <content type="html"><![CDATA[<p>In this release, we focused primarily on rewriting our task runner, and improving our console.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-task-runner-implementation">New task runner implementation<a class="hash-link" aria-label="Direct link to New task runner implementation" title="Direct link to New task runner implementation" href="https://moonrepo.dev/blog/moon-v1.25#new-task-runner-implementation">​</a></h2>
<p>It's been over a month since our last release, but we've been really busy rewriting our task runner
from the ground up! In other build systems, a task runner is typically the orchestator that runs
multiple tasks and manages their state. In moon this is known as the action pipeline (or just
pipeline), and a task runner is simply the execution of a single task. However, executing a single
task is quite involved, as we need to generate a unique hash, check the cache, hydrate outputs if a
cache hit, actually execute the task as a child process, and much more!</p>
<p>Task running is some of the oldest code in moon, as it was part of the initial MVP. Because of this,
it hasn't changed much, but moon has grown quite large and it was time to revisit it with better
design patterns and practices. Furthermore, since the task runner is so critical to moon itself, we
wanted to ensure it worked correctly, and spent more time than usual implementing, testing it, and
verifying edge cases.</p>
<p>With this new task runner, we...</p>
<ul>
<li>Improved handling and reliability of output archiving (cache miss) and hydration (cache hit).</li>
<li>Streamlined the task execution (child process) flow.</li>
<li>Increased performance by optimizing or removing certain code paths.</li>
</ul>
<blockquote>
<p>If you're interested in how the task runner was implemented, feel free to take a look at the
<a href="https://github.com/moonrepo/moon/tree/master/crates/task-runner" target="_blank" rel="noopener noreferrer">Rust crate</a>, and the
<a href="https://github.com/moonrepo/moon/pull/1463" target="_blank" rel="noopener noreferrer">pull request</a> itself.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="fine-grained-operations">Fine-grained operations<a class="hash-link" aria-label="Direct link to Fine-grained operations" title="Direct link to Fine-grained operations" href="https://moonrepo.dev/blog/moon-v1.25#fine-grained-operations">​</a></h3>
<p>A major goal of moon is bubbling up information to the user that is applicable to the current
workflow, but what about when that workflow must be debugged or optimized? At that point, it was
almost impossible without digging into the source code.</p>
<p>To make a step in this direction, as part of the new task runner we now track timing information for
individual parts of the run execution, and we're calling these parts operations. An operation is
anything from generating a hash, creating a tarball archive, unpacking the archive (cache
hydration), task execution (the child process), and more.</p>
<p>This timing information is useful in figuring out why a certain task is slower than expected, and
which operation is actually causing the slowness. It also helps to uncover which operations were
actually ran for an action, which were skipped, so on and so forth. At this point in time, the
operations information is only included in the run report, located at <code>.moon/cache/runReport.json</code>.
In the future, we plan to display this information in a nice UI.</p>
<p>For an example of this in action, here's a list of all operations that were executed when running
the <code>build</code> task for our website.</p>
<div class="language-json codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-json codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token punctuation" style="color:#cad4e2">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"duration"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"secs"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">0</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"nanos"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">609156875</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"finishedAt"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"2024-05-27T00:14:54.286628"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"meta"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"type"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"hash-generation"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"hash"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"10606e37c5e6ab4008007b30275f1682bae32dca71650ce173eb386d5b6c3309"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"startedAt"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"2024-05-27T00:14:53.677526"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"status"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"passed"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"duration"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"secs"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">0</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"nanos"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">32834</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"finishedAt"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"2024-05-27T00:14:54.286667"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"meta"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"type"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"output-hydration"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"startedAt"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"2024-05-27T00:14:54.286634"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"status"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"skipped"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"duration"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"secs"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">15</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"nanos"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">789003125</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"finishedAt"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"2024-05-27T00:15:10.075113"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"meta"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"type"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"task-execution"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"command"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"docusaurus build"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"exitCode"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"startedAt"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"2024-05-27T00:14:54.286950"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"status"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"passed"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"duration"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"secs"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">17</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"nanos"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">214634292</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"finishedAt"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"2024-05-27T00:15:27.289995"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"meta"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"type"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"archive-creation"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"startedAt"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"2024-05-27T00:15:10.075686"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"status"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"passed"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">]</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Because of these new operations, we can clearly see above that the archive creation process is
taking 17 seconds, which is 2 seconds longer than the build itself! Without this information, we
would have never known that the archive was taking this long, but now we do, and we can optimize it
in a future release!</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="run-summaries">Run summaries<a class="hash-link" aria-label="Direct link to Run summaries" title="Direct link to Run summaries" href="https://moonrepo.dev/blog/moon-v1.25#run-summaries">​</a></h3>
<p>Because of the new task runner and the new console (<a href="https://moonrepo.dev/blog/moon-v1.25#new-console-reporting-layer">below</a>), we have
the ability to bubble up more information than before. Based on requests from the community, we've
taken the output from <a href="https://moonrepo.dev/docs/commands/ci"><code>moon ci</code></a> and applied it to both
<a href="https://moonrepo.dev/docs/commands/check"><code>moon check</code></a> and <a href="https://moonrepo.dev/docs/commands/run"><code>moon run</code></a> behind the <code>--summary</code>
flag.</p>
<p>When this flag is passed, we will now summarize all actions that have ran in the pipeline (not just
task related ones), and include failed tasks for review. For example, here's the output of
<code>moon check website --summary</code> on moon's repository.</p>
<div class="codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-text codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ moon check website --summary</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">▪▪▪▪ types:build (cached, 1ms, 21bd9add)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">▪▪▪▪ runtime:build (cached, e8363e65)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">▪▪▪▪ website:typecheck (cached, 0ab91eaa)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">▪▪▪▪ website:format (cached, 07ae2388)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">▪▪▪▪ website:test (cached, 11d33e2e)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">▪▪▪▪ website:lint (cached, 2197fbb1)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">▪▪▪▪ website:build (10606e37)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">▪▪▪▪ website:build (15s 789ms, 10606e37)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">SUMMARY</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">pass SyncWorkspace</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">skip SetupNodeTool(20.13.1) (skipped, 250ms)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">skip InstallNodeDeps(20.13.1) (skipped, 13ms, f341872f)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">pass SyncNodeProject(types) (1ms)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">pass SyncNodeProject(runtime) (1ms)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">pass RunTask(types:build) (cached, 140ms, 21bd9add)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">pass SyncNodeProject(website) (1ms)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">pass RunTask(runtime:build) (cached, 32ms, e8363e65)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">pass RunTask(website:build) (33s 614ms, 10606e37)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">pass RunTask(website:format) (cached, 59ms, 07ae2388)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">pass RunTask(website:lint) (cached, 101ms, 2197fbb1)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">pass RunTask(website:test) (cached, 64ms, 11d33e2e)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">pass RunTask(website:typecheck) (cached, 59ms, 0ab91eaa)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">STATS</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">Actions: 11 completed (6 cached), 2 skipped</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">   Time: 34s 52ms</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-console-reporting-layer">New console reporting layer<a class="hash-link" aria-label="Direct link to New console reporting layer" title="Direct link to New console reporting layer" href="https://moonrepo.dev/blog/moon-v1.25#new-console-reporting-layer">​</a></h2>
<p>For the most part, when something in moon needed to be printed to the console, we would simply print
it directly at that point in time, anywhere within the codebase. While this worked, it made it
difficult to orchestrate output from different parts of the codebase, and in the context of Rust,
each call to stdout/stderr <a href="https://nnethercote.github.io/perf-book/io.html" target="_blank" rel="noopener noreferrer">locks the I/O stream</a>,
resulting in performance loss.</p>
<p>To work around this, in <a href="https://moonrepo.dev/blog/moon-v1.21">v1.21</a> we implemented a new
<a href="https://github.com/moonrepo/moon/tree/master/crates/console" target="_blank" rel="noopener noreferrer">console layer</a> that buffers all stdio
writes, and prints them on 100ms intervals. This avoids locking on every call, and instead batches
them. To expand on this further, in this release we've implemented a new
<a href="https://github.com/moonrepo/moon/tree/master/crates/console-reporter" target="_blank" rel="noopener noreferrer">reporter layer</a>, with a
well-defined interface that is used to print checkpoints (the 4 squares), and status updates from
the action pipeline (and the new task runner).</p>
<p>This reporter layer enables new console UI implementations in the future based on your preferences.
For example, an <a href="https://ratatui.rs/" target="_blank" rel="noopener noreferrer">interactive UI</a> composed of tables, tabs, and more,
representing the current state of the pipeline.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes" href="https://moonrepo.dev/blog/moon-v1.25#other-changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.25.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Greatly reduced the amount of concurrent locks being held during task execution. May see slight
performance improvements.</li>
<li>Updated external configuration files (via https extends) to be cached for 24 hours.</li>
<li>Updated macOS binaries to be built on macos-12 instead of macos-11.</li>
<li>Updated proto to v0.35.4 (from v0.34.4).</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="task" term="task"/>
        <category label="runner" term="runner"/>
        <category label="console" term="console"/>
        <category label="reporter" term="reporter"/>
        <category label="operation" term="operation"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[proto v0.35 - Support for more shells]]></title>
        <id>https://moonrepo.dev/blog/proto-v0.35</id>
        <link href="https://moonrepo.dev/blog/proto-v0.35"/>
        <updated>2024-05-05T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[This is a light release that adds support for more terminal shells.]]></summary>
        <content type="html"><![CDATA[<p>This is a light release that adds support for more terminal shells.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="experimental-support-for-new-shells">Experimental support for new shells<a class="hash-link" aria-label="Direct link to Experimental support for new shells" title="Direct link to Experimental support for new shells" href="https://moonrepo.dev/blog/proto-v0.35#experimental-support-for-new-shells">​</a></h2>
<p>proto has always supported the primary and common shells like Bash, Zsh, Fish, PowerShell, and more.
In recent years, there has been an influx of new and modern shells, built with technologies such as
Rust. We felt it was time to start supporting some of these new shells, and have added
<a href="https://crates.io/crates/starbase_shell" target="_blank" rel="noopener noreferrer">experimental support</a> for:</p>
<ul>
<li><a href="https://github.com/redox-os/ion" target="_blank" rel="noopener noreferrer">Ion</a></li>
<li><a href="https://www.nushell.sh/" target="_blank" rel="noopener noreferrer">Nu</a></li>
<li><a href="https://xon.sh/" target="_blank" rel="noopener noreferrer">Xonsh</a></li>
</ul>
<p>Furthermore, the <a href="https://moonrepo.dev/docs/proto/commands/setup"><code>proto setup</code></a> command (which is ran when installing
proto) will now prompt the user to select a shell if one could not be detected.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="generate-trace-profiles">Generate trace profiles<a class="hash-link" aria-label="Direct link to Generate trace profiles" title="Direct link to Generate trace profiles" href="https://moonrepo.dev/blog/proto-v0.35#generate-trace-profiles">​</a></h2>
<p>A major goal of proto is to be extremely efficient and to optimize as much as possible. To help
accomplish this goal, we're introducing the global CLI <code>--dump</code> flag, which will generate a trace
profile that can be loaded and reviewed in <code>chrome://tracing</code>.</p>
<p>This will display a flame graph with labeled operations, their timing information, and any
associated data. This is the first step in capturing this kind of information, and it will only get
better moving forward.</p>
<div class="theme-admonition theme-admonition-caution admonition_WCGJ alert alert--warning"><div class="admonitionHeading_GCBg"><span class="admonitionIcon_L39b"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_pbrs"><p>Generating a profile for running a tool, either with <code>proto run node</code> or <code>node</code> itself, will not
work. This is because the tool process <em>replaces</em> the current proto process entirely, causing the
profile to be interrupted and abort.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes" href="https://moonrepo.dev/blog/proto-v0.35#other-changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/proto/releases/tag/v0.35.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="shell" term="shell"/>
        <category label="dump" term="dump"/>
        <category label="profile" term="profile"/>
        <category label="trace" term="trace"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[moon v1.24 - Task mutexes, auto-detect revisions, project dependents, and more!]]></title>
        <id>https://moonrepo.dev/blog/moon-v1.24</id>
        <link href="https://moonrepo.dev/blog/moon-v1.24"/>
        <updated>2024-04-17T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[This is a light release that focused solely on requests and improvements from the community.]]></summary>
        <content type="html"><![CDATA[<p>This is a light release that focused solely on requests and improvements from the community.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="exclusive-resources-with-task-mutexes">Exclusive resources with task mutexes<a class="hash-link" aria-label="Direct link to Exclusive resources with task mutexes" title="Direct link to Exclusive resources with task mutexes" href="https://moonrepo.dev/blog/moon-v1.24#exclusive-resources-with-task-mutexes">​</a></h2>
<p>Some tasks may require exclusive access to a resource, like a database, file, or network connection,
but other parallel running tasks may also require access to the same resource. When both of these
tasks run, they may conflict with each other, causing one or both to fail. This wasn't an easy
problem to solve in moon, until now!</p>
<p>Thanks to <a href="https://github.com/castarco" target="_blank" rel="noopener noreferrer">Andrés Correa Casablanca</a> for the idea and implementation,
tasks now support a new option called <a href="https://moonrepo.dev/docs/config/project#mutex"><code>mutex</code></a>. This option allows you
to specify a unique name (across the entire workspace) for the mutex, which will be used to lock the
task from running if another task with the same mutex name is already running.</p>
<p>Take the following for example:</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token comment" style="color:#97a1af;font-style:italic"># server/moon.yml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'build-server'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">mutex</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'app'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># client/moon.yml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'build-client'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">mutex</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'app'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When <a href="https://moonrepo.dev/docs/commands/run"><code>moon run :build</code></a> or <a href="https://moonrepo.dev/docs/commands/ci"><code>moon ci</code></a> is ran, both tasks
will be parallelized within our pipeline, <em>but</em> only one of them will run at a time. If the <code>server</code>
task is running, the <code>client</code> task will wait until the <code>server</code> task is complete. This ensures that
both tasks don't conflict with each other.</p>
<p>This could technically be solved through task <code>deps</code>, but with a mutex, it allows you to decouple
project and task dependencies, and instead focus on a virtual resource that is being locked.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="auto-detect-basehead-for-moon-ci">Auto-detect base/head for <code>moon ci</code><a class="hash-link" aria-label="Direct link to auto-detect-basehead-for-moon-ci" title="Direct link to auto-detect-basehead-for-moon-ci" href="https://moonrepo.dev/blog/moon-v1.24#auto-detect-basehead-for-moon-ci">​</a></h2>
<p>We've updated <a href="https://moonrepo.dev/docs/commands/ci"><code>moon ci</code></a> to try and detect the base and head revisions
automatically when running in a popular CI provider, like GitLab and Jenkins. For the base revision,
we'll use the base/target commit SHA or target branch, while the head revision will use the source
commit SHA or <code>HEAD</code>. This is great for pull requests and forks!</p>
<p>With that said, these values can be overwritten with environment variables, or command line
arguments. Below is the order of precedence:</p>
<ul>
<li><code>MOON_BASE</code> / <code>MOON_HEAD</code> environment variables</li>
<li><code>--base</code> / <code>--head</code> command line arguments</li>
<li><code>base_revision</code> / <code>head_revision</code> via CI provider</li>
<li><code>vcs.defaultBranch</code> setting / <code>HEAD</code> literal value</li>
</ul>
<blockquote>
<p>This functionality is provided by the <a href="https://github.com/milesj/rust-cicd-env" target="_blank" rel="noopener noreferrer"><code>ci_env</code></a> Rust
crate. Please refer to that crate for supported providers, and which of them support revision
detection (primarily the <code>base_revision</code> and <code>head_revision</code> fields).</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="include-dependents-for-focused-project-graph">Include dependents for focused project graph<a class="hash-link" aria-label="Direct link to Include dependents for focused project graph" title="Direct link to Include dependents for focused project graph" href="https://moonrepo.dev/blog/moon-v1.24#include-dependents-for-focused-project-graph">​</a></h2>
<p>When running <a href="https://moonrepo.dev/docs/commands/project-graph"><code>moon project-graph &lt;id&gt;</code></a>, we visualize a graph of the
focused project and all of its dependencies (other projects it depends on). However, if you wanted
to also visualize dependents (other projects that depend on the focused project), this was currently
not possible.</p>
<p>We felt this information could be useful, so we've added a <code>--dependents</code>
flattenDiagnosticMessageText, which will include direct dependents in the graph.</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ moon project-graph server </span><span class="token parameter variable" style="color:#fef9c3">--dependents</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We also felt dependent information can be useful when querying projects, so have also added support
for the <code>--dependents</code> flag to the <a href="https://moonrepo.dev/docs/commands/query/projects"><code>moon query projects</code></a> command.</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ moon query projects </span><span class="token parameter variable" style="color:#fef9c3">--affected</span><span class="token plain"> </span><span class="token parameter variable" style="color:#fef9c3">--dependents</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes" href="https://moonrepo.dev/blog/moon-v1.24#other-changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.24.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added an experimental <code>moon templates</code> command, that lists all available codegen templates.</li>
<li>Added a <code>runner.autoCleanCache</code> setting to <code>.moon/workspace.yml</code>, allowing the post-run clean
mechanism to be controlled.</li>
<li>Updated <code>moon generate</code> with better argument to variable handling.</li>
<li>Updated action graph and project graph visualization to be more readable.</li>
<li>Updated root-level tasks to have no inputs by default, instead of <code>**/*</code>.</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="task" term="task"/>
        <category label="mutex" term="mutex"/>
        <category label="ci" term="ci"/>
        <category label="base" term="base"/>
        <category label="head" term="head"/>
        <category label="project-graph" term="project-graph"/>
        <category label="dependents" term="dependents"/>
        <category label="cache" term="cache"/>
        <category label="clean" term="clean"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[proto v0.34 - New detection strategy, status command, and outdated improvements]]></title>
        <id>https://moonrepo.dev/blog/proto-v0.34</id>
        <link href="https://moonrepo.dev/blog/proto-v0.34"/>
        <updated>2024-04-07T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[In this release, we've focused on the developer experience for common workflows.]]></summary>
        <content type="html"><![CDATA[<p>In this release, we've focused on the developer experience for common workflows.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-only-prototools-detection-strategy">New <code>only-prototools</code> detection strategy<a class="hash-link" aria-label="Direct link to new-only-prototools-detection-strategy" title="Direct link to new-only-prototools-detection-strategy" href="https://moonrepo.dev/blog/proto-v0.34#new-only-prototools-detection-strategy">​</a></h2>
<p>proto currently detects versions at runtime using
<a href="https://moonrepo.dev/docs/proto/config#detect-strategy">1 of 2 strategies</a>, <code>first-available</code> which checks
<code>.prototools</code> files and tool-specific files (like <code>package.json</code> engines), whichever is first, or
<code>prefer-prototools</code> which works like the previous strategy, but prefers <code>.prototools</code> (even in a
parent directory).</p>
<p>In this release, we're adding a 3rd strategy called <code>only-prototools</code>. This strategy will only check
<code>.prototools</code> files and will not check tool-specific files. This is useful if you want explicit
versions, and to avoid unexpected versions from random configs/directories.</p>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.prototools</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">settings</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">detect-strategy</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"only-prototools"</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>For the v1 release, we plan to make this strategy the new default.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-proto-status-command">New <code>proto status</code> command<a class="hash-link" aria-label="Direct link to new-proto-status-command" title="Direct link to new-proto-status-command" href="https://moonrepo.dev/blog/proto-v0.34#new-proto-status-command">​</a></h2>
<p>Sometimes you simply want to know what tools are currently active for a target directory, what
versions those tools are resolved to, and the configuration file in which they are defined. To
satisfy this requirement, we've added a new <a href="https://moonrepo.dev/docs/proto/commands/status"><code>proto status</code></a> command,
which outputs something like the following:</p>
<div class="codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-text codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ proto status</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">Tool  Configured  Resolved  Installed                   Config</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">deno  1.40.0      1.40.0    ~/.proto/tools/deno/1.40.0  ~/.prototools</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">node  20.8.0      20.8.0    ~/.proto/tools/node/20.8.0  ~/.prototools</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">npm   10.1.0      10.1.0    ~/.proto/tools/npm/10.1.0   ~/.prototools</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>By default this includes tools from all <code>.prototools</code> files up the hierarchy, excluding
<code>~/.proto/.prototools</code>. To include global tools as well, pass <code>--include-global</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="improved-proto-outdated-experience">Improved <code>proto outdated</code> experience<a class="hash-link" aria-label="Direct link to improved-proto-outdated-experience" title="Direct link to improved-proto-outdated-experience" href="https://moonrepo.dev/blog/proto-v0.34#improved-proto-outdated-experience">​</a></h2>
<p>The <a href="https://moonrepo.dev/docs/proto/commands/outdated"><code>proto outdated</code></a> command has worked "alright" but its developer
experience wasn't the best. The terminal output was rudimentary, and writing updated versions to
<code>.prototools</code> would save to the current directory, instead of the directory they are configured in.</p>
<p>To improve the overall developer experience, we've made the following changes to this command:</p>
<ul>
<li>Displays all tools and available updates as a table of data.</li>
<li>Includes both newest (matching range) and latest versions available.</li>
<li>Includes the config file that the tool + version was loaded from.</li>
<li>When <code>--update</code> is passed, will now prompt to confirm the update.</li>
<li>When updating versions, versions are now written to their original config file, instead of local.</li>
<li>Updated the <code>--latest</code> flag to use the latest version when updating, instead of newest.</li>
</ul>
<div class="codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-text codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ proto outdated</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">Tool  Current  Newest   Latest  Config</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">deno  1.40.0   1.42.4   1.42.4  ~/.prototools</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">node  20.8.0   20.12.2  21.7.3  ~/.prototools</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">npm   10.1.0   10.5.2   10.5.2  ~/.prototools</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="what-about-v032-and-v033">What about v0.32 and v0.33?<a class="hash-link" aria-label="Direct link to What about v0.32 and v0.33?" title="Direct link to What about v0.32 and v0.33?" href="https://moonrepo.dev/blog/proto-v0.34#what-about-v032-and-v033">​</a></h2>
<p>You may have noticed that we don't have blog posts for either of these versions. The v0.32 release
was a relatively light release with no meaningful changes, so we opted to not write a blog post for
it. As for v0.33, we ran into build issues while releasing it, so we decided to skip it and move on
to v0.34.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes" href="https://moonrepo.dev/blog/proto-v0.34#other-changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/proto/releases/tag/v0.34.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added a <code>dist-url</code> setting to some plugins, allowing the distribution download URL to be
customized.</li>
<li>Updated <code>proto setup</code> (which is ran during proto installation) to modify the <code>PATH</code> system
environment variable on Windows. To disable this functionality, pass <code>--no-modify-path</code>.</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="detection" term="detection"/>
        <category label="status" term="status"/>
        <category label="outdated" term="outdated"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[moon v1.23 - Codegen improvements, stack inheritance, internal tasks, and more]]></title>
        <id>https://moonrepo.dev/blog/moon-v1.23</id>
        <link href="https://moonrepo.dev/blog/moon-v1.23"/>
        <updated>2024-03-25T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[It's been a month since our last release, and we're excited to land major codegen and task]]></summary>
        <content type="html"><![CDATA[<p>It's been a month since our last release, and we're excited to land major codegen and task
improvements.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="template--generator-improvements">Template &amp; generator improvements<a class="hash-link" aria-label="Direct link to Template &amp; generator improvements" title="Direct link to Template &amp; generator improvements" href="https://moonrepo.dev/blog/moon-v1.23#template--generator-improvements">​</a></h2>
<p>Based on feedback and requests from community, we've made quite a few improvements to our code
generation workflow!</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="git-and-npm-template-locators">Git and npm template locators<a class="hash-link" aria-label="Direct link to Git and npm template locators" title="Direct link to Git and npm template locators" href="https://moonrepo.dev/blog/moon-v1.23#git-and-npm-template-locators">​</a></h3>
<p>Our <a href="https://moonrepo.dev/docs/config/workspace#templates"><code>generator.templates</code></a> setting has only supported file system
paths, relative from the workspace root. This has made it quite difficult to share templates across
repositories, but no longer!</p>
<p>Template locations now support Git repositories and npm packages, through the <code>git:</code> and <code>npm:</code>
prefixes respectively. The <code>git:</code> locator requires a Git repository URL and explicit revision
(branch, commit, etc), while the <code>npm:</code> locator requires a package name and explicit version. For
example:</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">moon.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">generator</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">templates</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'git://github.com/moonrepo/templates#master'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'npm://@moonrepo/templates#1.2.3'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>Learn more about this in the official
<a href="https://moonrepo.dev/docs/guides/codegen#configuring-template-locations">code generation guide</a>!</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="custom-template-names">Custom template names<a class="hash-link" aria-label="Direct link to Custom template names" title="Direct link to Custom template names" href="https://moonrepo.dev/blog/moon-v1.23#custom-template-names">​</a></h3>
<p>Historically, a template's name was derived from the directory the
<a href="https://moonrepo.dev/docs/config/template"><code>template.yml</code></a> file was located in. While this works great for small repos,
it falls apart for large monorepos when there's multiple teams defining templates, as the chance of
name collisions arise.</p>
<p>To combat this problem, we're introducing a new <a href="https://moonrepo.dev/docs/config/template#id"><code>id</code> setting</a> for
templates, which allows you to customize the exact name of the template. This setting is optional,
and if not provided, the name will be derived from the directory as before.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">template.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">id</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'my-template'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="new-variable-settings">New variable settings<a class="hash-link" aria-label="Direct link to New variable settings" title="Direct link to New variable settings" href="https://moonrepo.dev/blog/moon-v1.23#new-variable-settings">​</a></h3>
<p>And lastly, we're introducing some additions and improvements to template
<a href="https://moonrepo.dev/docs/config/template#variables"><code>variables</code></a>.</p>
<ul>
<li>A new <code>order</code> setting, which defines the order in which variables are prompted to the user.</li>
<li>A new <code>internal</code> setting, which avoids the value being set from the CLI.</li>
<li>Enum <code>default</code> values now support a list of values (cannot be provided by the CLI yet).</li>
<li>Enum <code>prompt</code>s are now optional, and will fallback to the default value if not provided.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="stack-based-task-inheritance">Stack-based task inheritance<a class="hash-link" aria-label="Direct link to Stack-based task inheritance" title="Direct link to Stack-based task inheritance" href="https://moonrepo.dev/blog/moon-v1.23#stack-based-task-inheritance">​</a></h2>
<p>Last month in <a href="https://moonrepo.dev/blog/moon-v1.22">moon v1.22</a>, we introduced the <a href="https://moonrepo.dev/docs/config/project#stack"><code>stack</code></a>
setting for organizing projects into what tech stack they belong to. This is primarily for
organizational purposes, and improving our project constaints implementation.</p>
<p>Based on community feeedback, we've expanded the <code>stack</code> setting to also apply for
<a href="http://localhost:3000/docs/concepts/task-inheritance#scope-by-project-metadata" target="_blank" rel="noopener noreferrer">task inheritance</a>.
You can now inherit tasks for the stack itself, or through a combination of the project language,
platform, and type. For example:</p>
<ul>
<li><code>.moon/tasks/backend.yml</code></li>
<li><code>.moon/tasks/javascript-backend.yml</code></li>
<li><code>.moon/tasks/frontend-library.yml</code></li>
<li><code>.moon/tasks/bun-frontend-application.yml</code></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="internal-tasks">Internal tasks<a class="hash-link" aria-label="Direct link to Internal tasks" title="Direct link to Internal tasks" href="https://moonrepo.dev/blog/moon-v1.23#internal-tasks">​</a></h2>
<p>We're introducing a new <a href="https://moonrepo.dev/docs/concepts/task#modes">task mode</a> called internal, which can be enabled
with the <a href="https://moonrepo.dev/docs/config/project#internal"><code>internal</code></a> task option. Internal tasks are tasks that are
not meant to be ran explicitly by the user (via <a href="https://moonrepo.dev/docs/commands/check"><code>moon check</code></a> or
<a href="https://moonrepo.dev/docs/commands/run"><code>moon run</code></a>), but are used internally as dependencies of other tasks.</p>
<p>This functionality provides another way to organize your tasks.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">moon.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">prepare</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'intermediate-step'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">internal</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">true</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes" href="https://moonrepo.dev/blog/moon-v1.23#other-changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.23.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added a <code>variables()</code> function for templates that returns an object of all variables available.</li>
<li>Updated <code>moon project</code> and <code>moon task</code> to include the configuration files that tasks inherit from.</li>
<li>Updated <code>moon task</code> to include the modes it belongs to.</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="tasks" term="tasks"/>
        <category label="codegen" term="codegen"/>
        <category label="template" term="template"/>
        <category label="tack" term="tack"/>
        <category label="inheritance" term="inheritance"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[proto v0.31 - Improved version pinning, removed global packages management, and more]]></title>
        <id>https://moonrepo.dev/blog/proto-v0.31</id>
        <link href="https://moonrepo.dev/blog/proto-v0.31"/>
        <updated>2024-03-01T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[In preparation for an official v1 release, we've improved stability, the overall developer]]></summary>
        <content type="html"><![CDATA[<p>In preparation for an official v1 release, we've improved stability, the overall developer
experience, we're renaming some commands, and removing the "global packages" functionality.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="improved-version-pinning">Improved version pinning<a class="hash-link" aria-label="Direct link to Improved version pinning" title="Direct link to Improved version pinning" href="https://moonrepo.dev/blog/proto-v0.31#improved-version-pinning">​</a></h2>
<p>Based on feedback from the community, we've made some slight changes to pinning to reduce confusion.
The biggest points of contention were, "Why does <code>proto install --pin</code> pin globally?", and "Why
doesn't <code>proto pin</code> resolve the version like <code>proto install --pin</code> does?".</p>
<p>To remedy the first issue, we've updated the <code>--pin</code> argument to optionally support a string value
of "local" or "global". When local, will pin to the <code>.prototools</code> file in the current directory,
otherwise it will pin to <code>~/.proto/.prototools</code>.</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ proto </span><span class="token function" style="color:#ff94ff;font-weight:bold">install</span><span class="token plain"> </span><span class="token function" style="color:#ff94ff;font-weight:bold">node</span><span class="token plain"> </span><span class="token parameter variable" style="color:#fef9c3">--pin</span><span class="token plain"> </span><span class="token comment" style="color:#97a1af;font-style:italic"># global</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ proto </span><span class="token function" style="color:#ff94ff;font-weight:bold">install</span><span class="token plain"> </span><span class="token function" style="color:#ff94ff;font-weight:bold">node</span><span class="token plain"> </span><span class="token parameter variable" style="color:#fef9c3">--pin</span><span class="token plain"> global</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ proto </span><span class="token function" style="color:#ff94ff;font-weight:bold">install</span><span class="token plain"> </span><span class="token function" style="color:#ff94ff;font-weight:bold">node</span><span class="token plain"> </span><span class="token parameter variable" style="color:#fef9c3">--pin</span><span class="token plain"> </span><span class="token builtin class-name" style="color:#ff94ff;font-weight:bold">local</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As for the second issue, we've introduced a new option called <code>--resolve</code>, which will resolve the
version to a fully qualified semantic version (or fail). This isn't the default functionality, as to
not break existing workflows, and because you may want to actually pin "1" instead of "1.2.3".</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ proto pin </span><span class="token function" style="color:#ff94ff;font-weight:bold">node</span><span class="token plain"> </span><span class="token number" style="color:#94dded">1</span><span class="token plain"> </span><span class="token comment" style="color:#97a1af;font-style:italic"># 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ proto pin </span><span class="token function" style="color:#ff94ff;font-weight:bold">node</span><span class="token plain"> </span><span class="token number" style="color:#94dded">1</span><span class="token plain"> </span><span class="token parameter variable" style="color:#fef9c3">--resolve</span><span class="token plain"> </span><span class="token comment" style="color:#97a1af;font-style:italic"># 1.2.3</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="removed-global-package-management-breaking">Removed global package management (breaking)<a class="hash-link" aria-label="Direct link to Removed global package management (breaking)" title="Direct link to Removed global package management (breaking)" href="https://moonrepo.dev/blog/proto-v0.31#removed-global-package-management-breaking">​</a></h2>
<p>A while back we introduced the <code>proto install-global</code> and <code>proto uninstall-global</code> commands as a
means for managing global packages. This was added to solve issues with the Node.js ecosystem,
primarily around standardizing where global packages would be installed across all package managers.
On top of this, we also introduced a "command interception" feature, which would error telling you
to use proto's command instead of the package manager's.</p>
<p>As a whole, this feature was <em>very</em> disruptive to users, caused a lot of confusion, was simply
poorly implemented, and honestly wasn't really necessary for tools outside of Node.js. Because of
all of this, we've decided to entirely remove our global package management functionality, this
includes:</p>
<ul>
<li><code>proto install-global</code> command</li>
<li><code>proto uninstall-global</code> command</li>
<li><code>proto list-global</code> command</li>
<li><code>intercept-globals</code> setting for node/npm/pnpm/yarn</li>
<li><code>globals</code> setting for TOML plugins</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-npmpnpmyarn-shared-globals-dir-setting">New npm/pnpm/yarn <code>shared-globals-dir</code> setting<a class="hash-link" aria-label="Direct link to new-npmpnpmyarn-shared-globals-dir-setting" title="Direct link to new-npmpnpmyarn-shared-globals-dir-setting" href="https://moonrepo.dev/blog/proto-v0.31#new-npmpnpmyarn-shared-globals-dir-setting">​</a></h2>
<p>Since we removed our global packages support (above), we had to also remove the <code>intercept-globals</code>
setting from our Node.js related WASM plugins. However, we still believed in the benefit it
provided, primarily around standardizing where global packages would be installed across all package
managers.</p>
<p>To still support this in some capacity, we've introduced a new <code>shared-globals-dir</code> setting for npm,
pnpm, and yarn. This setting still standardizes the install path, <em>but instead</em> of intercepting
commands like it did before, it now appends the global package install commands with additional
arguments or environment variables. This should be entirely transparent to you!</p>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.prototools</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">tools.npm</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">shared-globals-dir</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token boolean" style="color:#94dded">true</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>An example of how this now works:</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token comment" style="color:#97a1af;font-style:italic"># &lt; v0.31</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">proto install-global </span><span class="token function" style="color:#ff94ff;font-weight:bold">npm</span><span class="token plain"> typescript</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># &gt;= v0.31</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token function" style="color:#ff94ff;font-weight:bold">npm</span><span class="token plain"> </span><span class="token function" style="color:#ff94ff;font-weight:bold">install</span><span class="token plain"> </span><span class="token parameter variable" style="color:#fef9c3">--global</span><span class="token plain"> typescript</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Under the hood becomes...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token assign-left variable" style="color:#fef9c3">PREFIX</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token plain">/.proto/tools/node/globals </span><span class="token function" style="color:#ff94ff;font-weight:bold">npm</span><span class="token plain"> </span><span class="token function" style="color:#ff94ff;font-weight:bold">install</span><span class="token plain"> </span><span class="token parameter variable" style="color:#fef9c3">--global</span><span class="token plain"> typescript</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="renamed-commands-breaking">Renamed commands (breaking)<a class="hash-link" aria-label="Direct link to Renamed commands (breaking)" title="Direct link to Renamed commands (breaking)" href="https://moonrepo.dev/blog/proto-v0.31#renamed-commands-breaking">​</a></h2>
<p>We're still not happy with some of the current command names, especially around tools and plugins,
so we've renamed a few of them. They are:</p>
<ul>
<li>Renamed the <code>proto tool</code> commands to <code>proto plugin</code>. An alias still exists for the time being.</li>
<li>Removed the <code>proto tool list-plugins</code> command, and merged its functionality into
<code>proto plugin list</code>.</li>
</ul>
<p>As for the <code>proto plugin list</code> command, we've removed the versions and aliases from the output by
default, and wrapped them in new <code>--versions</code> and <code>--aliases</code> options.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes" href="https://moonrepo.dev/blog/proto-v0.31#other-changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/proto/releases/tag/v0.31.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Fixed an issue where empty version strings were being parsed, causing failures.</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="proto" term="proto"/>
        <category label="version" term="version"/>
        <category label="pin" term="pin"/>
        <category label="global" term="global"/>
        <category label="packages" term="packages"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[moon v1.22 - Organizational settings, wildcard env var inputs, and Nx migration]]></title>
        <id>https://moonrepo.dev/blog/moon-v1.22</id>
        <link href="https://moonrepo.dev/blog/moon-v1.22"/>
        <updated>2024-02-26T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[This release introduces new organizational settings for projects, a migrate from Nx extension, and]]></summary>
        <content type="html"><![CDATA[<p>This release introduces new organizational settings for projects, a migrate from Nx extension, and
more.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="more-organizational-settings">More organizational settings<a class="hash-link" aria-label="Direct link to More organizational settings" title="Direct link to More organizational settings" href="https://moonrepo.dev/blog/moon-v1.22#more-organizational-settings">​</a></h2>
<p>One aspect of moon that sets us apart from other build systems and tools, is that we have built-in
support for human-readable project and task metadata. This is extremely useful in organizing and
managing large repositories, especially when ownership comes into play. This information is also
used for categorization and filtering for MQL and our editor extensions/plugins.</p>
<p>To expand on this functionality even further, we're adding a few requests from the community, and
they are:</p>
<ul>
<li>
<p>New <code>configuration</code> and <code>scaffolding</code> variants for the project <a href="https://moonrepo.dev/docs/config/project#type"><code>type</code></a>
setting in <a href="https://moonrepo.dev/docs/config/project"><code>moon.yml</code></a>. Perfect for contracts and templates.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">type</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'configuration'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>New <a href="https://moonrepo.dev/docs/config/project#stack"><code>stack</code></a> setting in <a href="https://moonrepo.dev/docs/config/project"><code>moon.yml</code></a>, for
categorizing which tech stack the project belongs to. Supports <code>frontend</code>, <code>backend</code>,
<code>infrastructure</code>, and <code>systems</code>.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">stack</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'frontend'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>New <a href="https://moonrepo.dev/docs/config/project#description-1"><code>description</code></a> setting for tasks, that provides
human-readable information.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">description</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'Builds the project using Vite'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'vite build'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-wildcard-environment-variable-inputs">New wildcard environment variable inputs<a class="hash-link" aria-label="Direct link to New wildcard environment variable inputs" title="Direct link to New wildcard environment variable inputs" href="https://moonrepo.dev/blog/moon-v1.22#new-wildcard-environment-variable-inputs">​</a></h2>
<p>Task inputs have supported environment variables for quite a while now, but they are explicit, which
can be tedious too manage when you have many environment variables. To make this easier, we've added
support for wildcard environment variables, denoted by a <code>*</code>, which will match any environment
variable with that pattern.</p>
<p>For example, say we want to track all Node.js and Vite environment variables that start with <code>NODE_</code>
and <code>VITE_</code> respectively, we can simply do:</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'vite build'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">inputs</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'$NODE_*'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'$VITE_*'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>Do note that this <em>isn't</em> a glob, and the <code>*</code> is merely a substitution for any character!</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-migrate-nx-extension">New <code>migrate-nx</code> extension<a class="hash-link" aria-label="Direct link to new-migrate-nx-extension" title="Direct link to new-migrate-nx-extension" href="https://moonrepo.dev/blog/moon-v1.22#new-migrate-nx-extension">​</a></h2>
<p>In our previous release, we added support for <a href="https://moonrepo.dev/blog/moon-v1.21">migrating from Turborepo</a>, but what
about Nx? Nx is a very popular build system with many users. A lot of our current moon users were
former Nx users, but unfortunately, they had to go through the tedious process of migrating
everything manually. We wanted to make this process easier for new users, so we created a new
experimental extension to help with this process,
<a href="https://moonrepo.dev/docs/guides/extensions#migrate-nx"><code>migrate-nx</code></a>.</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ moon ext migrate-nx</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This extension was quite complicated to implement, as Nx has a <em>ton</em> of features. However, when the
extension is executed, we'll convert the root <code>nx.json</code> and <code>workspace.json</code> files to
<a href="https://moonrepo.dev/docs/config/workspace"><code>.moon/workspace.yml</code></a> and related top-level config files, and we'll also
convert every <code>project.json</code> and <code>package.json</code> (with an <code>nx</code> block) into a
<a href="https://moonrepo.dev/docs/config/project"><code>moon.yml</code></a> file.</p>
<p>Conversion is not a perfect 1:1, as moon and Nx are quite different. Please refer to the
<a href="https://moonrepo.dev/docs/guides/extensions#migrate-nx">official documentation</a> for a list of unsupported settings and
features.</p>
<div class="theme-admonition theme-admonition-info admonition_WCGJ alert alert--info"><div class="admonitionHeading_GCBg"><span class="admonitionIcon_L39b"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_pbrs"><p>An awesome feature that didn't make it in time for this release, is an npm package for Nx
compatiblity, that will allow Nx executors/plugins to be executed through moon, without the
requirement of Nx itself. This will allow for a seamless transition from Nx to moon, without the
need to change any of your existing Nx executors/plugins till later.</p><p>This functionality will be provided by our new
<a href="https://github.com/moonrepo/moon/tree/master/packages/nx-compat" target="_blank" rel="noopener noreferrer"><code>@moonrepo/nx-compat</code> package</a>,
which we hope to finish in the coming weeks.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes" href="https://moonrepo.dev/blog/moon-v1.22#other-changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.22.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added an <code>installArgs</code> setting for bun/npm/pnpm/yarn in <code>.moon/toolchain.yml</code>, to customize the
args used when installing dependencies.</li>
<li>Updated the <code>envFile</code> task option to support a list of file paths.</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="project" term="project"/>
        <category label="metadata" term="metadata"/>
        <category label="nx" term="nx"/>
        <category label="migrate" term="migrate"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[moon v1.21 - Deno tier 3, file group improvements, task shells, and more!]]></title>
        <id>https://moonrepo.dev/blog/moon-v1.21</id>
        <link href="https://moonrepo.dev/blog/moon-v1.21"/>
        <updated>2024-02-07T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[With this release, get ready for Deno tier 3 support, file group and task improvements, a new]]></summary>
        <content type="html"><![CDATA[<p>With this release, get ready for Deno tier 3 support, file group and task improvements, a new
extension, and more.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="deno-tier-3-support">Deno tier 3 support<a class="hash-link" aria-label="Direct link to Deno tier 3 support" title="Direct link to Deno tier 3 support" href="https://moonrepo.dev/blog/moon-v1.21#deno-tier-3-support">​</a></h2>
<p>We've supported Deno tier 1 and 2 for almost a year now, but were hesitant to support tier 3 until
<a href="https://moonrepo.dev/proto">proto</a> stabilizes further. Now that proto is <em>almost</em> at an official v1 release, and other
tools in the toolchain (like Node.js, Bun, and Rust) are powered by proto, we're confident in
supporting Deno tier 3. To make use of this, simply set the
<a href="https://moonrepo.dev/docs/config/toolchain#deno"><code>deno.version</code></a> setting in
<a href="https://moonrepo.dev/docs/config/toolchain"><code>.moon/toolchain.yml</code></a>.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.moon/toolchain.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">deno</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">version</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'1.40.0'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When enabled, moon will download and install that version of Deno in the background, and run all
subsequent tasks with it. This is great for ensuring that your project is always using the same
version of Deno, across all machines.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="file-groups-now-support-environment-variables">File groups now support environment variables<a class="hash-link" aria-label="Direct link to File groups now support environment variables" title="Direct link to File groups now support environment variables" href="https://moonrepo.dev/blog/moon-v1.21#file-groups-now-support-environment-variables">​</a></h2>
<p>Task <a href="https://moonrepo.dev/docs/config/project#inputs"><code>inputs</code></a> have supported environment variables for a while now,
but file groups have not. The main reason for this is that file groups were implemented far before
environment variables in task inputs! To bridge this gap, we've added support for environment
variables in file groups.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">fileGroups</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">vite</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'...'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'$VITE_SECRET_KEY'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'$NODE_ENV'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'vite build'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">inputs</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'@group(vite)'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Environment variables can be referenced using the
<a href="https://moonrepo.dev/docs/concepts/token#group"><code>@group</code> token function</a>, or the new
<a href="https://moonrepo.dev/docs/concepts/token#envs"><code>@envs</code> token function</a>. The latter is only supported for <code>inputs</code> and
will error for other locations, while the former is supported in <code>args</code>, <code>inputs</code>, and <code>outputs</code>,
but will filter out environment variables when they are not supported.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-unixshell-and-windowsshell-task-options">New <code>unixShell</code> and <code>windowsShell</code> task options<a class="hash-link" aria-label="Direct link to new-unixshell-and-windowsshell-task-options" title="Direct link to new-unixshell-and-windowsshell-task-options" href="https://moonrepo.dev/blog/moon-v1.21#new-unixshell-and-windowsshell-task-options">​</a></h2>
<p>When the <a href="https://moonrepo.dev/docs/config/project#shell"><code>shell</code></a> task option is enabled, we run the task within a
shell. However, the chosen shell was hard-coded to <code>$SHELL</code> on Unix machines and PowerShell on
Windows, but what if you wanted to run it with a different shell? Or the same shell across all
operating systems? Well, you couldn't.</p>
<p>But not anymore! With this release, we're introducing <a href="https://moonrepo.dev/docs/config/project#unixshell"><code>unixShell</code></a>
and <a href="https://moonrepo.dev/docs/config/project#windowsshell"><code>windowsShell</code></a> task options. When paired with <code>shell</code>, the
task will run in a shell of your choice. For example, why not Bash everywhere?</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">moon.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'vite build'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">shell</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">unixShell</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'bash'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">windowsShell</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'bash'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-migrate-turborepo-extension">New <code>migrate-turborepo</code> extension<a class="hash-link" aria-label="Direct link to new-migrate-turborepo-extension" title="Direct link to new-migrate-turborepo-extension" href="https://moonrepo.dev/blog/moon-v1.21#new-migrate-turborepo-extension">​</a></h2>
<p>In our previous release, we added support for <a href="https://moonrepo.dev/blog/moon-v1.20">extensions, a new kind of WASM plugin</a>.
Since this is a new experimental feature, we really wanted to show off what it can do, and stress
test its boundaries. To do that, we chose to migrate the old <code>moon migrate from-turborepo</code> command
into an extension
(<a href="https://github.com/moonrepo/moon-extensions/tree/master/crates/migrate-turborepo" target="_blank" rel="noopener noreferrer">source can be found here</a>).
This is our most complex extension so far, as it:</p>
<ul>
<li>Loads and parses files on the file system.</li>
<li>Reads and writes JSON and YAML files.</li>
<li>Supports deserializing data into structs.</li>
<li>Extracts project graph information by executing <code>moon project-graph</code>.</li>
</ul>
<p>Do you currently have a Turborepo powered repository? And want to migrate to moon? Then simply
execute the extension as such. View our
<a href="https://moonrepo.dev/docs/guides/extensions#migrate-turborepo">guide for more information</a>!</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ moon ext migrate-turborepo</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As part of the migration from moon's Rust core into a WASM plugin, we've added support for the
following new features:</p>
<ul>
<li>Added Bun support behind a new <code>--bun</code> flag.</li>
<li>Added support for Turbo's <code>globalDotEnv</code>, <code>dotEnv</code>, and <code>outputMode</code>.</li>
<li>Added support for root-level tasks (<code>//#</code>) through a root <code>moon.yml</code>, instead of logging a
warning.</li>
<li>Updated migrated task commands to run through a package manager, instead of
<code>moon node run-script</code>.</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_WCGJ alert alert--info"><div class="admonitionHeading_GCBg"><span class="admonitionIcon_L39b"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_pbrs"><p>Based on the success of this extension, we plan to support a <code>migrate-nx</code> extension in the future!
If you'd like to help in this endeavor, let us know!</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes" href="https://moonrepo.dev/blog/moon-v1.21#other-changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.21.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added <code>bun.inferTasksFromScripts</code> setting to <code>.moon/toolchain.yml</code>, for compatibility with
Node.js.</li>
<li>Added a <code>--quiet</code> global argument, for hiding non-critical moon output.</li>
<li>Updated tasks with glob-like arguments to automatically enabled the <code>shell</code> option, so that glob
expansion works correctly.</li>
<li>Implemented a new buffered console layer for writing to stdout/stderr.</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="deno" term="deno"/>
        <category label="file-groups" term="file-groups"/>
        <category label="env" term="env"/>
        <category label="shell" term="shell"/>
        <category label="tasks" term="tasks"/>
        <category label="turborepo" term="turborepo"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[moon v1.20 - Extension plugins, default task options, and more]]></title>
        <id>https://moonrepo.dev/blog/moon-v1.20</id>
        <link href="https://moonrepo.dev/blog/moon-v1.20"/>
        <updated>2024-01-26T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[In this release, we're excited to introduce extensions, our first type of plugin!]]></summary>
        <content type="html"><![CDATA[<p>In this release, we're excited to introduce extensions, our first type of plugin!</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-extension-plugins">New extension plugins<a class="hash-link" aria-label="Direct link to New extension plugins" title="Direct link to New extension plugins" href="https://moonrepo.dev/blog/moon-v1.20#new-extension-plugins">​</a></h2>
<p>In our <a href="https://moonrepo.dev/blog/2024-roadmap">2024 roadmap blog post</a>, we talked heavily about plugins, as we believe
they're the future of moon and its ecosystem. What we didn't talk about is that we plan to have
<em>many types of plugins</em>, and not just language/platform specific ones. And with that, we're excited
to introduce extensions!</p>
<p>An extension is a WASM plugin that allows you to extend moon with additional functionality, have
whitelisted access to the file system, and receive partial information about the current workspace.
Extensions are extremely useful in offering new and unique functionality that doesn't need to be
built into moon's core.</p>
<p>Once such extension is our built-in <code>download</code> extension, which is a basic extension that simply
downloads a file from a URL into the current moon workspace.</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ moon ext download -- </span><span class="token parameter variable" style="color:#fef9c3">--url</span><span class="token plain"> https://github.com/moonrepo/proto/releases/latest/download/proto_cli-aarch64-apple-darwin.tar.xz</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Shipping alongside extensions are the following new features:</p>
<ul>
<li>An <a href="https://moonrepo.dev/docs/guides/extensions">official extensions guide</a>!</li>
<li>An <a href="https://moonrepo.dev/docs/config/workspace#extensions"><code>extensions</code></a> setting for configuring new extensions.</li>
<li>A <a href="https://moonrepo.dev/docs/commands/ext"><code>moon ext</code></a> command for executing a configured extension.</li>
<li>The required infrastructure for plugins!</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="configure-default-options-for-tasks">Configure default options for tasks<a class="hash-link" aria-label="Direct link to Configure default options for tasks" title="Direct link to Configure default options for tasks" href="https://moonrepo.dev/blog/moon-v1.20#configure-default-options-for-tasks">​</a></h2>
<p><a href="https://moonrepo.dev/docs/config/project#options">Task options</a> provide a way to apply granular changes to a task's
behavior when running in the pipeline. However, they can become tedious when you need to apply them
to many tasks, especially when inheritance is involved. To help with this, you can now configure the
<a href="https://moonrepo.dev/docs/config/tasks#taskoptions"><code>taskOptions</code></a> setting in task related configs, like
<code>.moon/tasks.yml</code> and <code>.moon/tasks/*.yml</code>, which acts as the base/default options for all inherited
tasks.</p>
<p>For example, the following config:</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.moon/tasks.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token comment" style="color:#97a1af;font-style:italic"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">outputStyle</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'stream'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">retryCount</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">lint</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token comment" style="color:#97a1af;font-style:italic"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">outputStyle</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'stream'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">retryCount</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">test</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token comment" style="color:#97a1af;font-style:italic"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">outputStyle</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'stream'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">retryCount</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">2</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Can simply be rewritten as:</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.moon/tasks.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">taskOptions</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">outputStyle</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'stream'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">retryCount</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token comment" style="color:#97a1af;font-style:italic"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">lint</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token comment" style="color:#97a1af;font-style:italic"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">test</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token comment" style="color:#97a1af;font-style:italic"># ...</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Because these options are defined at the workspace-level, they adhere to the same merge and
inheritance rules as other settings. Just be aware that these options are inherited first in the
chain, and can be overwritten by other layers, or by project-level tasks.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="optional-task-dependencies">Optional task dependencies<a class="hash-link" aria-label="Direct link to Optional task dependencies" title="Direct link to Optional task dependencies" href="https://moonrepo.dev/blog/moon-v1.20#optional-task-dependencies">​</a></h2>
<p>By default, all task <a href="https://moonrepo.dev/docs/config/project#tasks-1"><code>deps</code></a> are required to exist when tasks are
being built and expanded, but this isn't always true when dealing with composition and inheritance.
For example, say you're using
<a href="https://moonrepo.dev/docs/concepts/task-inheritance#scope-by-project-metadata">tag-based inheritance</a>, and a global
task relies on one of these tagged tasks, but not all projects may define the appropriate tags. In
previous versions of moon, this is a hard failure, as the dependent task does not exist.</p>
<p>To remedy this, we're introducing a new <a href="https://moonrepo.dev/docs/config/project#optional-1"><code>optional</code></a> flag for task
dependencies. When set to <code>true</code>, moon will no longer error when the task doesn't exist, and instead
will omit the dependency.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.moon/tasks.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'vite'</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">deps</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token key atrule">target</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'#components:build'</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#e5e9f1"><span class="token plain">        </span><span class="token key atrule">optional</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">true</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>Thanks to <a href="https://github.com/maastrich" target="_blank" rel="noopener noreferrer">@maastrich</a> for this contribution!</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes" href="https://moonrepo.dev/blog/moon-v1.20#other-changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.20.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added a "Tags" view to the VSCode extension.</li>
<li>Updated proto to v0.29.1 (from v0.26.4).</li>
<li>Updated proto installation to trigger for all applicable commands, not just <code>moon run</code>,
<code>moon check</code>, and <code>moon ci</code>.</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="task" term="task"/>
        <category label="options" term="options"/>
        <category label="extensions" term="extensions"/>
        <category label="plugins" term="plugins"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[proto v0.29 - Better environment support]]></title>
        <id>https://moonrepo.dev/blog/proto-v0.29</id>
        <link href="https://moonrepo.dev/blog/proto-v0.29"/>
        <updated>2024-01-23T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[In this release, we focused heavily on environment interoperability.]]></summary>
        <content type="html"><![CDATA[<p>In this release, we focused heavily on environment interoperability.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-environment-aware-configuration">New environment aware configuration<a class="hash-link" aria-label="Direct link to New environment aware configuration" title="Direct link to New environment aware configuration" href="https://moonrepo.dev/blog/proto-v0.29#new-environment-aware-configuration">​</a></h2>
<p>We've made a small but useful improvement to <code>.prototools</code>, environment aware files! When the
<code>PROTO_ENV</code> environment variable is set, proto will look for an additional <code>.prototools.{env}</code> file
and merge it with the base configuration.</p>
<p>This is useful for certain deploy scenarios where you need different versions of tools, environment
variables, or settings!</p>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.prototools</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key property" style="color:#b7a9f9">node</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"21.0.0"</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.prototools.production</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key property" style="color:#b7a9f9">node</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"20.0.0"</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-env-and-toolsenv-settings">New <code>[env]</code> and <code>[tools.*.env]</code> settings<a class="hash-link" aria-label="Direct link to new-env-and-toolsenv-settings" title="Direct link to new-env-and-toolsenv-settings" href="https://moonrepo.dev/blog/proto-v0.29#new-env-and-toolsenv-settings">​</a></h2>
<p>We're also introducing 2 new settings to the <code>.prototools</code> file, <a href="https://moonrepo.dev/docs/proto/config#env"><code>[env]</code></a>
and <a href="https://moonrepo.dev/docs/proto/config#toolsenv"><code>[tools.*.env]</code></a>, both of which configure environment variables
that'll be applied when the tool is executed. This is useful for defining directory-level and
tool-specific variables.</p>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.prototools</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">env</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">DEBUG</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"*"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">tools.node.env</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">NODE_ENV</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"production"</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>View the <a href="https://moonrepo.dev/docs/proto/config">configuration documentation</a> for more information on how these work!</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes" href="https://moonrepo.dev/blog/proto-v0.29#other-changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/proto/releases/tag/v0.29.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Updated <code>proto tool info</code> to display aliases and environment variables.</li>
<li>Updated WASM logs to be shown alongside proto's <code>--log</code> output (under the <code>extism::pdk</code>
namespace).</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="proto" term="proto"/>
        <category label="environment" term="environment"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[proto v0.28 - Upgraded WASM runtime]]></title>
        <id>https://moonrepo.dev/blog/proto-v0.28</id>
        <link href="https://moonrepo.dev/blog/proto-v0.28"/>
        <updated>2024-01-17T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[This is a small release that primarily upgrades our WASM runtime.]]></summary>
        <content type="html"><![CDATA[<p>This is a small release that primarily upgrades our WASM runtime.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="upgraded-wasm-runtime">Upgraded WASM runtime<a class="hash-link" aria-label="Direct link to Upgraded WASM runtime" title="Direct link to Upgraded WASM runtime" href="https://moonrepo.dev/blog/proto-v0.28#upgraded-wasm-runtime">​</a></h2>
<p>proto utilizes <a href="https://extism.org/" target="_blank" rel="noopener noreferrer">Extism</a> for our WASM plugin architecture, which internally uses
<a href="https://wasmtime.dev/" target="_blank" rel="noopener noreferrer">wasmtime</a> as our execution runtime. Up until this point, we've been using a
beta release of Extism, v0.5, which has worked quite nicely. We've also been working closely with
the Extism team to report bugs, provide feedback, and help improve the project. Once such feature
was the massive performance gains in <a href="https://moonrepo.dev/blog/proto-v0.24">proto v0.24</a>.</p>
<p>Thanks to all the hard work from the Extism team over the past year, an official v1.0 was released.
Because this was a major release, it did include breaking changes around the WASM runtime, and as
such, proto WASM plugins before v0.28 are <em>no longer compatible</em>, and will need to be recompiled
with the latest PDKs. Our proto TOML plugins are not affected.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes" href="https://moonrepo.dev/blog/proto-v0.28#other-changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/proto/releases/tag/v0.28.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Will now display an upgrade message when the current proto version is out of date.</li>
<li>Improved error messages to include plugin specific information.</li>
<li>Updated our "last used at" logic to avoid race conditions with the tool manifest.</li>
</ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="proto" term="proto"/>
        <category label="wasm" term="wasm"/>
        <category label="runtime" term="runtime"/>
        <category label="extism" term="extism"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[What's in store for 2024]]></title>
        <id>https://moonrepo.dev/blog/2024-roadmap</id>
        <link href="https://moonrepo.dev/blog/2024-roadmap"/>
        <updated>2024-01-12T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Happy new year! Let's start 2024 by reflecting on last year and diving into our tentative year long]]></summary>
        <content type="html"><![CDATA[<p>Happy new year! Let's start 2024 by reflecting on last year and diving into our tentative year long
roadmap.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="year-2023-in-review">Year 2023 in review<a class="hash-link" aria-label="Direct link to Year 2023 in review" title="Direct link to Year 2023 in review" href="https://moonrepo.dev/blog/2024-roadmap#year-2023-in-review">​</a></h2>
<p>Last year was an extremely exciting year for us! To start, we were accepted into the
<a href="https://www.ycombinator.com/companies/moonrepo" target="_blank" rel="noopener noreferrer">Y Combinator 2023 winter batch</a>, which was
extremely unexpected, but very much welcome. The 3 months we spent in YC was quite eye opening, as
we learned so much about the industry, and how to move forward. We spent those 3 months really
diving into what we want to build and deliver, and after much trial and error, and many failed
prototypes, we chose to move forward with launching <a href="https://moonrepo.dev/proto">proto</a> as its own tool, improving
<a href="https://moonrepo.dev/moon">moon</a>, and slowing down development of <a href="https://moonrepo.dev/moonbase">moonbase</a> (outside of remote caching).</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="moon">moon<a class="hash-link" aria-label="Direct link to moon" title="Direct link to moon" href="https://moonrepo.dev/blog/2024-roadmap#moon">​</a></h3>
<p>For <a href="https://moonrepo.dev/moon">moon</a>, we officially launched v1 back in March, and celebrated its 2 year birthday in
October. Over the course of 2023, we released 23 minor versions, jam packed with new features such
as:</p>
<ul>
<li>Action and project graphs improvements</li>
<li>Bun tier 1, 2, and 3 support</li>
<li>Canary &amp; nightly releases</li>
<li>Code ownership (<code>CODEOWNERS</code>)</li>
<li>Configuration rewrite (using our <a href="https://github.com/moonrepo/schematic" target="_blank" rel="noopener noreferrer">schematic</a> crate)</li>
<li>Deno tier 1 and 2 support</li>
<li>Developer experience improvements</li>
<li>Documentation polish</li>
<li>Experiments</li>
<li>Interactive &amp; persistent tasks</li>
<li>JavaScript and TypeScript improvements</li>
<li>Onboarding flow improvements</li>
<li><code>PATH</code> based task execution</li>
<li><a href="https://moonrepo.dev/proto">proto</a> integration</li>
<li>Query language</li>
<li><a href="https://railway.app/" target="_blank" rel="noopener noreferrer">Railway</a> support</li>
<li>Rust tier 1, 2, and 3 support</li>
<li>Tagging and boundaries/contraints</li>
<li>Task extending, inheritance, and configuration enhancements</li>
<li>Task dependencies configurations</li>
<li>Toolchain enhancements</li>
<li>VCS (Git) hooks</li>
<li>... and much much more!</li>
</ul>
<p>However, when looking at our <a href="https://moonrepo.dev/blog/2023-roadmap">2023 roadmap</a>, there are a few items we failed to
deliver on. The biggest are additional languages, better tier support, and release workflows. We
ultimately didn't land these features as we plan to move to a plugin based architecture, and didn't
want to invest too much time into the current implementation.</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="moonbase">moonbase<a class="hash-link" aria-label="Direct link to moonbase" title="Direct link to moonbase" href="https://moonrepo.dev/blog/2024-roadmap#moonbase">​</a></h3>
<p>During YC, we officially launched <a href="https://moonrepo.dev/moonbase">moonbase</a>, our cloud service that offers remote caching
to all moon users (and also includes a free tier). Over the next few months, we continued to improve
the service, by adding basic insights into CI runs (powered by <a href="https://moonrepo.dev/docs/commands/ci"><code>moon ci</code></a>), and
overall stability.</p>
<p>However, we unfortunately made the decision to pause development of new features for moonbase, as we
were unsure of the value that they would provide to end-users compared to the cost it would take to
build &amp; maintain. Some such features include code and project ownership, project registry, and
repository health scores. We may revisit this in the future.</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="proto">proto<a class="hash-link" aria-label="Direct link to proto" title="Direct link to proto" href="https://moonrepo.dev/blog/2024-roadmap#proto">​</a></h3>
<p>As for <a href="https://moonrepo.dev/proto">proto</a>, it's been an exciting year. For context, proto's implementation was
originally built into moon directly, and powered
<a href="https://moonrepo.dev/docs/concepts/toolchain">moon's integrated toolchain</a>. We strongly felt this functionality can be
useful as a stand-alone tool, as tool installation and developer environment setup is still a major
pain point for developers.</p>
<p>So we decided to extract it out into its own tool, and thus proto was born. Since then, we've
released 27 minor versions with:</p>
<ul>
<li>Additional language support: Go, Python</li>
<li>Binary symlinking</li>
<li>Canary &amp; nightly releases</li>
<li>Detection improvements</li>
<li>Directory-level configuration</li>
<li>Deeper shell integration</li>
<li>Global packages support</li>
<li>Native shim executables</li>
<li>Runtime version detection</li>
<li>WASM and TOML based plugins</li>
<li>... and more to come!</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="launching-moon-v2">Launching moon v2<a class="hash-link" aria-label="Direct link to Launching moon v2" title="Direct link to Launching moon v2" href="https://moonrepo.dev/blog/2024-roadmap#launching-moon-v2">​</a></h2>
<p>It's been almost a year since we launched v1, and we believe we're ready to start planning out and
working on v2. Our goal for major releases is to introduce breaking changes in the most seamless way
possible, and to do so, we plan to incrementally land internal changes in v1 in preparation for v2,
provide codemods for migrating configuration, and of course, provide an in-depth migration guide.</p>
<p>In order of importance, we plan to land the following changes. This list does not include features
that will <a href="https://moonrepo.dev/blog/2024-roadmap#post-launch-features">land after v2</a>.</p>
<ul>
<li>Move to a <a href="https://moonrepo.dev/blog/2024-roadmap#plugin-based-architecture">plugin based architecture</a></li>
<li>Rename and standardize some configuration settings</li>
<li>Removed deprecated features</li>
</ul>
<p>It's a short list but also a ton of work. We have no ETA on when this will land exactly.</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="plugin-based-architecture">Plugin based architecture<a class="hash-link" aria-label="Direct link to Plugin based architecture" title="Direct link to Plugin based architecture" href="https://moonrepo.dev/blog/2024-roadmap#plugin-based-architecture">​</a></h3>
<p>The biggest change and primary focus for v2 is to move to a WASM plugin based architecture (for
language integration). Based on our work with <a href="https://moonrepo.dev/docs/proto/plugins">proto's plugins</a>, we have a very
good idea of how we would model this for moon, and a new love for WASM based plugins (powered by
<a href="https://extism.org/" target="_blank" rel="noopener noreferrer">Extism</a>).</p>
<p>One of the leading factors for this decision, is that building everything into Rust directly is not
scalable, is a maintenance headache, and is also extremely difficult. It results in a lot of
duplicated code, increased compilation times, and a lot of complexity. By moving to plugins, we can
ditch most of this, and in the grand scheme of things, plugin integration is simply function calls.</p>
<p>Of course there are a handful of additional benefits that come from plugins:</p>
<ul>
<li>Enables the community to build and share their own plugins (additional languages).</li>
<li>Plugins can be individually updated, versioned, and released. Less moon patches.</li>
<li>Reduces moon's compilation times, as plugins live in their own repositories.</li>
<li>Easier to contribute to, as moon's codebase is quite complex.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="post-launch-features">Post-launch features<a class="hash-link" aria-label="Direct link to Post-launch features" title="Direct link to Post-launch features" href="https://moonrepo.dev/blog/2024-roadmap#post-launch-features">​</a></h3>
<p>Curious what kind of features we have planned for after v2? Of course you are! This isn't an
exhaustive or detailed list, but is top of mind:</p>
<ul>
<li>Additional languages support (will be much easier with a plugin system)</li>
<li>Release workflows (versioning, publishing, changelogs, etc)</li>
<li>System dependencies within the toolchain</li>
<li>Language dependency management tools</li>
<li>Repository and project health scores</li>
<li>Improved action graph and pipeline</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="launching-proto-v1">Launching proto v1<a class="hash-link" aria-label="Direct link to Launching proto v1" title="Direct link to Launching proto v1" href="https://moonrepo.dev/blog/2024-roadmap#launching-proto-v1">​</a></h2>
<p>We're extremely close to a v1 release, most definitely in Q1. For the most part, we believe we're
passed the point of introducing breaking changes, and so the remainder of the time will be spent on
polish, improvements, and documentation. There are a few big features we want to land relatively
soon though (but maybe after v1), and they are:</p>
<ul>
<li>Build from source for languages (this is quite complicated)</li>
<li>Build/extension variants for languages (PyPy for Python, PHP extensions, etc)</li>
<li>Directory and tool level environment variables (think <a href="https://direnv.net/" target="_blank" rel="noopener noreferrer">direnv</a> kind of
functionality)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="expanding-language-support">Expanding language support<a class="hash-link" aria-label="Direct link to Expanding language support" title="Direct link to Expanding language support" href="https://moonrepo.dev/blog/2024-roadmap#expanding-language-support">​</a></h3>
<p>While not part of v1, we definitely want to support more official languages in proto. We've been
pushing back on new languages until after v1 and the plugin APIs have stabilized, but since that's
relatively close to being done, expect more in the future! Our top of mind languages at the moment
are: Ruby (and Crystal), PHP, and Java.</p>
<p>Don't forget that the community can also build and share their own plugins! For example, the
<a href="https://github.com/konomae/zig-plugin" target="_blank" rel="noopener noreferrer">Zig programming language</a> already exists, and is provided by
<a href="https://github.com/konomae" target="_blank" rel="noopener noreferrer">konomae</a>! Thanks for the amazing work.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="self-hosting-moonbase">Self-hosting moonbase<a class="hash-link" aria-label="Direct link to Self-hosting moonbase" title="Direct link to Self-hosting moonbase" href="https://moonrepo.dev/blog/2024-roadmap#self-hosting-moonbase">​</a></h2>
<p>And last but not least, let's talk about moonbase. Although we've paused development on new
features, we consistently get requests for self-hosting moonbase (primarily for remote caching), as
companies don't want to store their proprietary builds, even though they are compiled and minified,
in a cloud storage provider that they do not own.</p>
<p>We definitely understand this concern, and that's why we've been working on a self-hosted version of
moonbase (also known as on-premises). We've never done this before, so it's been quite a learning
lesson, especially since we have many facets to take into account: database access, cloud
credentials, error handling, auth, so on and so forth.</p>
<p>We'd say we're about 50% done with this effort, and we aim to have it ready by the end of Q1. With
that said, the self-hosted version of moonbase will <em>not</em> be free, and will use a license based
model. We're still working out the details, but we'll have more information soon.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="looking-for-contributors">Looking for contributors<a class="hash-link" aria-label="Direct link to Looking for contributors" title="Direct link to Looking for contributors" href="https://moonrepo.dev/blog/2024-roadmap#looking-for-contributors">​</a></h2>
<p>Thanks for reading this far, but we do have one last thing to talk about. The moonrepo ecosystem and
all its products are quite large, with a lot of complexity. However, we're a small team, with most
of the public-facing work being done by me (Miles), but there's only so much we can do in a given
timeframe. With that said, we're looking for open source contributors that would like to help us
out! We have a long list of features and enhancements that need to be done, and even some secret
projects that would be very cool to work on. If you're interested, please reach out to us on
Discord!</p>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="roadmap" term="roadmap"/>
        <category label="moonbase" term="moonbase"/>
        <category label="proto" term="proto"/>
        <category label="toolchain" term="toolchain"/>
    </entry>
</feed>