<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>moonrepo Blog</title>
        <link>https://moonrepo.dev/blog</link>
        <description>moonrepo Blog</description>
        <lastBuildDate>Mon, 27 May 2024 00:00:00 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[moon v1.25 - New task runner and console reporter]]></title>
            <link>https://moonrepo.dev/blog/moon-v1.25</link>
            <guid>https://moonrepo.dev/blog/moon-v1.25</guid>
            <pubDate>Mon, 27 May 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[In this release, we focused primarily on rewriting our task runner, and improving our console.]]></description>
            <content:encoded><![CDATA[<p>In this release, we focused primarily on rewriting our task runner, and improving our console.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-task-runner-implementation">New task runner implementation<a href="https://moonrepo.dev/blog/moon-v1.25#new-task-runner-implementation" class="hash-link" aria-label="Direct link to New task runner implementation" title="Direct link to New task runner implementation">​</a></h2>
<p>It's been over a month since our last release, but we've been really busy rewriting our task runner
from the ground up! In other build systems, a task runner is typically the orchestator that runs
multiple tasks and manages their state. In moon this is known as the action pipeline (or just
pipeline), and a task runner is simply the execution of a single task. However, executing a single
task is quite involved, as we need to generate a unique hash, check the cache, hydrate outputs if a
cache hit, actually execute the task as a child process, and much more!</p>
<p>Task running is some of the oldest code in moon, as it was part of the initial MVP. Because of this,
it hasn't changed much, but moon has grown quite large and it was time to revisit it with better
design patterns and practices. Furthermore, since the task runner is so critical to moon itself, we
wanted to ensure it worked correctly, and spent more time than usual implementing, testing it, and
verifying edge cases.</p>
<p>With this new task runner, we...</p>
<ul>
<li>Improved handling and reliability of output archiving (cache miss) and hydration (cache hit).</li>
<li>Streamlined the task execution (child process) flow.</li>
<li>Increased performance by optimizing or removing certain code paths.</li>
</ul>
<blockquote>
<p>If you're interested in how the task runner was implemented, feel free to take a look at the
<a href="https://github.com/moonrepo/moon/tree/master/crates/task-runner" target="_blank" rel="noopener noreferrer">Rust crate</a>, and the
<a href="https://github.com/moonrepo/moon/pull/1463" target="_blank" rel="noopener noreferrer">pull request</a> itself.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="fine-grained-operations">Fine-grained operations<a href="https://moonrepo.dev/blog/moon-v1.25#fine-grained-operations" class="hash-link" aria-label="Direct link to Fine-grained operations" title="Direct link to Fine-grained operations">​</a></h3>
<p>A major goal of moon is bubbling up information to the user that is applicable to the current
workflow, but what about when that workflow must be debugged or optimized? At that point, it was
almost impossible without digging into the source code.</p>
<p>To make a step in this direction, as part of the new task runner we now track timing information for
individual parts of the run execution, and we're calling these parts operations. An operation is
anything from generating a hash, creating a tarball archive, unpacking the archive (cache
hydration), task execution (the child process), and more.</p>
<p>This timing information is useful in figuring out why a certain task is slower than expected, and
which operation is actually causing the slowness. It also helps to uncover which operations were
actually ran for an action, which were skipped, so on and so forth. At this point in time, the
operations information is only included in the run report, located at <code>.moon/cache/runReport.json</code>.
In the future, we plan to display this information in a nice UI.</p>
<p>For an example of this in action, here's a list of all operations that were executed when running
the <code>build</code> task for our website.</p>
<div class="language-json codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-json codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token punctuation" style="color:#cad4e2">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"duration"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"secs"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">0</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"nanos"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">609156875</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"finishedAt"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"2024-05-27T00:14:54.286628"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"meta"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"type"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"hash-generation"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"hash"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"10606e37c5e6ab4008007b30275f1682bae32dca71650ce173eb386d5b6c3309"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"startedAt"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"2024-05-27T00:14:53.677526"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"status"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"passed"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"duration"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"secs"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">0</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"nanos"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">32834</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"finishedAt"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"2024-05-27T00:14:54.286667"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"meta"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"type"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"output-hydration"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"startedAt"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"2024-05-27T00:14:54.286634"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"status"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"skipped"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"duration"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"secs"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">15</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"nanos"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">789003125</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"finishedAt"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"2024-05-27T00:15:10.075113"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"meta"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"type"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"task-execution"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"command"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"docusaurus build"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"exitCode"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"startedAt"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"2024-05-27T00:14:54.286950"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"status"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"passed"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"duration"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"secs"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">17</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"nanos"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">214634292</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"finishedAt"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"2024-05-27T00:15:27.289995"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"meta"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"type"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"archive-creation"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"startedAt"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"2024-05-27T00:15:10.075686"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"status"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"passed"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">]</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Because of these new operations, we can clearly see above that the archive creation process is
taking 17 seconds, which is 2 seconds longer than the build itself! Without this information, we
would have never known that the archive was taking this long, but now we do, and we can optimize it
in a future release!</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="run-summaries">Run summaries<a href="https://moonrepo.dev/blog/moon-v1.25#run-summaries" class="hash-link" aria-label="Direct link to Run summaries" title="Direct link to Run summaries">​</a></h3>
<p>Because of the new task runner and the new console (<a href="https://moonrepo.dev/blog/moon-v1.25#new-console-reporting-layer">below</a>), we have
the ability to bubble up more information than before. Based on requests from the community, we've
taken the output from <a href="https://moonrepo.dev/docs/commands/ci"><code>moon ci</code></a> and applied it to both
<a href="https://moonrepo.dev/docs/commands/check"><code>moon check</code></a> and <a href="https://moonrepo.dev/docs/commands/run"><code>moon run</code></a> behind the <code>--summary</code>
flag.</p>
<p>When this flag is passed, we will now summarize all actions that have ran in the pipeline (not just
task related ones), and include failed tasks for review. For example, here's the output of
<code>moon check website --summary</code> on moon's repository.</p>
<div class="codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-text codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ moon check website --summary</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">▪▪▪▪ types:build (cached, 1ms, 21bd9add)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">▪▪▪▪ runtime:build (cached, e8363e65)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">▪▪▪▪ website:typecheck (cached, 0ab91eaa)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">▪▪▪▪ website:format (cached, 07ae2388)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">▪▪▪▪ website:test (cached, 11d33e2e)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">▪▪▪▪ website:lint (cached, 2197fbb1)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">▪▪▪▪ website:build (10606e37)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">▪▪▪▪ website:build (15s 789ms, 10606e37)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">SUMMARY</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">pass SyncWorkspace</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">skip SetupNodeTool(20.13.1) (skipped, 250ms)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">skip InstallNodeDeps(20.13.1) (skipped, 13ms, f341872f)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">pass SyncNodeProject(types) (1ms)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">pass SyncNodeProject(runtime) (1ms)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">pass RunTask(types:build) (cached, 140ms, 21bd9add)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">pass SyncNodeProject(website) (1ms)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">pass RunTask(runtime:build) (cached, 32ms, e8363e65)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">pass RunTask(website:build) (33s 614ms, 10606e37)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">pass RunTask(website:format) (cached, 59ms, 07ae2388)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">pass RunTask(website:lint) (cached, 101ms, 2197fbb1)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">pass RunTask(website:test) (cached, 64ms, 11d33e2e)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">pass RunTask(website:typecheck) (cached, 59ms, 0ab91eaa)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">STATS</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">Actions: 11 completed (6 cached), 2 skipped</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">   Time: 34s 52ms</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-console-reporting-layer">New console reporting layer<a href="https://moonrepo.dev/blog/moon-v1.25#new-console-reporting-layer" class="hash-link" aria-label="Direct link to New console reporting layer" title="Direct link to New console reporting layer">​</a></h2>
<p>For the most part, when something in moon needed to be printed to the console, we would simply print
it directly at that point in time, anywhere within the codebase. While this worked, it made it
difficult to orchestrate output from different parts of the codebase, and in the context of Rust,
each call to stdout/stderr <a href="https://nnethercote.github.io/perf-book/io.html" target="_blank" rel="noopener noreferrer">locks the I/O stream</a>,
resulting in performance loss.</p>
<p>To work around this, in <a href="https://moonrepo.dev/blog/moon-v1.21">v1.21</a> we implemented a new
<a href="https://github.com/moonrepo/moon/tree/master/crates/console" target="_blank" rel="noopener noreferrer">console layer</a> that buffers all stdio
writes, and prints them on 100ms intervals. This avoids locking on every call, and instead batches
them. To expand on this further, in this release we've implemented a new
<a href="https://github.com/moonrepo/moon/tree/master/crates/console-reporter" target="_blank" rel="noopener noreferrer">reporter layer</a>, with a
well-defined interface that is used to print checkpoints (the 4 squares), and status updates from
the action pipeline (and the new task runner).</p>
<p>This reporter layer enables new console UI implementations in the future based on your preferences.
For example, an <a href="https://ratatui.rs/" target="_blank" rel="noopener noreferrer">interactive UI</a> composed of tables, tabs, and more,
representing the current state of the pipeline.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/moon-v1.25#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.25.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Greatly reduced the amount of concurrent locks being held during task execution. May see slight
performance improvements.</li>
<li>Updated external configuration files (via https extends) to be cached for 24 hours.</li>
<li>Updated macOS binaries to be built on macos-12 instead of macos-11.</li>
<li>Updated proto to v0.35.4 (from v0.34.4).</li>
</ul>]]></content:encoded>
            <category>task</category>
            <category>runner</category>
            <category>console</category>
            <category>reporter</category>
            <category>operation</category>
        </item>
        <item>
            <title><![CDATA[moon v1.24 - Task mutexes, auto-detect revisions, project dependents, and more!]]></title>
            <link>https://moonrepo.dev/blog/moon-v1.24</link>
            <guid>https://moonrepo.dev/blog/moon-v1.24</guid>
            <pubDate>Wed, 17 Apr 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[This is a light release that focused solely on requests and improvements from the community.]]></description>
            <content:encoded><![CDATA[<p>This is a light release that focused solely on requests and improvements from the community.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="exclusive-resources-with-task-mutexes">Exclusive resources with task mutexes<a href="https://moonrepo.dev/blog/moon-v1.24#exclusive-resources-with-task-mutexes" class="hash-link" aria-label="Direct link to Exclusive resources with task mutexes" title="Direct link to Exclusive resources with task mutexes">​</a></h2>
<p>Some tasks may require exclusive access to a resource, like a database, file, or network connection,
but other parallel running tasks may also require access to the same resource. When both of these
tasks run, they may conflict with each other, causing one or both to fail. This wasn't an easy
problem to solve in moon, until now!</p>
<p>Thanks to <a href="https://github.com/castarco" target="_blank" rel="noopener noreferrer">Andrés Correa Casablanca</a> for the idea and implementation,
tasks now support a new option called <a href="https://moonrepo.dev/docs/config/project#mutex"><code>mutex</code></a>. This option allows you
to specify a unique name (across the entire workspace) for the mutex, which will be used to lock the
task from running if another task with the same mutex name is already running.</p>
<p>Take the following for example:</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token comment" style="color:#97a1af;font-style:italic"># server/moon.yml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'build-server'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">mutex</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'app'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># client/moon.yml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'build-client'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">mutex</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'app'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When <a href="https://moonrepo.dev/docs/commands/run"><code>moon run :build</code></a> or <a href="https://moonrepo.dev/docs/commands/ci"><code>moon ci</code></a> is ran, both tasks
will be parallelized within our pipeline, <em>but</em> only one of them will run at a time. If the <code>server</code>
task is running, the <code>client</code> task will wait until the <code>server</code> task is complete. This ensures that
both tasks don't conflict with each other.</p>
<p>This could technically be solved through task <code>deps</code>, but with a mutex, it allows you to decouple
project and task dependencies, and instead focus on a virtual resource that is being locked.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="auto-detect-basehead-for-moon-ci">Auto-detect base/head for <code>moon ci</code><a href="https://moonrepo.dev/blog/moon-v1.24#auto-detect-basehead-for-moon-ci" class="hash-link" aria-label="Direct link to auto-detect-basehead-for-moon-ci" title="Direct link to auto-detect-basehead-for-moon-ci">​</a></h2>
<p>We've updated <a href="https://moonrepo.dev/docs/commands/ci"><code>moon ci</code></a> to try and detect the base and head revisions
automatically when running in a popular CI provider, like GitLab and Jenkins. For the base revision,
we'll use the base/target commit SHA or target branch, while the head revision will use the source
commit SHA or <code>HEAD</code>. This is great for pull requests and forks!</p>
<p>With that said, these values can be overwritten with environment variables, or command line
arguments. Below is the order of precedence:</p>
<ul>
<li><code>MOON_BASE</code> / <code>MOON_HEAD</code> environment variables</li>
<li><code>--base</code> / <code>--head</code> command line arguments</li>
<li><code>base_revision</code> / <code>head_revision</code> via CI provider</li>
<li><code>vcs.defaultBranch</code> setting / <code>HEAD</code> literal value</li>
</ul>
<blockquote>
<p>This functionality is provided by the <a href="https://github.com/milesj/rust-cicd-env" target="_blank" rel="noopener noreferrer"><code>ci_env</code></a> Rust
crate. Please refer to that crate for supported providers, and which of them support revision
detection (primarily the <code>base_revision</code> and <code>head_revision</code> fields).</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="include-dependents-for-focused-project-graph">Include dependents for focused project graph<a href="https://moonrepo.dev/blog/moon-v1.24#include-dependents-for-focused-project-graph" class="hash-link" aria-label="Direct link to Include dependents for focused project graph" title="Direct link to Include dependents for focused project graph">​</a></h2>
<p>When running <a href="https://moonrepo.dev/docs/commands/project-graph"><code>moon project-graph &lt;id&gt;</code></a>, we visualize a graph of the
focused project and all of its dependencies (other projects it depends on). However, if you wanted
to also visualize dependents (other projects that depend on the focused project), this was currently
not possible.</p>
<p>We felt this information could be useful, so we've added a <code>--dependents</code>
flattenDiagnosticMessageText, which will include direct dependents in the graph.</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ moon project-graph server </span><span class="token parameter variable" style="color:#fef9c3">--dependents</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We also felt dependent information can be useful when querying projects, so have also added support
for the <code>--dependents</code> flag to the <a href="https://moonrepo.dev/docs/commands/query/projects"><code>moon query projects</code></a> command.</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ moon query projects </span><span class="token parameter variable" style="color:#fef9c3">--affected</span><span class="token plain"> </span><span class="token parameter variable" style="color:#fef9c3">--dependents</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/moon-v1.24#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.24.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added an experimental <code>moon templates</code> command, that lists all available codegen templates.</li>
<li>Added a <code>runner.autoCleanCache</code> setting to <code>.moon/workspace.yml</code>, allowing the post-run clean
mechanism to be controlled.</li>
<li>Updated <code>moon generate</code> with better argument to variable handling.</li>
<li>Updated action graph and project graph visualization to be more readable.</li>
<li>Updated root-level tasks to have no inputs by default, instead of <code>**/*</code>.</li>
</ul>]]></content:encoded>
            <category>task</category>
            <category>mutex</category>
            <category>ci</category>
            <category>base</category>
            <category>head</category>
            <category>project-graph</category>
            <category>dependents</category>
            <category>cache</category>
            <category>clean</category>
        </item>
        <item>
            <title><![CDATA[proto v0.34 - New detection strategy, status command, and outdated improvements]]></title>
            <link>https://moonrepo.dev/blog/proto-v0.34</link>
            <guid>https://moonrepo.dev/blog/proto-v0.34</guid>
            <pubDate>Sun, 07 Apr 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[In this release, we've focused on the developer experience for common workflows.]]></description>
            <content:encoded><![CDATA[<p>In this release, we've focused on the developer experience for common workflows.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-only-prototools-detection-strategy">New <code>only-prototools</code> detection strategy<a href="https://moonrepo.dev/blog/proto-v0.34#new-only-prototools-detection-strategy" class="hash-link" aria-label="Direct link to new-only-prototools-detection-strategy" title="Direct link to new-only-prototools-detection-strategy">​</a></h2>
<p>proto currently detects versions at runtime using
<a href="https://moonrepo.dev/docs/proto/config#detect-strategy">1 of 2 strategies</a>, <code>first-available</code> which checks
<code>.prototools</code> files and tool-specific files (like <code>package.json</code> engines), whichever is first, or
<code>prefer-prototools</code> which works like the previous strategy, but prefers <code>.prototools</code> (even in a
parent directory).</p>
<p>In this release, we're adding a 3rd strategy called <code>only-prototools</code>. This strategy will only check
<code>.prototools</code> files and will not check tool-specific files. This is useful if you want explicit
versions, and to avoid unexpected versions from random configs/directories.</p>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.prototools</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">settings</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">detect-strategy</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"only-prototools"</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>For the v1 release, we plan to make this strategy the new default.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-proto-status-command">New <code>proto status</code> command<a href="https://moonrepo.dev/blog/proto-v0.34#new-proto-status-command" class="hash-link" aria-label="Direct link to new-proto-status-command" title="Direct link to new-proto-status-command">​</a></h2>
<p>Sometimes you simply want to know what tools are currently active for a target directory, what
versions those tools are resolved to, and the configuration file in which they are defined. To
satisfy this requirement, we've added a new <a href="https://moonrepo.dev/docs/proto/commands/status"><code>proto status</code></a> command,
which outputs something like the following:</p>
<div class="codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-text codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ proto status</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">Tool  Configured  Resolved  Installed                   Config</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">deno  1.40.0      1.40.0    ~/.proto/tools/deno/1.40.0  ~/.prototools</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">node  20.8.0      20.8.0    ~/.proto/tools/node/20.8.0  ~/.prototools</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">npm   10.1.0      10.1.0    ~/.proto/tools/npm/10.1.0   ~/.prototools</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>By default this includes tools from all <code>.prototools</code> files up the hierarchy, excluding
<code>~/.proto/.prototools</code>. To include global tools as well, pass <code>--include-global</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="improved-proto-outdated-experience">Improved <code>proto outdated</code> experience<a href="https://moonrepo.dev/blog/proto-v0.34#improved-proto-outdated-experience" class="hash-link" aria-label="Direct link to improved-proto-outdated-experience" title="Direct link to improved-proto-outdated-experience">​</a></h2>
<p>The <a href="https://moonrepo.dev/docs/proto/commands/outdated"><code>proto outdated</code></a> command has worked "alright" but its developer
experience wasn't the best. The terminal output was rudimentary, and writing updated versions to
<code>.prototools</code> would save to the current directory, instead of the directory they are configured in.</p>
<p>To improve the overall developer experience, we've made the following changes to this command:</p>
<ul>
<li>Displays all tools and available updates as a table of data.</li>
<li>Includes both newest (matching range) and latest versions available.</li>
<li>Includes the config file that the tool + version was loaded from.</li>
<li>When <code>--update</code> is passed, will now prompt to confirm the update.</li>
<li>When updating versions, versions are now written to their original config file, instead of local.</li>
<li>Updated the <code>--latest</code> flag to use the latest version when updating, instead of newest.</li>
</ul>
<div class="codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-text codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ proto outdated</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">Tool  Current  Newest   Latest  Config</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">deno  1.40.0   1.42.4   1.42.4  ~/.prototools</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">node  20.8.0   20.12.2  21.7.3  ~/.prototools</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">npm   10.1.0   10.5.2   10.5.2  ~/.prototools</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="what-about-v032-and-v033">What about v0.32 and v0.33?<a href="https://moonrepo.dev/blog/proto-v0.34#what-about-v032-and-v033" class="hash-link" aria-label="Direct link to What about v0.32 and v0.33?" title="Direct link to What about v0.32 and v0.33?">​</a></h2>
<p>You may have noticed that we don't have blog posts for either of these versions. The v0.32 release
was a relatively light release with no meaningful changes, so we opted to not write a blog post for
it. As for v0.33, we ran into build issues while releasing it, so we decided to skip it and move on
to v0.34.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/proto-v0.34#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/proto/releases/tag/v0.34.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added a <code>dist-url</code> setting to some plugins, allowing the distribution download URL to be
customized.</li>
<li>Updated <code>proto setup</code> (which is ran during proto installation) to modify the <code>PATH</code> system
environment variable on Windows. To disable this functionality, pass <code>--no-modify-path</code>.</li>
</ul>]]></content:encoded>
            <category>detection</category>
            <category>status</category>
            <category>outdated</category>
        </item>
        <item>
            <title><![CDATA[moon v1.23 - Codegen improvements, stack inheritance, internal tasks, and more]]></title>
            <link>https://moonrepo.dev/blog/moon-v1.23</link>
            <guid>https://moonrepo.dev/blog/moon-v1.23</guid>
            <pubDate>Mon, 25 Mar 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[It's been a month since our last release, and we're excited to land major codegen and task]]></description>
            <content:encoded><![CDATA[<p>It's been a month since our last release, and we're excited to land major codegen and task
improvements.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="template--generator-improvements">Template &amp; generator improvements<a href="https://moonrepo.dev/blog/moon-v1.23#template--generator-improvements" class="hash-link" aria-label="Direct link to Template &amp; generator improvements" title="Direct link to Template &amp; generator improvements">​</a></h2>
<p>Based on feedback and requests from community, we've made quite a few improvements to our code
generation workflow!</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="git-and-npm-template-locators">Git and npm template locators<a href="https://moonrepo.dev/blog/moon-v1.23#git-and-npm-template-locators" class="hash-link" aria-label="Direct link to Git and npm template locators" title="Direct link to Git and npm template locators">​</a></h3>
<p>Our <a href="https://moonrepo.dev/docs/config/workspace#templates"><code>generator.templates</code></a> setting has only supported file system
paths, relative from the workspace root. This has made it quite difficult to share templates across
repositories, but no longer!</p>
<p>Template locations now support Git repositories and npm packages, through the <code>git:</code> and <code>npm:</code>
prefixes respectively. The <code>git:</code> locator requires a Git repository URL and explicit revision
(branch, commit, etc), while the <code>npm:</code> locator requires a package name and explicit version. For
example:</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">moon.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">generator</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">templates</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'git:github.com/moonrepo/templates#master'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'npm:@moonrepo/templates#1.2.3'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>Learn more about this in the official
<a href="https://moonrepo.dev/docs/guides/codegen#configuring-template-locations">code generation guide</a>!</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="custom-template-names">Custom template names<a href="https://moonrepo.dev/blog/moon-v1.23#custom-template-names" class="hash-link" aria-label="Direct link to Custom template names" title="Direct link to Custom template names">​</a></h3>
<p>Historically, a template's name was derived from the directory the
<a href="https://moonrepo.dev/docs/config/template"><code>template.yml</code></a> file was located in. While this works great for small repos,
it falls apart for large monorepos when there's multiple teams defining templates, as the chance of
name collisions arise.</p>
<p>To combat this problem, we're introducing a new <a href="https://moonrepo.dev/docs/config/template#id"><code>id</code> setting</a> for
templates, which allows you to customize the exact name of the template. This setting is optional,
and if not provided, the name will be derived from the directory as before.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">template.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">id</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'my-template'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="new-variable-settings">New variable settings<a href="https://moonrepo.dev/blog/moon-v1.23#new-variable-settings" class="hash-link" aria-label="Direct link to New variable settings" title="Direct link to New variable settings">​</a></h3>
<p>And lastly, we're introducing some additions and improvements to template
<a href="https://moonrepo.dev/docs/config/template#variables"><code>variables</code></a>.</p>
<ul>
<li>A new <code>order</code> setting, which defines the order in which variables are prompted to the user.</li>
<li>A new <code>internal</code> setting, which avoids the value being set from the CLI.</li>
<li>Enum <code>default</code> values now support a list of values (cannot be provided by the CLI yet).</li>
<li>Enum <code>prompt</code>s are now optional, and will fallback to the default value if not provided.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="stack-based-task-inheritance">Stack-based task inheritance<a href="https://moonrepo.dev/blog/moon-v1.23#stack-based-task-inheritance" class="hash-link" aria-label="Direct link to Stack-based task inheritance" title="Direct link to Stack-based task inheritance">​</a></h2>
<p>Last month in <a href="https://moonrepo.dev/blog/moon-v1.22">moon v1.22</a>, we introduced the <a href="https://moonrepo.dev/docs/config/project#stack"><code>stack</code></a>
setting for organizing projects into what tech stack they belong to. This is primarily for
organizational purposes, and improving our project constaints implementation.</p>
<p>Based on community feeedback, we've expanded the <code>stack</code> setting to also apply for
<a href="http://localhost:3000/docs/concepts/task-inheritance#scope-by-project-metadata" target="_blank" rel="noopener noreferrer">task inheritance</a>.
You can now inherit tasks for the stack itself, or through a combination of the project language,
platform, and type. For example:</p>
<ul>
<li><code>.moon/tasks/backend.yml</code></li>
<li><code>.moon/tasks/javascript-backend.yml</code></li>
<li><code>.moon/tasks/frontend-library.yml</code></li>
<li><code>.moon/tasks/bun-frontend-application.yml</code></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="internal-tasks">Internal tasks<a href="https://moonrepo.dev/blog/moon-v1.23#internal-tasks" class="hash-link" aria-label="Direct link to Internal tasks" title="Direct link to Internal tasks">​</a></h2>
<p>We're introducing a new <a href="https://moonrepo.dev/docs/concepts/task#modes">task mode</a> called internal, which can be enabled
with the <a href="https://moonrepo.dev/docs/config/project#internal"><code>internal</code></a> task option. Internal tasks are tasks that are
not meant to be ran explicitly by the user (via <a href="https://moonrepo.dev/docs/commands/check"><code>moon check</code></a> or
<a href="https://moonrepo.dev/docs/commands/run"><code>moon run</code></a>), but are used internally as dependencies of other tasks.</p>
<p>This functionality provides another way to organize your tasks.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">moon.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">prepare</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'intermediate-step'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">internal</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">true</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/moon-v1.23#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.23.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added a <code>variables()</code> function for templates that returns an object of all variables available.</li>
<li>Updated <code>moon project</code> and <code>moon task</code> to include the configuration files that tasks inherit from.</li>
<li>Updated <code>moon task</code> to include the modes it belongs to.</li>
</ul>]]></content:encoded>
            <category>tasks</category>
            <category>codegen</category>
            <category>template</category>
            <category>tack</category>
            <category>inheritance</category>
        </item>
        <item>
            <title><![CDATA[proto v0.31 - Improved version pinning, removed global packages management, and more]]></title>
            <link>https://moonrepo.dev/blog/proto-v0.31</link>
            <guid>https://moonrepo.dev/blog/proto-v0.31</guid>
            <pubDate>Fri, 01 Mar 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[In preparation for an official v1 release, we've improved stability, the overall developer]]></description>
            <content:encoded><![CDATA[<p>In preparation for an official v1 release, we've improved stability, the overall developer
experience, we're renaming some commands, and removing the "global packages" functionality.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="improved-version-pinning">Improved version pinning<a href="https://moonrepo.dev/blog/proto-v0.31#improved-version-pinning" class="hash-link" aria-label="Direct link to Improved version pinning" title="Direct link to Improved version pinning">​</a></h2>
<p>Based on feedback from the community, we've made some slight changes to pinning to reduce confusion.
The biggest points of contention were, "Why does <code>proto install --pin</code> pin globally?", and "Why
doesn't <code>proto pin</code> resolve the version like <code>proto install --pin</code> does?".</p>
<p>To remedy the first issue, we've updated the <code>--pin</code> argument to optionally support a string value
of "local" or "global". When local, will pin to the <code>.prototools</code> file in the current directory,
otherwise it will pin to <code>~/.proto/.prototools</code>.</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ proto </span><span class="token function" style="color:#ff94ff;font-weight:bold">install</span><span class="token plain"> </span><span class="token function" style="color:#ff94ff;font-weight:bold">node</span><span class="token plain"> </span><span class="token parameter variable" style="color:#fef9c3">--pin</span><span class="token plain"> </span><span class="token comment" style="color:#97a1af;font-style:italic"># global</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ proto </span><span class="token function" style="color:#ff94ff;font-weight:bold">install</span><span class="token plain"> </span><span class="token function" style="color:#ff94ff;font-weight:bold">node</span><span class="token plain"> </span><span class="token parameter variable" style="color:#fef9c3">--pin</span><span class="token plain"> global</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ proto </span><span class="token function" style="color:#ff94ff;font-weight:bold">install</span><span class="token plain"> </span><span class="token function" style="color:#ff94ff;font-weight:bold">node</span><span class="token plain"> </span><span class="token parameter variable" style="color:#fef9c3">--pin</span><span class="token plain"> </span><span class="token builtin class-name" style="color:#ff94ff;font-weight:bold">local</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As for the second issue, we've introduced a new option called <code>--resolve</code>, which will resolve the
version to a fully qualified semantic version (or fail). This isn't the default functionality, as to
not break existing workflows, and because you may want to actually pin "1" instead of "1.2.3".</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ proto pin </span><span class="token function" style="color:#ff94ff;font-weight:bold">node</span><span class="token plain"> </span><span class="token number" style="color:#94dded">1</span><span class="token plain"> </span><span class="token comment" style="color:#97a1af;font-style:italic"># 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ proto pin </span><span class="token function" style="color:#ff94ff;font-weight:bold">node</span><span class="token plain"> </span><span class="token number" style="color:#94dded">1</span><span class="token plain"> </span><span class="token parameter variable" style="color:#fef9c3">--resolve</span><span class="token plain"> </span><span class="token comment" style="color:#97a1af;font-style:italic"># 1.2.3</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="removed-global-package-management-breaking">Removed global package management (breaking)<a href="https://moonrepo.dev/blog/proto-v0.31#removed-global-package-management-breaking" class="hash-link" aria-label="Direct link to Removed global package management (breaking)" title="Direct link to Removed global package management (breaking)">​</a></h2>
<p>A while back we introduced the <code>proto install-global</code> and <code>proto uninstall-global</code> commands as a
means for managing global packages. This was added to solve issues with the Node.js ecosystem,
primarily around standardizing where global packages would be installed across all package managers.
On top of this, we also introduced a "command interception" feature, which would error telling you
to use proto's command instead of the package manager's.</p>
<p>As a whole, this feature was <em>very</em> disruptive to users, caused a lot of confusion, was simply
poorly implemented, and honestly wasn't really necessary for tools outside of Node.js. Because of
all of this, we've decided to entirely remove our global package management functionality, this
includes:</p>
<ul>
<li><code>proto install-global</code> command</li>
<li><code>proto uninstall-global</code> command</li>
<li><code>proto list-global</code> command</li>
<li><code>intercept-globals</code> setting for node/npm/pnpm/yarn</li>
<li><code>globals</code> setting for TOML plugins</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-npmpnpmyarn-shared-globals-dir-setting">New npm/pnpm/yarn <code>shared-globals-dir</code> setting<a href="https://moonrepo.dev/blog/proto-v0.31#new-npmpnpmyarn-shared-globals-dir-setting" class="hash-link" aria-label="Direct link to new-npmpnpmyarn-shared-globals-dir-setting" title="Direct link to new-npmpnpmyarn-shared-globals-dir-setting">​</a></h2>
<p>Since we removed our global packages support (above), we had to also remove the <code>intercept-globals</code>
setting from our Node.js related WASM plugins. However, we still believed in the benefit it
provided, primarily around standardizing where global packages would be installed across all package
managers.</p>
<p>To still support this in some capacity, we've introduced a new <code>shared-globals-dir</code> setting for npm,
pnpm, and yarn. This setting still standardizes the install path, <em>but instead</em> of intercepting
commands like it did before, it now appends the global package install commands with additional
arguments or environment variables. This should be entirely transparent to you!</p>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.prototools</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">tools.npm</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">shared-globals-dir</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token boolean" style="color:#94dded">true</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>An example of how this now works:</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token comment" style="color:#97a1af;font-style:italic"># &lt; v0.31</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">proto install-global </span><span class="token function" style="color:#ff94ff;font-weight:bold">npm</span><span class="token plain"> typescript</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># &gt;= v0.31</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token function" style="color:#ff94ff;font-weight:bold">npm</span><span class="token plain"> </span><span class="token function" style="color:#ff94ff;font-weight:bold">install</span><span class="token plain"> </span><span class="token parameter variable" style="color:#fef9c3">--global</span><span class="token plain"> typescript</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Under the hood becomes...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token assign-left variable" style="color:#fef9c3">PREFIX</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token plain">/.proto/tools/node/globals </span><span class="token function" style="color:#ff94ff;font-weight:bold">npm</span><span class="token plain"> </span><span class="token function" style="color:#ff94ff;font-weight:bold">install</span><span class="token plain"> </span><span class="token parameter variable" style="color:#fef9c3">--global</span><span class="token plain"> typescript</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="renamed-commands-breaking">Renamed commands (breaking)<a href="https://moonrepo.dev/blog/proto-v0.31#renamed-commands-breaking" class="hash-link" aria-label="Direct link to Renamed commands (breaking)" title="Direct link to Renamed commands (breaking)">​</a></h2>
<p>We're still not happy with some of the current command names, especially around tools and plugins,
so we've renamed a few of them. They are:</p>
<ul>
<li>Renamed the <code>proto tool</code> commands to <code>proto plugin</code>. An alias still exists for the time being.</li>
<li>Removed the <code>proto tool list-plugins</code> command, and merged its functionality into
<code>proto plugin list</code>.</li>
</ul>
<p>As for the <code>proto plugin list</code> command, we've removed the versions and aliases from the output by
default, and wrapped them in new <code>--versions</code> and <code>--aliases</code> options.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/proto-v0.31#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/proto/releases/tag/v0.31.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Fixed an issue where empty version strings were being parsed, causing failures.</li>
</ul>]]></content:encoded>
            <category>proto</category>
            <category>version</category>
            <category>pin</category>
            <category>global</category>
            <category>packages</category>
        </item>
        <item>
            <title><![CDATA[moon v1.22 - Organizational settings, wildcard env var inputs, and Nx migration]]></title>
            <link>https://moonrepo.dev/blog/moon-v1.22</link>
            <guid>https://moonrepo.dev/blog/moon-v1.22</guid>
            <pubDate>Mon, 26 Feb 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[This release introduces new organizational settings for projects, a migrate from Nx extension, and]]></description>
            <content:encoded><![CDATA[<p>This release introduces new organizational settings for projects, a migrate from Nx extension, and
more.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="more-organizational-settings">More organizational settings<a href="https://moonrepo.dev/blog/moon-v1.22#more-organizational-settings" class="hash-link" aria-label="Direct link to More organizational settings" title="Direct link to More organizational settings">​</a></h2>
<p>One aspect of moon that sets us apart from other build systems and tools, is that we have built-in
support for human-readable project and task metadata. This is extremely useful in organizing and
managing large repositories, especially when ownership comes into play. This information is also
used for categorization and filtering for MQL and our editor extensions/plugins.</p>
<p>To expand on this functionality even further, we're adding a few requests from the community, and
they are:</p>
<ul>
<li>
<p>New <code>configuration</code> and <code>scaffolding</code> variants for the project <a href="https://moonrepo.dev/docs/config/project#type"><code>type</code></a>
setting in <a href="https://moonrepo.dev/docs/config/project"><code>moon.yml</code></a>. Perfect for contracts and templates.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">type</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'configuration'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>New <a href="https://moonrepo.dev/docs/config/project#stack"><code>stack</code></a> setting in <a href="https://moonrepo.dev/docs/config/project"><code>moon.yml</code></a>, for
categorizing which tech stack the project belongs to. Supports <code>frontend</code>, <code>backend</code>,
<code>infrastructure</code>, and <code>systems</code>.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">stack</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'frontend'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>New <a href="https://moonrepo.dev/docs/config/project#description-1"><code>description</code></a> setting for tasks, that provides
human-readable information.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">description</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'Builds the project using Vite'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'vite build'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-wildcard-environment-variable-inputs">New wildcard environment variable inputs<a href="https://moonrepo.dev/blog/moon-v1.22#new-wildcard-environment-variable-inputs" class="hash-link" aria-label="Direct link to New wildcard environment variable inputs" title="Direct link to New wildcard environment variable inputs">​</a></h2>
<p>Task inputs have supported environment variables for quite a while now, but they are explicit, which
can be tedious too manage when you have many environment variables. To make this easier, we've added
support for wildcard environment variables, denoted by a <code>*</code>, which will match any environment
variable with that pattern.</p>
<p>For example, say we want to track all Node.js and Vite environment variables that start with <code>NODE_</code>
and <code>VITE_</code> respectively, we can simply do:</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'vite build'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">inputs</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'$NODE_*'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'$VITE_*'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>Do note that this <em>isn't</em> a glob, and the <code>*</code> is merely a substitution for any character!</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-migrate-nx-extension">New <code>migrate-nx</code> extension<a href="https://moonrepo.dev/blog/moon-v1.22#new-migrate-nx-extension" class="hash-link" aria-label="Direct link to new-migrate-nx-extension" title="Direct link to new-migrate-nx-extension">​</a></h2>
<p>In our previous release, we added support for <a href="https://moonrepo.dev/blog/moon-v1.21">migrating from Turborepo</a>, but what
about Nx? Nx is a very popular build system with many users. A lot of our current moon users were
former Nx users, but unfortunately, they had to go through the tedious process of migrating
everything manually. We wanted to make this process easier for new users, so we created a new
experimental extension to help with this process,
<a href="https://moonrepo.dev/docs/guides/extensions#migrate-nx"><code>migrate-nx</code></a>.</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ moon ext migrate-nx</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This extension was quite complicated to implement, as Nx has a <em>ton</em> of features. However, when the
extension is executed, we'll convert the root <code>nx.json</code> and <code>workspace.json</code> files to
<a href="https://moonrepo.dev/docs/config/workspace"><code>.moon/workspace.yml</code></a> and related top-level config files, and we'll also
convert every <code>project.json</code> and <code>package.json</code> (with an <code>nx</code> block) into a
<a href="https://moonrepo.dev/docs/config/project"><code>moon.yml</code></a> file.</p>
<p>Conversion is not a perfect 1:1, as moon and Nx are quite different. Please refer to the
<a href="https://moonrepo.dev/docs/guides/extensions#migrate-nx">official documentation</a> for a list of unsupported settings and
features.</p>
<div class="theme-admonition theme-admonition-info admonition_WCGJ alert alert--info"><div class="admonitionHeading_GCBg"><span class="admonitionIcon_L39b"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_pbrs"><p>An awesome feature that didn't make it in time for this release, is an npm package for Nx
compatiblity, that will allow Nx executors/plugins to be executed through moon, without the
requirement of Nx itself. This will allow for a seamless transition from Nx to moon, without the
need to change any of your existing Nx executors/plugins till later.</p><p>This functionality will be provided by our new
<a href="https://github.com/moonrepo/moon/tree/master/packages/nx-compat" target="_blank" rel="noopener noreferrer"><code>@moonrepo/nx-compat</code> package</a>,
which we hope to finish in the coming weeks.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/moon-v1.22#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.22.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added an <code>installArgs</code> setting for bun/npm/pnpm/yarn in <code>.moon/toolchain.yml</code>, to customize the
args used when installing dependencies.</li>
<li>Updated the <code>envFile</code> task option to support a list of file paths.</li>
</ul>]]></content:encoded>
            <category>project</category>
            <category>metadata</category>
            <category>nx</category>
            <category>migrate</category>
        </item>
        <item>
            <title><![CDATA[moon v1.21 - Deno tier 3, file group improvements, task shells, and more!]]></title>
            <link>https://moonrepo.dev/blog/moon-v1.21</link>
            <guid>https://moonrepo.dev/blog/moon-v1.21</guid>
            <pubDate>Wed, 07 Feb 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[With this release, get ready for Deno tier 3 support, file group and task improvements, a new]]></description>
            <content:encoded><![CDATA[<p>With this release, get ready for Deno tier 3 support, file group and task improvements, a new
extension, and more.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="deno-tier-3-support">Deno tier 3 support<a href="https://moonrepo.dev/blog/moon-v1.21#deno-tier-3-support" class="hash-link" aria-label="Direct link to Deno tier 3 support" title="Direct link to Deno tier 3 support">​</a></h2>
<p>We've supported Deno tier 1 and 2 for almost a year now, but were hesitant to support tier 3 until
<a href="https://moonrepo.dev/proto">proto</a> stabilizes further. Now that proto is <em>almost</em> at an official v1 release, and other
tools in the toolchain (like Node.js, Bun, and Rust) are powered by proto, we're confident in
supporting Deno tier 3. To make use of this, simply set the
<a href="https://moonrepo.dev/docs/config/toolchain#deno"><code>deno.version</code></a> setting in
<a href="https://moonrepo.dev/docs/config/toolchain"><code>.moon/toolchain.yml</code></a>.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.moon/toolchain.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">deno</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">version</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'1.40.0'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When enabled, moon will download and install that version of Deno in the background, and run all
subsequent tasks with it. This is great for ensuring that your project is always using the same
version of Deno, across all machines.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="file-groups-now-support-environment-variables">File groups now support environment variables<a href="https://moonrepo.dev/blog/moon-v1.21#file-groups-now-support-environment-variables" class="hash-link" aria-label="Direct link to File groups now support environment variables" title="Direct link to File groups now support environment variables">​</a></h2>
<p>Task <a href="https://moonrepo.dev/docs/config/project#inputs"><code>inputs</code></a> have supported environment variables for a while now,
but file groups have not. The main reason for this is that file groups were implemented far before
environment variables in task inputs! To bridge this gap, we've added support for environment
variables in file groups.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">fileGroups</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">vite</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'...'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'$VITE_SECRET_KEY'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'$NODE_ENV'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'vite build'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">inputs</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'@group(vite)'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Environment variables can be referenced using the
<a href="https://moonrepo.dev/docs/concepts/token#group"><code>@group</code> token function</a>, or the new
<a href="https://moonrepo.dev/docs/concepts/token#envs"><code>@envs</code> token function</a>. The latter is only supported for <code>inputs</code> and
will error for other locations, while the former is supported in <code>args</code>, <code>inputs</code>, and <code>outputs</code>,
but will filter out environment variables when they are not supported.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-unixshell-and-windowsshell-task-options">New <code>unixShell</code> and <code>windowsShell</code> task options<a href="https://moonrepo.dev/blog/moon-v1.21#new-unixshell-and-windowsshell-task-options" class="hash-link" aria-label="Direct link to new-unixshell-and-windowsshell-task-options" title="Direct link to new-unixshell-and-windowsshell-task-options">​</a></h2>
<p>When the <a href="https://moonrepo.dev/docs/config/project#shell"><code>shell</code></a> task option is enabled, we run the task within a
shell. However, the chosen shell was hard-coded to <code>$SHELL</code> on Unix machines and PowerShell on
Windows, but what if you wanted to run it with a different shell? Or the same shell across all
operating systems? Well, you couldn't.</p>
<p>But not anymore! With this release, we're introducing <a href="https://moonrepo.dev/docs/config/project#unixshell"><code>unixShell</code></a>
and <a href="https://moonrepo.dev/docs/config/project#windowsshell"><code>windowsShell</code></a> task options. When paired with <code>shell</code>, the
task will run in a shell of your choice. For example, why not Bash everywhere?</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">moon.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'vite build'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">shell</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">unixShell</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'bash'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">windowsShell</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'bash'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-migrate-turborepo-extension">New <code>migrate-turborepo</code> extension<a href="https://moonrepo.dev/blog/moon-v1.21#new-migrate-turborepo-extension" class="hash-link" aria-label="Direct link to new-migrate-turborepo-extension" title="Direct link to new-migrate-turborepo-extension">​</a></h2>
<p>In our previous release, we added support for <a href="https://moonrepo.dev/blog/moon-v1.20">extensions, a new kind of WASM plugin</a>.
Since this is a new experimental feature, we really wanted to show off what it can do, and stress
test its boundaries. To do that, we chose to migrate the old <code>moon migrate from-turborepo</code> command
into an extension
(<a href="https://github.com/moonrepo/moon-extensions/tree/master/crates/migrate-turborepo" target="_blank" rel="noopener noreferrer">source can be found here</a>).
This is our most complex extension so far, as it:</p>
<ul>
<li>Loads and parses files on the file system.</li>
<li>Reads and writes JSON and YAML files.</li>
<li>Supports deserializing data into structs.</li>
<li>Extracts project graph information by executing <code>moon project-graph</code>.</li>
</ul>
<p>Do you currently have a Turborepo powered repository? And want to migrate to moon? Then simply
execute the extension as such. View our
<a href="https://moonrepo.dev/docs/guides/extensions#migrate-turborepo">guide for more information</a>!</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ moon ext migrate-turborepo</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As part of the migration from moon's Rust core into a WASM plugin, we've added support for the
following new features:</p>
<ul>
<li>Added Bun support behind a new <code>--bun</code> flag.</li>
<li>Added support for Turbo's <code>globalDotEnv</code>, <code>dotEnv</code>, and <code>outputMode</code>.</li>
<li>Added support for root-level tasks (<code>//#</code>) through a root <code>moon.yml</code>, instead of logging a
warning.</li>
<li>Updated migrated task commands to run through a package manager, instead of
<code>moon node run-script</code>.</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_WCGJ alert alert--info"><div class="admonitionHeading_GCBg"><span class="admonitionIcon_L39b"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_pbrs"><p>Based on the success of this extension, we plan to support a <code>migrate-nx</code> extension in the future!
If you'd like to help in this endeavor, let us know!</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/moon-v1.21#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.21.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added <code>bun.inferTasksFromScripts</code> setting to <code>.moon/toolchain.yml</code>, for compatibility with
Node.js.</li>
<li>Added a <code>--quiet</code> global argument, for hiding non-critical moon output.</li>
<li>Updated tasks with glob-like arguments to automatically enabled the <code>shell</code> option, so that glob
expansion works correctly.</li>
<li>Implemented a new buffered console layer for writing to stdout/stderr.</li>
</ul>]]></content:encoded>
            <category>deno</category>
            <category>file-groups</category>
            <category>env</category>
            <category>shell</category>
            <category>tasks</category>
            <category>turborepo</category>
        </item>
        <item>
            <title><![CDATA[moon v1.20 - Extension plugins, default task options, and more]]></title>
            <link>https://moonrepo.dev/blog/moon-v1.20</link>
            <guid>https://moonrepo.dev/blog/moon-v1.20</guid>
            <pubDate>Fri, 26 Jan 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[In this release, we're excited to introduce extensions, our first type of plugin!]]></description>
            <content:encoded><![CDATA[<p>In this release, we're excited to introduce extensions, our first type of plugin!</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-extension-plugins">New extension plugins<a href="https://moonrepo.dev/blog/moon-v1.20#new-extension-plugins" class="hash-link" aria-label="Direct link to New extension plugins" title="Direct link to New extension plugins">​</a></h2>
<p>In our <a href="https://moonrepo.dev/blog/2024-roadmap">2024 roadmap blog post</a>, we talked heavily about plugins, as we believe
they're the future of moon and its ecosystem. What we didn't talk about is that we plan to have
<em>many types of plugins</em>, and not just language/platform specific ones. And with that, we're excited
to introduce extensions!</p>
<p>An extension is a WASM plugin that allows you to extend moon with additional functionality, have
whitelisted access to the file system, and receive partial information about the current workspace.
Extensions are extremely useful in offering new and unique functionality that doesn't need to be
built into moon's core.</p>
<p>Once such extension is our built-in <code>download</code> extension, which is a basic extension that simply
downloads a file from a URL into the current moon workspace.</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ moon ext download -- </span><span class="token parameter variable" style="color:#fef9c3">--url</span><span class="token plain"> https://github.com/moonrepo/proto/releases/latest/download/proto_cli-aarch64-apple-darwin.tar.xz</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Shipping alongside extensions are the following new features:</p>
<ul>
<li>An <a href="https://moonrepo.dev/docs/guides/extensions">official extensions guide</a>!</li>
<li>An <a href="https://moonrepo.dev/docs/config/workspace#extensions"><code>extensions</code></a> setting for configuring new extensions.</li>
<li>A <a href="https://moonrepo.dev/docs/commands/ext"><code>moon ext</code></a> command for executing a configured extension.</li>
<li>The required infrastructure for plugins!</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="configure-default-options-for-tasks">Configure default options for tasks<a href="https://moonrepo.dev/blog/moon-v1.20#configure-default-options-for-tasks" class="hash-link" aria-label="Direct link to Configure default options for tasks" title="Direct link to Configure default options for tasks">​</a></h2>
<p><a href="https://moonrepo.dev/docs/config/project#options">Task options</a> provide a way to apply granular changes to a task's
behavior when running in the pipeline. However, they can become tedious when you need to apply them
to many tasks, especially when inheritance is involved. To help with this, you can now configure the
<a href="https://moonrepo.dev/docs/config/tasks#taskoptions"><code>taskOptions</code></a> setting in task related configs, like
<code>.moon/tasks.yml</code> and <code>.moon/tasks/*.yml</code>, which acts as the base/default options for all inherited
tasks.</p>
<p>For example, the following config:</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.moon/tasks.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token comment" style="color:#97a1af;font-style:italic"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">outputStyle</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'stream'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">retryCount</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">lint</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token comment" style="color:#97a1af;font-style:italic"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">outputStyle</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'stream'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">retryCount</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">test</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token comment" style="color:#97a1af;font-style:italic"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">options</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">outputStyle</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'stream'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token key atrule">retryCount</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">2</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Can simply be rewritten as:</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.moon/tasks.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">taskOptions</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">outputStyle</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'stream'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">retryCount</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token number" style="color:#94dded">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token comment" style="color:#97a1af;font-style:italic"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">lint</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token comment" style="color:#97a1af;font-style:italic"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">test</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token comment" style="color:#97a1af;font-style:italic"># ...</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Because these options are defined at the workspace-level, they adhere to the same merge and
inheritance rules as other settings. Just be aware that these options are inherited first in the
chain, and can be overwritten by other layers, or by project-level tasks.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="optional-task-dependencies">Optional task dependencies<a href="https://moonrepo.dev/blog/moon-v1.20#optional-task-dependencies" class="hash-link" aria-label="Direct link to Optional task dependencies" title="Direct link to Optional task dependencies">​</a></h2>
<p>By default, all task <a href="https://moonrepo.dev/docs/config/project#tasks-1"><code>deps</code></a> are required to exist when tasks are
being built and expanded, but this isn't always true when dealing with composition and inheritance.
For example, say you're using
<a href="https://moonrepo.dev/docs/concepts/task-inheritance#scope-by-project-metadata">tag-based inheritance</a>, and a global
task relies on one of these tagged tasks, but not all projects may define the appropriate tags. In
previous versions of moon, this is a hard failure, as the dependent task does not exist.</p>
<p>To remedy this, we're introducing a new <a href="https://moonrepo.dev/docs/config/project#optional-1"><code>optional</code></a> flag for task
dependencies. When set to <code>true</code>, moon will no longer error when the task doesn't exist, and instead
will omit the dependency.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.moon/tasks.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'vite'</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">deps</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token key atrule">target</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'#components:build'</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#e5e9f1"><span class="token plain">        </span><span class="token key atrule">optional</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">true</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>Thanks to <a href="https://github.com/maastrich" target="_blank" rel="noopener noreferrer">@maastrich</a> for this contribution!</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/moon-v1.20#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.20.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added a "Tags" view to the VSCode extension.</li>
<li>Updated proto to v0.29.1 (from v0.26.4).</li>
<li>Updated proto installation to trigger for all applicable commands, not just <code>moon run</code>,
<code>moon check</code>, and <code>moon ci</code>.</li>
</ul>]]></content:encoded>
            <category>task</category>
            <category>options</category>
            <category>extensions</category>
            <category>plugins</category>
        </item>
        <item>
            <title><![CDATA[proto v0.29 - Better environment support]]></title>
            <link>https://moonrepo.dev/blog/proto-v0.29</link>
            <guid>https://moonrepo.dev/blog/proto-v0.29</guid>
            <pubDate>Tue, 23 Jan 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[In this release, we focused heavily on environment interoperability.]]></description>
            <content:encoded><![CDATA[<p>In this release, we focused heavily on environment interoperability.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-environment-aware-configuration">New environment aware configuration<a href="https://moonrepo.dev/blog/proto-v0.29#new-environment-aware-configuration" class="hash-link" aria-label="Direct link to New environment aware configuration" title="Direct link to New environment aware configuration">​</a></h2>
<p>We've made a small but useful improvement to <code>.prototools</code>, environment aware files! When the
<code>PROTO_ENV</code> environment variable is set, proto will look for an additional <code>.prototools.{env}</code> file
and merge it with the base configuration.</p>
<p>This is useful for certain deploy scenarios where you need different versions of tools, environment
variables, or settings!</p>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.prototools</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key property" style="color:#b7a9f9">node</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"21.0.0"</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.prototools.production</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key property" style="color:#b7a9f9">node</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"20.0.0"</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-env-and-toolsenv-settings">New <code>[env]</code> and <code>[tools.*.env]</code> settings<a href="https://moonrepo.dev/blog/proto-v0.29#new-env-and-toolsenv-settings" class="hash-link" aria-label="Direct link to new-env-and-toolsenv-settings" title="Direct link to new-env-and-toolsenv-settings">​</a></h2>
<p>We're also introducing 2 new settings to the <code>.prototools</code> file, <a href="https://moonrepo.dev/docs/proto/config#env"><code>[env]</code></a>
and <a href="https://moonrepo.dev/docs/proto/config#toolsenv"><code>[tools.*.env]</code></a>, both of which configure environment variables
that'll be applied when the tool is executed. This is useful for defining directory-level and
tool-specific variables.</p>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.prototools</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">env</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">DEBUG</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"*"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">tools.node.env</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">NODE_ENV</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"production"</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>View the <a href="https://moonrepo.dev/docs/proto/config">configuration documentation</a> for more information on how these work!</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/proto-v0.29#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/proto/releases/tag/v0.29.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Updated <code>proto tool info</code> to display aliases and environment variables.</li>
<li>Updated WASM logs to be shown alongside proto's <code>--log</code> output (under the <code>extism::pdk</code>
namespace).</li>
</ul>]]></content:encoded>
            <category>proto</category>
            <category>environment</category>
        </item>
        <item>
            <title><![CDATA[proto v0.28 - Upgraded WASM runtime]]></title>
            <link>https://moonrepo.dev/blog/proto-v0.28</link>
            <guid>https://moonrepo.dev/blog/proto-v0.28</guid>
            <pubDate>Wed, 17 Jan 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[This is a small release that primarily upgrades our WASM runtime.]]></description>
            <content:encoded><![CDATA[<p>This is a small release that primarily upgrades our WASM runtime.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="upgraded-wasm-runtime">Upgraded WASM runtime<a href="https://moonrepo.dev/blog/proto-v0.28#upgraded-wasm-runtime" class="hash-link" aria-label="Direct link to Upgraded WASM runtime" title="Direct link to Upgraded WASM runtime">​</a></h2>
<p>proto utilizes <a href="https://extism.org/" target="_blank" rel="noopener noreferrer">Extism</a> for our WASM plugin architecture, which internally uses
<a href="https://wasmtime.dev/" target="_blank" rel="noopener noreferrer">wasmtime</a> as our execution runtime. Up until this point, we've been using a
beta release of Extism, v0.5, which has worked quite nicely. We've also been working closely with
the Extism team to report bugs, provide feedback, and help improve the project. Once such feature
was the massive performance gains in <a href="https://moonrepo.dev/blog/proto-v0.24">proto v0.24</a>.</p>
<p>Thanks to all the hard work from the Extism team over the past year, an official v1.0 was released.
Because this was a major release, it did include breaking changes around the WASM runtime, and as
such, proto WASM plugins before v0.28 are <em>no longer compatible</em>, and will need to be recompiled
with the latest PDKs. Our proto TOML plugins are not affected.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/proto-v0.28#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/proto/releases/tag/v0.28.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Will now display an upgrade message when the current proto version is out of date.</li>
<li>Improved error messages to include plugin specific information.</li>
<li>Updated our "last used at" logic to avoid race conditions with the tool manifest.</li>
</ul>]]></content:encoded>
            <category>proto</category>
            <category>wasm</category>
            <category>runtime</category>
            <category>extism</category>
        </item>
        <item>
            <title><![CDATA[What's in store for 2024]]></title>
            <link>https://moonrepo.dev/blog/2024-roadmap</link>
            <guid>https://moonrepo.dev/blog/2024-roadmap</guid>
            <pubDate>Fri, 12 Jan 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[Happy new year! Let's start 2024 by reflecting on last year and diving into our tentative year long]]></description>
            <content:encoded><![CDATA[<p>Happy new year! Let's start 2024 by reflecting on last year and diving into our tentative year long
roadmap.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="year-2023-in-review">Year 2023 in review<a href="https://moonrepo.dev/blog/2024-roadmap#year-2023-in-review" class="hash-link" aria-label="Direct link to Year 2023 in review" title="Direct link to Year 2023 in review">​</a></h2>
<p>Last year was an extremely exciting year for us! To start, we were accepted into the
<a href="https://www.ycombinator.com/companies/moonrepo" target="_blank" rel="noopener noreferrer">Y Combinator 2023 winter batch</a>, which was
extremely unexpected, but very much welcome. The 3 months we spent in YC was quite eye opening, as
we learned so much about the industry, and how to move forward. We spent those 3 months really
diving into what we want to build and deliver, and after much trial and error, and many failed
prototypes, we chose to move forward with launching <a href="https://moonrepo.dev/proto">proto</a> as its own tool, improving
<a href="https://moonrepo.dev/moon">moon</a>, and slowing down development of <a href="https://moonrepo.dev/moonbase">moonbase</a> (outside of remote caching).</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="moon">moon<a href="https://moonrepo.dev/blog/2024-roadmap#moon" class="hash-link" aria-label="Direct link to moon" title="Direct link to moon">​</a></h3>
<p>For <a href="https://moonrepo.dev/moon">moon</a>, we officially launched v1 back in March, and celebrated its 2 year birthday in
October. Over the course of 2023, we released 23 minor versions, jam packed with new features such
as:</p>
<ul>
<li>Action and project graphs improvements</li>
<li>Bun tier 1, 2, and 3 support</li>
<li>Canary &amp; nightly releases</li>
<li>Code ownership (<code>CODEOWNERS</code>)</li>
<li>Configuration rewrite (using our <a href="https://github.com/moonrepo/schematic" target="_blank" rel="noopener noreferrer">schematic</a> crate)</li>
<li>Deno tier 1 and 2 support</li>
<li>Developer experience improvements</li>
<li>Documentation polish</li>
<li>Experiments</li>
<li>Interactive &amp; persistent tasks</li>
<li>JavaScript and TypeScript improvements</li>
<li>Onboarding flow improvements</li>
<li><code>PATH</code> based task execution</li>
<li><a href="https://moonrepo.dev/proto">proto</a> integration</li>
<li>Query language</li>
<li><a href="https://railway.app/" target="_blank" rel="noopener noreferrer">Railway</a> support</li>
<li>Rust tier 1, 2, and 3 support</li>
<li>Tagging and boundaries/contraints</li>
<li>Task extending, inheritance, and configuration enhancements</li>
<li>Task dependencies configurations</li>
<li>Toolchain enhancements</li>
<li>VCS (Git) hooks</li>
<li>... and much much more!</li>
</ul>
<p>However, when looking at our <a href="https://moonrepo.dev/blog/2023-roadmap">2023 roadmap</a>, there are a few items we failed to
deliver on. The biggest are additional languages, better tier support, and release workflows. We
ultimately didn't land these features as we plan to move to a plugin based architecture, and didn't
want to invest too much time into the current implementation.</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="moonbase">moonbase<a href="https://moonrepo.dev/blog/2024-roadmap#moonbase" class="hash-link" aria-label="Direct link to moonbase" title="Direct link to moonbase">​</a></h3>
<p>During YC, we officially launched <a href="https://moonrepo.dev/moonbase">moonbase</a>, our cloud service that offers remote caching
to all moon users (and also includes a free tier). Over the next few months, we continued to improve
the service, by adding basic insights into CI runs (powered by <a href="https://moonrepo.dev/docs/commands/ci"><code>moon ci</code></a>), and
overall stability.</p>
<p>However, we unfortunately made the decision to pause development of new features for moonbase, as we
were unsure of the value that they would provide to end-users compared to the cost it would take to
build &amp; maintain. Some such features include code and project ownership, project registry, and
repository health scores. We may revisit this in the future.</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="proto">proto<a href="https://moonrepo.dev/blog/2024-roadmap#proto" class="hash-link" aria-label="Direct link to proto" title="Direct link to proto">​</a></h3>
<p>As for <a href="https://moonrepo.dev/proto">proto</a>, it's been an exciting year. For context, proto's implementation was
originally built into moon directly, and powered
<a href="https://moonrepo.dev/docs/concepts/toolchain">moon's integrated toolchain</a>. We strongly felt this functionality can be
useful as a stand-alone tool, as tool installation and developer environment setup is still a major
pain point for developers.</p>
<p>So we decided to extract it out into its own tool, and thus proto was born. Since then, we've
released 27 minor versions with:</p>
<ul>
<li>Additional language support: Go, Python</li>
<li>Binary symlinking</li>
<li>Canary &amp; nightly releases</li>
<li>Detection improvements</li>
<li>Directory-level configuration</li>
<li>Deeper shell integration</li>
<li>Global packages support</li>
<li>Native shim executables</li>
<li>Runtime version detection</li>
<li>WASM and TOML based plugins</li>
<li>... and more to come!</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="launching-moon-v2">Launching moon v2<a href="https://moonrepo.dev/blog/2024-roadmap#launching-moon-v2" class="hash-link" aria-label="Direct link to Launching moon v2" title="Direct link to Launching moon v2">​</a></h2>
<p>It's been almost a year since we launched v1, and we believe we're ready to start planning out and
working on v2. Our goal for major releases is to introduce breaking changes in the most seamless way
possible, and to do so, we plan to incrementally land internal changes in v1 in preparation for v2,
provide codemods for migrating configuration, and of course, provide an in-depth migration guide.</p>
<p>In order of importance, we plan to land the following changes. This list does not include features
that will <a href="https://moonrepo.dev/blog/2024-roadmap#post-launch-features">land after v2</a>.</p>
<ul>
<li>Move to a <a href="https://moonrepo.dev/blog/2024-roadmap#plugin-based-architecture">plugin based architecture</a></li>
<li>Rename and standardize some configuration settings</li>
<li>Removed deprecated features</li>
</ul>
<p>It's a short list but also a ton of work. We have no ETA on when this will land exactly.</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="plugin-based-architecture">Plugin based architecture<a href="https://moonrepo.dev/blog/2024-roadmap#plugin-based-architecture" class="hash-link" aria-label="Direct link to Plugin based architecture" title="Direct link to Plugin based architecture">​</a></h3>
<p>The biggest change and primary focus for v2 is to move to a WASM plugin based architecture (for
language integration). Based on our work with <a href="https://moonrepo.dev/docs/proto/plugins">proto's plugins</a>, we have a very
good idea of how we would model this for moon, and a new love for WASM based plugins (powered by
<a href="https://extism.org/" target="_blank" rel="noopener noreferrer">Extism</a>).</p>
<p>One of the leading factors for this decision, is that building everything into Rust directly is not
scalable, is a maintenance headache, and is also extremely difficult. It results in a lot of
duplicated code, increased compilation times, and a lot of complexity. By moving to plugins, we can
ditch most of this, and in the grand scheme of things, plugin integration is simply function calls.</p>
<p>Of course there are a handful of additional benefits that come from plugins:</p>
<ul>
<li>Enables the community to build and share their own plugins (additional languages).</li>
<li>Plugins can be individually updated, versioned, and released. Less moon patches.</li>
<li>Reduces moon's compilation times, as plugins live in their own repositories.</li>
<li>Easier to contribute to, as moon's codebase is quite complex.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="post-launch-features">Post-launch features<a href="https://moonrepo.dev/blog/2024-roadmap#post-launch-features" class="hash-link" aria-label="Direct link to Post-launch features" title="Direct link to Post-launch features">​</a></h3>
<p>Curious what kind of features we have planned for after v2? Of course you are! This isn't an
exhaustive or detailed list, but is top of mind:</p>
<ul>
<li>Additional languages support (will be much easier with a plugin system)</li>
<li>Release workflows (versioning, publishing, changelogs, etc)</li>
<li>System dependencies within the toolchain</li>
<li>Language dependency management tools</li>
<li>Repository and project health scores</li>
<li>Improved action graph and pipeline</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="launching-proto-v1">Launching proto v1<a href="https://moonrepo.dev/blog/2024-roadmap#launching-proto-v1" class="hash-link" aria-label="Direct link to Launching proto v1" title="Direct link to Launching proto v1">​</a></h2>
<p>We're extremely close to a v1 release, most definitely in Q1. For the most part, we believe we're
passed the point of introducing breaking changes, and so the remainder of the time will be spent on
polish, improvements, and documentation. There are a few big features we want to land relatively
soon though (but maybe after v1), and they are:</p>
<ul>
<li>Build from source for languages (this is quite complicated)</li>
<li>Build/extension variants for languages (PyPy for Python, PHP extensions, etc)</li>
<li>Directory and tool level environment variables (think <a href="https://direnv.net/" target="_blank" rel="noopener noreferrer">direnv</a> kind of
functionality)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="expanding-language-support">Expanding language support<a href="https://moonrepo.dev/blog/2024-roadmap#expanding-language-support" class="hash-link" aria-label="Direct link to Expanding language support" title="Direct link to Expanding language support">​</a></h3>
<p>While not part of v1, we definitely want to support more official languages in proto. We've been
pushing back on new languages until after v1 and the plugin APIs have stabilized, but since that's
relatively close to being done, expect more in the future! Our top of mind languages at the moment
are: Ruby (and Crystal), PHP, and Java.</p>
<p>Don't forget that the community can also build and share their own plugins! For example, the
<a href="https://github.com/konomae/zig-plugin" target="_blank" rel="noopener noreferrer">Zig programming language</a> already exists, and is provided by
<a href="https://github.com/konomae" target="_blank" rel="noopener noreferrer">konomae</a>! Thanks for the amazing work.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="self-hosting-moonbase">Self-hosting moonbase<a href="https://moonrepo.dev/blog/2024-roadmap#self-hosting-moonbase" class="hash-link" aria-label="Direct link to Self-hosting moonbase" title="Direct link to Self-hosting moonbase">​</a></h2>
<p>And last but not least, let's talk about moonbase. Although we've paused development on new
features, we consistently get requests for self-hosting moonbase (primarily for remote caching), as
companies don't want to store their proprietary builds, even though they are compiled and minified,
in a cloud storage provider that they do not own.</p>
<p>We definitely understand this concern, and that's why we've been working on a self-hosted version of
moonbase (also known as on-premises). We've never done this before, so it's been quite a learning
lesson, especially since we have many facets to take into account: database access, cloud
credentials, error handling, auth, so on and so forth.</p>
<p>We'd say we're about 50% done with this effort, and we aim to have it ready by the end of Q1. With
that said, the self-hosted version of moonbase will <em>not</em> be free, and will use a license based
model. We're still working out the details, but we'll have more information soon.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="looking-for-contributors">Looking for contributors<a href="https://moonrepo.dev/blog/2024-roadmap#looking-for-contributors" class="hash-link" aria-label="Direct link to Looking for contributors" title="Direct link to Looking for contributors">​</a></h2>
<p>Thanks for reading this far, but we do have one last thing to talk about. The moonrepo ecosystem and
all its products are quite large, with a lot of complexity. However, we're a small team, with most
of the public-facing work being done by me (Miles), but there's only so much we can do in a given
timeframe. With that said, we're looking for open source contributors that would like to help us
out! We have a long list of features and enhancements that need to be done, and even some secret
projects that would be very cool to work on. If you're interested, please reach out to us on
Discord!</p>]]></content:encoded>
            <category>roadmap</category>
            <category>moonbase</category>
            <category>proto</category>
            <category>toolchain</category>
        </item>
        <item>
            <title><![CDATA[proto v0.27 - PowerShell profiles, shim regeneration, and more]]></title>
            <link>https://moonrepo.dev/blog/proto-v0.27</link>
            <guid>https://moonrepo.dev/blog/proto-v0.27</guid>
            <pubDate>Thu, 04 Jan 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[This is a small release that improves the overall developer experience.]]></description>
            <content:encoded><![CDATA[<p>This is a small release that improves the overall developer experience.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="powershell-profile-support">PowerShell profile support<a href="https://moonrepo.dev/blog/proto-v0.27#powershell-profile-support" class="hash-link" aria-label="Direct link to PowerShell profile support" title="Direct link to PowerShell profile support">​</a></h2>
<p>When proto was first launched, we didn't support PowerShell profiles, but did support Windows by
running <code>setx</code> commands to inject the <code>PROTO_HOME</code> environment variable, and update <code>PATH</code>. While
this worked, it was not ideal, and unexpected for users. This is our fault and our lack of Windows
knowledge.</p>
<p>Starting with v0.27, we now official support PowerShell profiles, and will no longer call <code>setx</code>.
Instead we write the environment variable changes to one of these files, depending on what exists:</p>
<ul>
<li>Windows<!-- -->
<ul>
<li><code>~\Documents\PowerShell\Microsoft.PowerShell_profile.ps1</code></li>
<li><code>~\Documents\PowerShell\Profile.ps1</code></li>
</ul>
</li>
<li>Unix<!-- -->
<ul>
<li><code>~/.config/powershell/Microsoft.PowerShell_profile.ps1</code></li>
<li><code>~/.config/powershell/profile.ps1</code></li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="regenerate-shims--bins">Regenerate shims &amp; bins<a href="https://moonrepo.dev/blog/proto-v0.27#regenerate-shims--bins" class="hash-link" aria-label="Direct link to Regenerate shims &amp; bins" title="Direct link to Regenerate shims &amp; bins">​</a></h2>
<p>proto has gone through some growing pains, we won't deny that. With the handful of breaking changes,
the configuration refactor, and the ground-up rework of how shims/bins are handled, we've hit a few
snags. Most of those snags have been around tool execution.</p>
<p>To remedy some of these problems, we're introducing the <a href="https://moonrepo.dev/docs/proto/commands/regen"><code>proto regen</code></a>
command. This command will clean the shims (<code>~/.proto/shims</code>) and optionally bins (<code>~/.proto/bins</code>)
directory, regenerate shims, and relink bins based on globally pinned versions.</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ proto regen</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Include bins</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ proto regen </span><span class="token parameter variable" style="color:#fef9c3">--bin</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This is extremely useful in resetting to a clean state.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="better-version-parsing-for-toml-plugins">Better version parsing for TOML plugins<a href="https://moonrepo.dev/blog/proto-v0.27#better-version-parsing-for-toml-plugins" class="hash-link" aria-label="Direct link to Better version parsing for TOML plugins" title="Direct link to Better version parsing for TOML plugins">​</a></h2>
<p>When our <a href="https://moonrepo.dev/docs/proto/toml-plugin">TOML plugin</a> receives a version, we attempt to parse it into a
valid semantic version. However, not all tools follow semver, as they may release without patch or
minor versions, or use a different pre/build pattern.</p>
<p>To remedy this, we've updated our regex to be more flexible, and to utilize named capture groups.
With named groups, we can now piece the version together, fill in missing values, and then parse it.</p>
<p>We've also renamed the field to <code>version-pattern</code> from <code>git-tag-pattern</code>, as the regex is now also
used for manifest parsing. The old name is still supported for the time being.</p>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token comment" style="color:#97a1af;font-style:italic"># Before</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">resolve</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">git-tag-pattern</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"^@protostar/cli@((\\d+)\\.(\\d+)\\.(\\d+))"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># After</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">resolve</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">version-pattern</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"^@protostar/cli@((?&lt;major&gt;\\d+)\\.(?&lt;minor&gt;\\d+)\\.(?&lt;patch&gt;\\d+))"</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>Jump to the <a href="https://moonrepo.dev/docs/proto/toml-plugin#version-patterns">official documentation</a> for more
information!</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/proto-v0.27#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/proto/releases/tag/v0.27.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>]]></content:encoded>
            <category>proto</category>
            <category>shim</category>
            <category>bin</category>
            <category>shell</category>
            <category>profile</category>
            <category>windows</category>
        </item>
        <item>
            <title><![CDATA[moon v1.19 - Improvements to task dependencies, codegen, and more]]></title>
            <link>https://moonrepo.dev/blog/moon-v1.19</link>
            <guid>https://moonrepo.dev/blog/moon-v1.19</guid>
            <pubDate>Mon, 01 Jan 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[In this release, we're introducing some long-awaited and requested improvements.]]></description>
            <content:encoded><![CDATA[<p>In this release, we're introducing some long-awaited and requested improvements.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="configure-args-and-env-vars-for-task-dependencies">Configure args and env vars for task dependencies<a href="https://moonrepo.dev/blog/moon-v1.19#configure-args-and-env-vars-for-task-dependencies" class="hash-link" aria-label="Direct link to Configure args and env vars for task dependencies" title="Direct link to Configure args and env vars for task dependencies">​</a></h2>
<p>This has been a long standing request from the community, and we're happy to finally deliver it.
Starting with v1.19, you can now configure optional command line arguments and environment variables
for each task <a href="https://moonrepo.dev/docs/config/project#deps"><code>deps</code></a> entry. These values will be passed to the task
when it is executed.</p>
<p>Here's an example of what both patterns look like. The <code>target</code> field is required when configuring
an object, and both the <code>args</code> and <code>env</code> fields can be mixed and matched.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">moon.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'vite build'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">deps</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token comment" style="color:#97a1af;font-style:italic"># Just a target</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'^:build'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token comment" style="color:#97a1af;font-style:italic"># With args (string)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token key atrule">target</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'^:build'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">        </span><span class="token key atrule">args</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'--mode production'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token comment" style="color:#97a1af;font-style:italic"># With env vars</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token key atrule">target</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'^:build'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">        </span><span class="token key atrule">env</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">          </span><span class="token key atrule">NODE_ENV</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'production'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token comment" style="color:#97a1af;font-style:italic"># With args (array) and env vars</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token key atrule">target</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'^:build'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">        </span><span class="token key atrule">args</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">          </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'--mode'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">          </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'production'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">        </span><span class="token key atrule">env</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">          </span><span class="token key atrule">NODE_ENV</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'production'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When using this functionality, there are a few things to understand about its implementation, and
how it affects the rest of the pipeline:</p>
<ul>
<li>When extending or inheriting a task and a merger is required, and this task has a dependency with
a colliding target, the <code>args</code> and <code>env</code> fields will <em>NOT</em> be deeply merged. Whichever task is
inherited last will have its <code>deps</code> used.</li>
<li>When multiple dependencies of the same target are ran in the action pipeline, but with differing
args or env vars, only 1 will run at a time. We try to avoid running them in parallel to avoid
collisions and corrupting outputs.</li>
<li>Arguments and environment variables do <em>NOT</em> support tokens.</li>
<li>If dependencies all write to the same output, cleaning the output is your responsibility, not
moon's.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="codegen-improvements">Codegen improvements<a href="https://moonrepo.dev/blog/moon-v1.19#codegen-improvements" class="hash-link" aria-label="Direct link to Codegen improvements" title="Direct link to Codegen improvements">​</a></h2>
<p>Code generation is one of moon's oldest features, and hasn't been improved in quite a while. We felt
the time was right to give it a little love.</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="extend-other-templates">Extend other templates<a href="https://moonrepo.dev/blog/moon-v1.19#extend-other-templates" class="hash-link" aria-label="Direct link to Extend other templates" title="Direct link to Extend other templates">​</a></h3>
<p>This has been a <a href="https://github.com/moonrepo/moon/issues/434" target="_blank" rel="noopener noreferrer">request for over a year</a>, and we
finally found the time to put it on the roadmap. Starting with this release, you can now extend
other templates using the <a href="https://moonrepo.dev/docs/config/template#extends"><code>extends</code></a> setting in
<a href="https://moonrepo.dev/docs/config/template"><code>template.yml</code></a>, which supports a list of template names.</p>
<p>Templates will be recursively extended from top to bottom, and all files and variables will be
inherited and merged at the top-level.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">template.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">title</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'npm package'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key atrule">extends</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">'node-common'</span><span class="token punctuation" style="color:#cad4e2">]</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="configure-a-default-destination">Configure a default destination<a href="https://moonrepo.dev/blog/moon-v1.19#configure-a-default-destination" class="hash-link" aria-label="Direct link to Configure a default destination" title="Direct link to Configure a default destination">​</a></h3>
<p>When you call <a href="https://moonrepo.dev/docs/commands/generate"><code>moon generate</code></a> you must provide a destination directory
for the generated files, or we'll prompt you to provide one. But what if you wanted to standardize
the destination? For example, a package scaffolding template should go to <code>packages/</code>. This is now
possible with the optional <a href="https://moonrepo.dev/docs/config/template#destination"><code>destination</code></a> setting in
<a href="https://moonrepo.dev/docs/config/template"><code>template.yml</code></a>.</p>
<p>If no destination is provided to <code>moon generate</code>, we'll use this default destination.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">template.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">title</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'npm package'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key atrule">destination</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'packages/[name | kebab_case]'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key atrule">variables</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'string'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">default</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">''</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">required</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">prompt</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'Package name?'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info admonition_WCGJ alert alert--info"><div class="admonitionHeading_GCBg"><span class="admonitionIcon_L39b"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_pbrs"><p>For better interoperability, this setting can also reference variables using <code>[var]</code> syntax, and can
also use Tera filters. Learn more about this in the
<a href="https://moonrepo.dev/docs/guides/codegen#interpolation">code generation documentation</a>.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="resolved-long-standing-experiments">Resolved long-standing experiments<a href="https://moonrepo.dev/blog/moon-v1.19#resolved-long-standing-experiments" class="hash-link" aria-label="Direct link to Resolved long-standing experiments" title="Direct link to Resolved long-standing experiments">​</a></h2>
<p>moon has a concept of <a href="https://moonrepo.dev/docs/config/workspace#experiments">experiments</a>, where certain features are
gated behind a flag. This allows us to support new and old functionality in parallel, and also allow
users to gradually upgrade when encountering a breaking change. For many months now, we've had 2
experiments running, and have decided on a path forward.</p>
<p>The first is <code>experiments.interweavedTaskInheritance</code>, which would inherit global and local tasks in
order, interweaved within each other. The old implementation would inherit global first, then local
second, distinctly grouping them. Since this experiment was introduced, we have not received a
single bug report or issue. This is a good sign that the new behavior is working as expected, and as
such, have decided <em>to move forward</em> with this experiment and make it the new implementation. The
old implementation has been removed entirely.</p>
<p>The second is <code>experiments.taskOutputBoundaries</code>, which was rather controversial when introduced.
This experiment would trigger an error anytime a <a href="https://moonrepo.dev/docs/config/project#outputs">task's <code>outputs</code></a> overlapped within
another <a href="https://moonrepo.dev/docs/config/project#outputs">task's <code>outputs</code></a>. The reason for this change, is that multiple tasks writing to
the same output location could "corrupt" the expected state, and trigger unexpected results when
hydrating from the cache. However in practice, this restriction has caused more headache and
introduced a steeper learning curve then expected. It also caused problems with
<a href="https://moonrepo.dev/docs/config/project#extends">tasks that extend</a> from another, resulting in the same outputs being
used. Because of this, we've decided <em>to <strong>not</strong> move forward</em> with this experiment, and allow
whatever task outputs you wish (we trust you're smart enough to not shoot yourself in the foot).</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/moon-v1.19#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.19.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Updated proto to v0.26 (from v0.25), which includes a new shims implementation.</li>
<li>Updated VS Code extension to support multiple VS Code workspace folders.</li>
</ul>]]></content:encoded>
            <category>task</category>
            <category>deps</category>
            <category>args</category>
            <category>env</category>
            <category>codegen</category>
            <category>templates</category>
            <category>experiments</category>
        </item>
        <item>
            <title><![CDATA[proto v0.26 - New native shim implementation]]></title>
            <link>https://moonrepo.dev/blog/proto-v0.26</link>
            <guid>https://moonrepo.dev/blog/proto-v0.26</guid>
            <pubDate>Thu, 21 Dec 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[After many release candidates, and a ton of testing, proto v0.26 is finally here!]]></description>
            <content:encoded><![CDATA[<p>After many release candidates, and a ton of testing, proto v0.26 is finally here!</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="rethinking-shims">Rethinking shims<a href="https://moonrepo.dev/blog/proto-v0.26#rethinking-shims" class="hash-link" aria-label="Direct link to Rethinking shims" title="Direct link to Rethinking shims">​</a></h2>
<p>proto at its core is a version manager, which means like most version managers, it relies on a
concept known as shims. Shims are lightweight executable scripts that act like a proxy to the
underlying binary, and are useful for proto to intercept executions and inject custom functionality,
like our dynamic version detection.</p>
<p>On Unix machines, we relied on Bash scripts for shims, which worked rather well. However, on
Windows, we relied on PowerShell scripts (<code>.ps1</code>), batch/cmd scripts (<code>.cmd</code>), and Bash scripts, all
with differing levels of functionality, and each serving a separate purpose. Windows support <em>did
not</em> work well.</p>
<p>To avoid current and future compatibility issues, we needed a truly native solution, and that's
exactly what we did. In this release, we wrote our own Rust based executable, that will replace all
of the custom shim scripts. This new executable is named <code>proto-shim</code> (<code>proto-shim.exe</code> on Windows)
and is published alongside the <code>proto</code> binary.</p>
<p>This new executable solves all of the following problems (hopfully):</p>
<ul>
<li>Locatable on <code>PATH</code> (is an <code>.exe</code> for Windows)</li>
<li>Can pipe/redirect data</li>
<li>Handles stdin prompts/interactivity</li>
<li>Supports ctrl+c interruptions</li>
<li>Passes parent signals to child processes (uses <code>execvp</code> on Unix)</li>
<li>Attempts to kill child processes on parent exit</li>
<li>Bubbles exit codes</li>
<li>Native performance</li>
<li>Doesn't require special privileges (no symlinks)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="upgrade-troubleshooting">Upgrade troubleshooting<a href="https://moonrepo.dev/blog/proto-v0.26#upgrade-troubleshooting" class="hash-link" aria-label="Direct link to Upgrade troubleshooting" title="Direct link to Upgrade troubleshooting">​</a></h2>
<p>Because this release adds a new executable (<code>proto-shim</code>), you'll most likely run into issues when
upgrading via <code>proto upgrade</code>. The root issue is that the upgrade process was only aware of the
single <code>proto</code> file, and not the new <code>proto-shim</code> file, so it will not copy the shim into the
correct location, and subsequent proto commands will fail.</p>
<p>We could backport this change to v0.25, but it would require all users to upgrade to that patch
version first before upgrading to v0.26. But this still wouldn't solve the issue for users upgrading
from v0.24, or an even earlier version.</p>
<p>The best way to remedy this situation is to simply
<a href="https://moonrepo.dev/docs/proto/install">re-install proto as a whole</a>. Once you're on v0.26, this will be a non-issue.</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token comment" style="color:#97a1af;font-style:italic"># Unix</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token function" style="color:#ff94ff;font-weight:bold">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:#fef9c3">-fsSL</span><span class="token plain"> https://moonrepo.dev/install/proto.sh </span><span class="token operator" style="color:#b7a9f9">|</span><span class="token plain"> </span><span class="token function" style="color:#ff94ff;font-weight:bold">bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Windows</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">irm https://moonrepo.dev/install/proto.ps1 </span><span class="token operator" style="color:#b7a9f9">|</span><span class="token plain"> iex</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/proto-v0.26#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/proto/releases/tag/v0.26.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added basic telemetry to track tool install/uninstall metrics.</li>
<li>Fixed an issue where binaries were being symlinked with broken versions in their file name (most
commonly for Python).</li>
</ul>]]></content:encoded>
            <category>proto</category>
            <category>shim</category>
        </item>
        <item>
            <title><![CDATA[proto v0.26 (rc) - Release candidate available for testing!]]></title>
            <link>https://moonrepo.dev/blog/proto-v0.26-rc</link>
            <guid>https://moonrepo.dev/blog/proto-v0.26-rc</guid>
            <pubDate>Tue, 19 Dec 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[We've got a very special release candidate that we'd love to stress test before an official release!]]></description>
            <content:encoded><![CDATA[<p>We've got a very special release candidate that we'd love to stress test before an official release!</p>
<p>proto at its core is a version manager, which means like most version managers, it relies on a
concept known as shims. Shims are lightweight executable scripts that act like a proxy to the
underlying binary, and are useful for proto to intercept executions and inject custom functionality,
like our dynamic version detection.</p>
<p>On Unix machines, we relied on Bash scripts for shims, which worked rather well. However, on
Windows, we relied on PowerShell scripts (<code>.ps1</code>), batch/cmd scripts (<code>.cmd</code>), and Bash scripts, all
with differing levels of functionality, and each serving a separate purpose. Windows support <em>did
not</em> work well.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="what-didnt-work">What didn't work?<a href="https://moonrepo.dev/blog/proto-v0.26-rc#what-didnt-work" class="hash-link" aria-label="Direct link to What didn't work?" title="Direct link to What didn't work?">​</a></h2>
<p>When using shims, you must ensure that all the following scenarios work well: piping data/commands,
redirection, stdin prompts, interactivity, signal handling, exit code bubbling, so on and so forth.
Bash solves a lot of this for us, but Windows does not have a native Bash shell, and thus we had to
rely on other scripting languages. The <code>.cmd</code> files barely supported any of this, and the <code>.ps1</code>
files were a bit better, but still not great.</p>
<p>For the most part, executing a shim as-is and doing basic work was fine, but once you needed a
complex scenario (like above), it broke down pretty quickly. It was also further exacerbated when
dealing with nested shim exections, for example, <code>npm</code> calls <code>node</code> under the hood. The parent shim
may be executed with <code>.ps1</code> but the child may be <code>.cmd</code>, and these do not play well together.</p>
<p>The other problem on Windows is that scripts are not true executables, and are not easily located on
<code>PATH</code> (excluding <code>.cmd</code> files).</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="whats-new">What's new?<a href="https://moonrepo.dev/blog/proto-v0.26-rc#whats-new" class="hash-link" aria-label="Direct link to What's new?" title="Direct link to What's new?">​</a></h2>
<p>To combat all of these problems, we needed a truly native solution, and that's exactly what we did.
We wrote our own Rust based executable, that will replace all of the custom shim scripts, and can
properly handle all of the required scenarios. This new executable is named <code>proto-shim</code>
(<code>proto-shim.exe</code> on Windows) and is published alongside the <code>proto</code> binary.</p>
<p>This new executable solves all of the following problems (hopfully):</p>
<ul>
<li>Locatable on <code>PATH</code> (is an <code>.exe</code> for Windows)</li>
<li>Can pipe/redirect data</li>
<li>Handles stdin prompts/interactivity</li>
<li>Supports ctrl+c interruptions</li>
<li>Passes parent signals to child processes</li>
<li>Attempts to kill child processes on parent exit</li>
<li>Bubbles exit codes</li>
<li>Native performance</li>
<li>Doesn't require special privileges (no symlinks)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="how-to-test">How to test?<a href="https://moonrepo.dev/blog/proto-v0.26-rc#how-to-test" class="hash-link" aria-label="Direct link to How to test?" title="Direct link to How to test?">​</a></h2>
<p>If you're interested in testing this new implementation (we'd appreciate it), you can do so by
downloading the latest release candidate from GitHub: <a href="https://github.com/moonrepo/proto/releases" target="_blank" rel="noopener noreferrer">https://github.com/moonrepo/proto/releases</a></p>
<p>Once downloaded, unpack the archive, and move the <code>proto</code> and <code>proto-shim</code> binaries to the
<code>~/.proto/bin</code> directory (or the location of your <code>PROTO_INSTALL_DIR</code> environment variable). From
here, you can execute <code>proto</code> or your tool binaries as normal.</p>
<div class="theme-admonition theme-admonition-warning admonition_WCGJ alert alert--warning"><div class="admonitionHeading_GCBg"><span class="admonitionIcon_L39b"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_pbrs"><p>If you run into issues, try deleting the old <code>~/.proto/shims</code> directory and trying again. If
problems still persist, please report an issue or reach out to us on Discord!</p></div></div>
<div class="theme-admonition theme-admonition-info admonition_WCGJ alert alert--info"><div class="admonitionHeading_GCBg"><span class="admonitionIcon_L39b"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_pbrs"><p>On macOS, you may need to add the binary to the trusted list, in your Priacy &amp; Security settings.
This can also be achieved on the command line with <code>xattr -c ~/.proto/bin/*</code>.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="what-to-test">What to test?<a href="https://moonrepo.dev/blog/proto-v0.26-rc#what-to-test" class="hash-link" aria-label="Direct link to What to test?" title="Direct link to What to test?">​</a></h2>
<p>Basically everything. We want to ensure that all of the functionality in <a href="https://moonrepo.dev/blog/proto-v0.26-rc#whats-new">What's new?</a>
works as expected, so simply go about your day to day development and let us know if you run into
any issues!</p>]]></content:encoded>
            <category>proto</category>
            <category>shim</category>
        </item>
        <item>
            <title><![CDATA[moon v1.18 - New task execution flow and custom project names]]></title>
            <link>https://moonrepo.dev/blog/moon-v1.18</link>
            <guid>https://moonrepo.dev/blog/moon-v1.18</guid>
            <pubDate>Tue, 12 Dec 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[With this release, we've focused heavily on 2 important aspects: task execution, and our onboarding]]></description>
            <content:encoded><![CDATA[<p>With this release, we've focused heavily on 2 important aspects: task execution, and our onboarding
flow.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-path-based-task-execution">New path based task execution<a href="https://moonrepo.dev/blog/moon-v1.18#new-path-based-task-execution" class="hash-link" aria-label="Direct link to New path based task execution" title="Direct link to New path based task execution">​</a></h2>
<p>Since moon's inception, before we would execute a task's command, we would locate its executable on
the file system and execute it directly. We went with this approach as we wanted to avoid all of the
baggage and "unknown behavior" that came with executing through a shell, and to ensure a more
deterministic outcome. This approach worked very well for stand-alone binaries, like <code>node</code>,
<code>cargo</code>, and built-in commands like <code>rm</code>, <code>mkdir</code>, and <code>git</code>.</p>
<p>However, it was very problematic in 2 scenarios: executables from language dependencies (Node.js
modules, etc), and multi-command based tasks (using <code>&amp;&amp;</code>). To remedy this situation, we're no longer
locating the executables ourselves, and instead are prepending <code>PATH</code> with the locations in which we
know these executables should exist. We're also loosening the restriction on the
<a href="https://moonrepo.dev/docs/config/project#shell"><code>shell</code> task option</a>, which can now be enabled for <em>all</em> tasks, not
just system tasks.</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="dependency-executables">Dependency executables<a href="https://moonrepo.dev/blog/moon-v1.18#dependency-executables" class="hash-link" aria-label="Direct link to Dependency executables" title="Direct link to Dependency executables">​</a></h3>
<p>For the 1st scenario, let's talk about Node.js modules. When we encountered an unknown task command,
like <code>eslint</code> or <code>prettier</code>, we'd attempt to locate its executable by traversing <code>node_modules/.bin</code>
directories, parsing Bash/PowerShell scripts, resolving the source <code>.js</code> files, and finally
executing with <code>node</code>. To demonstrate this, say you had the following task:</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">moon.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">format</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'prettier --write .'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When finally executed, internally it would become something like this command:</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">~/.proto/tools/node/</span><span class="token operator" style="color:#b7a9f9">&lt;</span><span class="token plain">version</span><span class="token operator" style="color:#b7a9f9">&gt;</span><span class="token plain">/bin/node </span><span class="token punctuation" style="color:#cad4e2">..</span><span class="token plain">/</span><span class="token punctuation" style="color:#cad4e2">..</span><span class="token plain">/node_modules/prettier/internal/cli.mjs </span><span class="token parameter variable" style="color:#fef9c3">--write</span><span class="token plain"> </span><span class="token builtin class-name" style="color:#ff94ff;font-weight:bold">.</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This was required since our runtime is Rust and we don't have access to Node.js's module resolution
algorithm... but this approach was very brittle and error prone. It took us many releases to iron
out all the bugs, and we're pretty sure there are still edge cases unaccounted for. So instead, as
mentioned above, we now prepend <code>PATH</code>, resulting in the following command:</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token assign-left variable environment constant" style="color:#ff94ff;font-weight:bold">PATH</span><span class="token operator" style="color:#b7a9f9">=</span><span class="token string" style="color:#c9e166">"/path/to/node_modules/.bin:/path/to/proto/tools:</span><span class="token string environment constant" style="color:#ff94ff;font-weight:bold">$PATH</span><span class="token string" style="color:#c9e166">"</span><span class="token plain"> prettier </span><span class="token parameter variable" style="color:#fef9c3">--write</span><span class="token plain"> </span><span class="token builtin class-name" style="color:#ff94ff;font-weight:bold">.</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This is a much cleaner approach and is far easier to understand as a user.</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="multi-command-tasks">Multi-command tasks<a href="https://moonrepo.dev/blog/moon-v1.18#multi-command-tasks" class="hash-link" aria-label="Direct link to Multi-command tasks" title="Direct link to Multi-command tasks">​</a></h3>
<p>While not officially supported in moon, it's been possible to run multiple commands in a single task
using <code>&amp;&amp;</code> syntax. However, this approach did not work correctly with our integrated toolchain, as
only the 1st command in the list would have its binary be located and executed correctly.</p>
<p>For example, say we wanted to run 2 npm packages, the following would <em>not</em> work:</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">moon.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'rm -rf dist &amp;&amp; vite build &amp;&amp; tsc --build'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>With this new <code>PATH</code> based approach, this will now work correctly. And furthermore, this also
enables executables within Bash and PowerShell scripts to be located and executed correctly as well.</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="whats-next">What's next?<a href="https://moonrepo.dev/blog/moon-v1.18#whats-next" class="hash-link" aria-label="Direct link to What's next?" title="Direct link to What's next?">​</a></h3>
<p>In the future, we'll continue to expand on this functionality, and our ultimate goal is to remove
the concept of <code>platform</code> from tasks, which has been a bit confusing for new users.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="customize-the-project-name-in-moonyml">Customize the project name in <code>moon.yml</code><a href="https://moonrepo.dev/blog/moon-v1.18#customize-the-project-name-in-moonyml" class="hash-link" aria-label="Direct link to customize-the-project-name-in-moonyml" title="Direct link to customize-the-project-name-in-moonyml">​</a></h2>
<p>This has been a long requested feature, but thanks to the project graph rework and improvements over
the last few releases, this is now possible. In <a href="https://moonrepo.dev/docs/config/project"><code>moon.yml</code></a>, you can now
configure the <a href="https://moonrepo.dev/docs/config/project#id"><code>id</code></a> setting to override the project name (identifier)
derived from <a href="https://moonrepo.dev/docs/config/workspace#projects"><code>projects</code></a> in
<a href="https://moonrepo.dev/docs/config/workspace"><code>.moon/workspace.yml</code></a> (most applicable to glob based project locations).</p>
<p>For example, say we have the following <code>projects</code> glob.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.moon/workspace.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">projects</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'apps/*'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">-</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'packages/*'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>By default, the project folder name becomes the project name. For the most part this is fine, but
what if you have a very large monorepo? Or have conflicting project names? Or are migrating
projects? It becomes difficult to manage and organize. But now, simply configure <code>id</code>!</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">&lt;project&gt;/moon.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">id</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'custom-project-name'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info admonition_WCGJ alert alert--info"><div class="admonitionHeading_GCBg"><span class="admonitionIcon_L39b"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_pbrs"><p>Be sure that all targets, project dependencies, task dependencies, and other references are using
the new identifier, otherwise an error will be triggered!</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="improved-onboarding-flow">Improved onboarding flow<a href="https://moonrepo.dev/blog/moon-v1.18#improved-onboarding-flow" class="hash-link" aria-label="Direct link to Improved onboarding flow" title="Direct link to Improved onboarding flow">​</a></h2>
<p>While this doesn't affect current users, we still want to announce that we've made some slight
changes to our onboarding process and the <a href="https://moonrepo.dev/docs/commands/init"><code>moon init</code></a> command. The previous
command prompted far too many questions, as we would attempt to detect what languages are currently
in use, and integrate them into the toolchain.</p>
<p>This was confusing for new users, so starting with this release, we've simplified the process to
only create the moon workspace within a repository.</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">moon init</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>With that being said, you can still integrate tools into the toolchain, by passing the identifier of
a supported moon tool as an argument.</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">moon init </span><span class="token function" style="color:#ff94ff;font-weight:bold">node</span><span class="token plain"> </span><span class="token comment" style="color:#97a1af;font-style:italic"># bun, rust, etc</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-success admonition_WCGJ alert alert--success"><div class="admonitionHeading_GCBg"><span class="admonitionIcon_L39b"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>success</div><div class="admonitionContent_pbrs"><p>We've also rewritten a good portion of the "<a href="https://moonrepo.dev/docs/setup-workspace">Getting started</a>" documentation
to reflect these changes!</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/moon-v1.18#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.18.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Improved string allocation and performance for queries, task tokens, and process commands.</li>
<li>Improved remote caching flow and handling.</li>
<li>Updated proto to v0.25.</li>
</ul>]]></content:encoded>
            <category>toolchain</category>
            <category>shell</category>
            <category>id</category>
            <category>name</category>
            <category>project</category>
            <category>init</category>
            <category>onboarding</category>
        </item>
        <item>
            <title><![CDATA[proto v0.25 - Linux arm64 gnu and musl support]]></title>
            <link>https://moonrepo.dev/blog/proto-v0.25</link>
            <guid>https://moonrepo.dev/blog/proto-v0.25</guid>
            <pubDate>Mon, 11 Dec 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[This is a very small release that primarily adds support for Linux arm64 targets.]]></description>
            <content:encoded><![CDATA[<p>This is a very small release that primarily adds support for Linux arm64 targets.</p>
<p>Thanks to <a href="https://github.com/axodotdev/cargo-dist" target="_blank" rel="noopener noreferrer">cargo-dist</a>, we can now build and distribute
arm64 binaries with relative ease. When building the binary, libraries are statically linked to
ensure that the binary can run on any Linux distribution.</p>
<p>You can download the binary from the official
<a href="https://github.com/moonrepo/proto/releases/tag/v0.21.0" target="_blank" rel="noopener noreferrer">GitHub release</a> or by running the
<a href="https://moonrepo.dev/docs/proto/install#linux-macos-wsl">Bash installation script</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/proto-v0.25#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/proto/releases/tag/v0.25.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added a <a href="https://moonrepo.dev/docs/proto/commands/debug/config"><code>proto debug config</code></a> command, to debug all loaded
configs and the final merged config.</li>
<li>Added a <code>PROTO_BYPASS_VERSION_CHECK</code> environment variable, to bypass loading and checking of
versions.</li>
</ul>]]></content:encoded>
            <category>proto</category>
            <category>linux</category>
            <category>musl</category>
            <category>gnu</category>
            <category>arm64</category>
        </item>
        <item>
            <title><![CDATA[proto v0.24 - Standardized configuration and 10x WASM boost]]></title>
            <link>https://moonrepo.dev/blog/proto-v0.24</link>
            <guid>https://moonrepo.dev/blog/proto-v0.24</guid>
            <pubDate>Thu, 07 Dec 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[In this release, we've standardized our configuration from the ground-up.]]></description>
            <content:encoded><![CDATA[<p>In this release, we've standardized our configuration from the ground-up.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="improved-wasm-performance-up-to-20x">Improved WASM performance up to 20x<a href="https://moonrepo.dev/blog/proto-v0.24#improved-wasm-performance-up-to-20x" class="hash-link" aria-label="Direct link to Improved WASM performance up to 20x" title="Direct link to Improved WASM performance up to 20x">​</a></h2>
<p>Before we dive into the major changes of this release, we want to highlight the performance
improvements that have landed recently. Thanks to <a href="https://dylibso.com/" target="_blank" rel="noopener noreferrer">Dylibso</a> and the
<a href="https://extism.org/" target="_blank" rel="noopener noreferrer">Extism</a> team, we've been able to improve the performance of our WASM plugins
by 10-20x! This was achieved by plugging into wasmtime's ahead-of-time (AOT) compiler and caching
layer.</p>
<p>Here's an example of the performance improvements when running <code>node --version</code>. On older versions,
the execution time was anywhere from 100ms-200ms, but is now down to 10-20ms! This is almost as fast
as native's 5-10ms!</p>
<div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token comment" style="color:#97a1af;font-style:italic"># proto v0.23.5 and below</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">hyperfine </span><span class="token parameter variable" style="color:#fef9c3">--warmup</span><span class="token plain"> </span><span class="token number" style="color:#94dded">10</span><span class="token plain"> -- </span><span class="token string" style="color:#c9e166">'node --version'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">Benchmark </span><span class="token number" style="color:#94dded">1</span><span class="token plain">: </span><span class="token function" style="color:#ff94ff;font-weight:bold">node</span><span class="token plain"> </span><span class="token parameter variable" style="color:#fef9c3">--version</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  Time </span><span class="token punctuation" style="color:#cad4e2">(</span><span class="token plain">mean ± σ</span><span class="token punctuation" style="color:#cad4e2">)</span><span class="token plain">:      </span><span class="token number" style="color:#94dded">99.2</span><span class="token plain"> ms ±   </span><span class="token number" style="color:#94dded">6.3</span><span class="token plain"> ms    </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token plain">User: </span><span class="token number" style="color:#94dded">662.5</span><span class="token plain"> ms, System: </span><span class="token number" style="color:#94dded">79.4</span><span class="token plain"> ms</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  Range </span><span class="token punctuation" style="color:#cad4e2">(</span><span class="token plain">min … max</span><span class="token punctuation" style="color:#cad4e2">)</span><span class="token plain">:    </span><span class="token number" style="color:#94dded">91.3</span><span class="token plain"> ms … </span><span class="token number" style="color:#94dded">119.7</span><span class="token plain"> ms    </span><span class="token number" style="color:#94dded">29</span><span class="token plain"> runs</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># proto v0.23.6 and above</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">hyperfine </span><span class="token parameter variable" style="color:#fef9c3">--warmup</span><span class="token plain"> </span><span class="token number" style="color:#94dded">10</span><span class="token plain"> -- </span><span class="token string" style="color:#c9e166">'node --version'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">Benchmark </span><span class="token number" style="color:#94dded">1</span><span class="token plain">: </span><span class="token function" style="color:#ff94ff;font-weight:bold">node</span><span class="token plain"> </span><span class="token parameter variable" style="color:#fef9c3">--version</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  Time </span><span class="token punctuation" style="color:#cad4e2">(</span><span class="token plain">mean ± σ</span><span class="token punctuation" style="color:#cad4e2">)</span><span class="token plain">:      </span><span class="token number" style="color:#94dded">18.5</span><span class="token plain"> ms ±   </span><span class="token number" style="color:#94dded">1.0</span><span class="token plain"> ms    </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token plain">User: </span><span class="token number" style="color:#94dded">7.9</span><span class="token plain"> ms, System: </span><span class="token number" style="color:#94dded">12.7</span><span class="token plain"> ms</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  Range </span><span class="token punctuation" style="color:#cad4e2">(</span><span class="token plain">min … max</span><span class="token punctuation" style="color:#cad4e2">)</span><span class="token plain">:    </span><span class="token number" style="color:#94dded">17.1</span><span class="token plain"> ms …  </span><span class="token number" style="color:#94dded">23.8</span><span class="token plain"> ms    </span><span class="token number" style="color:#94dded">146</span><span class="token plain"> runs</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-success admonition_WCGJ alert alert--success"><div class="admonitionHeading_GCBg"><span class="admonitionIcon_L39b"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>success</div><div class="admonitionContent_pbrs"><p>Dylibso is hosting an <a href="https://dylibso.com/events/2023/hack-for-good/" target="_blank" rel="noopener noreferrer">Extism hackathon</a> through the
month of December, that'll donate to children in need. Check it out and participate!</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="standardized-configuration-breaking">Standardized configuration (breaking)<a href="https://moonrepo.dev/blog/proto-v0.24#standardized-configuration-breaking" class="hash-link" aria-label="Direct link to Standardized configuration (breaking)" title="Direct link to Standardized configuration (breaking)">​</a></h2>
<p>Up until now, proto has supported 2 types of configuration, <code>.prototools</code> and
<code>~/.proto/config.toml</code>. The former can exist in any folder, and is used for pinning versions and
defining plugins. The latter is a per-user file that is used for customizing how proto works and
also defining plugins.</p>
<p>Over time, functionality in both of these files has grown, and so has the overlap between them. We
felt it was time to standardize these files into a single configuration file, and as such, have
removed <code>~/.proto/config.toml</code> and merged its functionality into
<a href="https://moonrepo.dev/docs/proto/config"><code>.prototools</code></a>. The biggest changes are:</p>
<ul>
<li>proto settings (like <code>auto-clean</code> and <code>http</code>) must now exist within a
<a href="https://moonrepo.dev/docs/proto/config#settings"><code>[settings]</code> table</a>.</li>
<li>Tool specific settings (like <code>node-intercept-globals</code>) have moved to the new
<a href="https://moonrepo.dev/docs/proto/config#tools"><code>[tools.node]</code> table</a> (<a href="https://moonrepo.dev/blog/proto-v0.24#tool-level-settings">more info below</a>).</li>
<li>Plugins are still configured within a <a href="https://moonrepo.dev/docs/proto/config#plugins"><code>[plugins]</code> table</a>.</li>
<li>Global/default settings can be defined in <code>~/.proto/.prototools</code>.</li>
</ul>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.prototools</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key property" style="color:#b7a9f9">node</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"20.0.0"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">settings</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">auto-clean</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token boolean" style="color:#94dded">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">settings.http</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">allow-invalid-certs</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token boolean" style="color:#94dded">true</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The other massive benefit of this change, is that settings <em>can now be defined anywhere</em>!
Previously, settings like <code>auto-clean</code> or <code>detect-strategy</code> could only be defined at the user-level,
but what if your company or team wanted to control this setting? It wasn't possible without asking
all team members to update their configuration manually. With this change, settings can now be tied
to projects or repositories!</p>
<div class="theme-admonition theme-admonition-info admonition_WCGJ alert alert--info"><div class="admonitionHeading_GCBg"><span class="admonitionIcon_L39b"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_pbrs"><p>After upgrading, run <code>proto migrate v0.24</code> to migrate the old user configuration to the new format!</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="tool-level-settings">Tool-level settings<a href="https://moonrepo.dev/blog/proto-v0.24#tool-level-settings" class="hash-link" aria-label="Direct link to Tool-level settings" title="Direct link to Tool-level settings">​</a></h3>
<p>While working on these configuration changes, we also landed the
<a href="https://github.com/moonrepo/proto/issues/261" target="_blank" rel="noopener noreferrer">Tool-level configuration RFC</a>, although with a
different implementation. This enables users to define settings that will be passed to the WASM
plugin of a specific tool, controlling how it works. These settings can be configured with the new
<a href="https://moonrepo.dev/docs/proto/config#tools"><code>[tools.&lt;name&gt;]</code> table</a>.</p>
<p>For example, the <code>node</code> tool has a setting called <code>intercept-globals</code>, which will trigger an error
when npm/pnpm/yarn attempt to install a global package.</p>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.prototools</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">tools.go</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">gobin</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token boolean" style="color:#94dded">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">tools.node</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">intercept-globals</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token boolean" style="color:#94dded">false</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As of now, only the <a href="https://github.com/moonrepo/node-plugin" target="_blank" rel="noopener noreferrer">Node.js</a> and
<a href="https://github.com/moonrepo/go-plugin" target="_blank" rel="noopener noreferrer">Go</a> plugins support settings.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="moved-aliases-and-default-versions-breaking">Moved aliases and default versions (breaking)<a href="https://moonrepo.dev/blog/proto-v0.24#moved-aliases-and-default-versions-breaking" class="hash-link" aria-label="Direct link to Moved aliases and default versions (breaking)" title="Direct link to Moved aliases and default versions (breaking)">​</a></h2>
<p>To continue with these configuration changes, we've also moved aliases and the default version into
this new configuration. Previously, both of these values were stored in
<code>~/.proto/tools/&lt;name&gt;/manifest.json</code>, but the problem was, that this file is internally managed by
proto, and should not be modified by users. This made it difficult for users to manage, and to
persist these values across machines (think dotfile syncing).</p>
<p>Now these values are stored in <a href="https://moonrepo.dev/docs/proto/config"><code>.prototools</code></a>, with aliases being configured in
<a href="https://moonrepo.dev/docs/proto/config#toolsaliases"><code>[tools.&lt;name&gt;.aliases]</code></a>, and the default version (global) being
pinned as a version in <code>~/.proto/.prototools</code>. Here's an example:</p>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">~/.proto/.prototools</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key property" style="color:#b7a9f9">node</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"20.0.0"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token table class-name" style="color:#ff94ff;font-weight:bold">tools.node.aliases</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key property" style="color:#b7a9f9">work</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"18"</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This change also enables aliases to be defined anywhere! Previously, aliases were only allowed to be
defined globally for a user, but now they can be defined per-project, or even per-directory.</p>
<div class="theme-admonition theme-admonition-info admonition_WCGJ alert alert--info"><div class="admonitionHeading_GCBg"><span class="admonitionIcon_L39b"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_pbrs"><p>After upgrading, run <code>proto migrate v0.24</code> to migrate your aliases and default versions to the new
configuration format!</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/proto-v0.24#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/proto/releases/tag/v0.24.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>proto now supports <a href="https://moonrepo.dev/docs/proto/install#canary-releases">canary</a> and
<a href="https://moonrepo.dev/docs/proto/install#nightly-releases">nightly</a> releases.</li>
<li>Updated non-latest plugins to be cached for 30 days, instead of forever.</li>
<li>Fixed an issue where resolving canary versions wouldn't work correctly.</li>
</ul>]]></content:encoded>
            <category>proto</category>
            <category>config</category>
            <category>tools</category>
        </item>
        <item>
            <title><![CDATA[moon v1.17 - Full Bun support, TypeScript improvements, and more!]]></title>
            <link>https://moonrepo.dev/blog/moon-v1.17</link>
            <guid>https://moonrepo.dev/blog/moon-v1.17</guid>
            <pubDate>Mon, 20 Nov 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[In this release, we've focused heavily on the JavaScript and TypeScript ecosystems, by improving our]]></description>
            <content:encoded><![CDATA[<p>In this release, we've focused heavily on the JavaScript and TypeScript ecosystems, by improving our
implementations, and providing full Bun support.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="bun-tier-1-2-and-3-support">Bun tier 1, 2, and 3 support<a href="https://moonrepo.dev/blog/moon-v1.17#bun-tier-1-2-and-3-support" class="hash-link" aria-label="Direct link to Bun tier 1, 2, and 3 support" title="Direct link to Bun tier 1, 2, and 3 support">​</a></h2>
<p>Yes you read that right! Not just 1 tier, not just 2 tiers, but all 3 language tiers have been
implemented for Bun, providing <a href="https://moonrepo.dev/docs/how-it-works/languages">full language support</a>, and parity
with Node.js. Thanks to the Bun work in <a href="https://moonrepo.dev/proto">proto</a> and the previous
<a href="https://moonrepo.dev/blog/moon-v1.16">v1.16 release</a>, we were able to add full Bun support with relative easy.</p>
<p>So what does Bun support look like? To start, you can now configure a
<a href="https://moonrepo.dev/docs/config/toolchain#bun"><code>bun</code></a> setting in <a href="https://moonrepo.dev/docs/config/toolchain"><code>.moon/toolchain.yml</code></a>,
including an optional <code>version</code> to download and install, and settings similar to Node.js.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.moon/toolchain.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">bun</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">version</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'1.0.13'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">syncProjectWorkspaceDependencies</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">true</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This will enable the <code>bun</code> platform and the following integrations are applied:</p>
<ul>
<li>Will automatically download and install Bun for the configured version.</li>
<li>Will install dependencies using <code>bun install</code> (deduping currently not supported).</li>
<li>Will parse <code>bun.lockb</code> for dependency resolution and task hashing.</li>
<li>Will use <code>bunx</code> instead of <code>npx</code> for one-off package executions.</li>
<li>Can execute <code>bun</code> commands within tasks.</li>
</ul>
<p>With the <code>bun</code> platform enabled, you can now configure the platform for projects and tasks (is
automatically detected when running the <code>bun</code> or <code>bunx</code> commands).</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">&lt;project&gt;/moon.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token comment" style="color:#97a1af;font-style:italic"># Default platform for all tasks (optional)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key atrule">platform</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'bun'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token key atrule">tasks</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">dev</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'bun run dev'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">test</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'bun test'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">lint</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'eslint .'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token comment" style="color:#97a1af;font-style:italic"># Only required for npm packages (if not defined above)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">platform</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'bun'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="typescript-improvements">TypeScript improvements<a href="https://moonrepo.dev/blog/moon-v1.17#typescript-improvements" class="hash-link" aria-label="Direct link to TypeScript improvements" title="Direct link to TypeScript improvements">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="configure-the-root-directory">Configure the root directory<a href="https://moonrepo.dev/blog/moon-v1.17#configure-the-root-directory" class="hash-link" aria-label="Direct link to Configure the root directory" title="Direct link to Configure the root directory">​</a></h3>
<p>When moon was first designed, it was designed for JavaScript based monorepos. Because of this, there
were a handful of assumptions that still exist today, one of which is that the moon workspace root
was assumed to be the JavaScript and TypeScript root. The root is extremely important in resolving
relative paths for project references and other path based functionality, so using the workspace
root made the most sense.</p>
<p>However, what if your TypeScript root isn't the workspace root? Or the TypeScript root and
JavaScript root are different? Well, you were out of luck... until now! We're introducing a new
setting called <a href="https://moonrepo.dev/docs/config/toolchain#root"><code>typescript.root</code></a>, that denotes the root directory for
TypeScript related functionality (relative from moon's workspace root).</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.moon/toolchain.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">typescript</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">root</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'./typescript'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="include-shared-types">Include shared types<a href="https://moonrepo.dev/blog/moon-v1.17#include-shared-types" class="hash-link" aria-label="Direct link to Include shared types" title="Direct link to Include shared types">​</a></h3>
<p>Another common TypeScript practice is to have shared <code>.d.ts</code> types that are used across multiple
projects, or to augment third-party types. This is so common that we felt obligated to support it in
some capacity within moon. With that said, we're introducing a new setting,
<a href="https://moonrepo.dev/docs/config/toolchain#includesharedtypes"><code>typescript.includeSharedTypes</code></a>.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.moon/toolchain.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">typescript</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">includeSharedTypes</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">true</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When enabled, we'll automatically sync the shared types path to the <code>include</code> field of all relevant
project <code>tsconfig.json</code>s. However, for this to work correctly, the shared types <em>must</em> exist in a
<code>types</code> folder relative from the <a href="https://moonrepo.dev/blog/moon-v1.17#configure-the-root-directory">TypeScript root</a>.</p>
<p>For example, if the TypeScript root is <code>/</code>, and shared types is <code>/types</code>, then all packages in
<code>/packages/*</code> will be updated with the following:</p>
<div class="language-json codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">packages/example/tsconfig.json</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-json codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token property" style="color:#b7a9f9">"include"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">"../../types/**/*"</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">}</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>This setting can be overridden on a per-project basis.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="include-sources-of-project-references">Include sources of project references<a href="https://moonrepo.dev/blog/moon-v1.17#include-sources-of-project-references" class="hash-link" aria-label="Direct link to Include sources of project references" title="Direct link to Include sources of project references">​</a></h3>
<p>Continuing with <code>include</code> related functionality, we've introducing yet another new setting,
<a href="https://moonrepo.dev/docs/config/toolchain#includeprojectreferencesources"><code>typescript.includeProjectReferenceSources</code></a>,
which does exactly as its name implies. It automatically appends the sources (<code>**/*</code>) of all project
references to the <code>include</code> field of all relevant project <code>tsconfig.json</code>s.</p>
<p>This is useful (and sometimes required) for the following reasons:</p>
<ul>
<li>It makes files within a referenced project available for import into the consuming project. This
is required for "press tab to auto-import" nested/deep files, otherwise only index imports will
work (and barrel files are costly).</li>
<li>It also improves the editor experience by making the source files available for intellisense,
autocomplete, and other features.</li>
</ul>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.moon/toolchain.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">typescript</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">includeProjectReferenceSources</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">true</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To understand this functionality, say you have a project with the following <code>tsconfig.json</code>, and
this project depends on 2 other projects: ui and utils.</p>
<div class="language-json codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">packages/example/tsconfig.json</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-json codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token property" style="color:#b7a9f9">"compilerOptions"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token property" style="color:#b7a9f9">"include"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">"src/**/*"</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">}</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When our syncing process occurs, we'll automatically sync project references, and include referenced
sources, like so.</p>
<div class="language-json codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">packages/example/tsconfig.json</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-json codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token property" style="color:#b7a9f9">"compilerOptions"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token property" style="color:#b7a9f9">"include"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">"src/**/*"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"../ui/**/*"</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"../utils/**/*"</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token property" style="color:#b7a9f9">"references"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"> </span><span class="token property" style="color:#b7a9f9">"path"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"../ui"</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"> </span><span class="token property" style="color:#b7a9f9">"path"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"../utils"</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">}</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>This setting can also be overridden on a per-project basis.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="javascript-improvements">JavaScript improvements<a href="https://moonrepo.dev/blog/moon-v1.17#javascript-improvements" class="hash-link" aria-label="Direct link to JavaScript improvements" title="Direct link to JavaScript improvements">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="supporting-the-single-version-policy-pattern">Supporting the "single version policy" pattern<a href="https://moonrepo.dev/blog/moon-v1.17#supporting-the-single-version-policy-pattern" class="hash-link" aria-label="Direct link to Supporting the &quot;single version policy&quot; pattern" title="Direct link to Supporting the &quot;single version policy&quot; pattern">​</a></h3>
<p>If you're unfamiliar with the single version policy, or the one version rule, it's a pattern that
only allows dependencies to be configured in a single location, typically the root <code>package.json</code>.
This pattern forces <em>all</em> projects in a monorepo to use the same dependencies, and avoid the package
<code>workspaces</code> functionality.</p>
<p>This pattern was previously not possible in moon, as our automatic dependency installation process
did not account for it, and it would either install in the root if using <code>workspaces</code>, or in a
project otherwise. To support this pattern, we're introducing the new setting
<a href="https://moonrepo.dev/docs/config/toolchain#rootpackageonly"><code>node.rootPackageOnly</code></a> for Node.js, and
<code>bun.rootPackageOnly</code> for Bun.</p>
<div class="language-yaml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.moon/toolchain.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yaml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">node</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">rootPackageOnly</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#94dded">true</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When enabled, we'll only install dependencies in the workspace root, regardless of other settings or
how <code>package.json</code>s are configured. However, this setting <em>does not</em> verify that other
<code>package.json</code>s <em>do not</em> have dependencies. It's up to you to ensure that other <code>package.json</code>s do
not have dependencies.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/moon-v1.17#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/moon/releases/tag/v1.17.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Updated automatic dependency linking to use the <code>build</code> scope instead of <code>peer</code> scope. This should
alleviate some of the pain points with <code>package.json</code> syncing.</li>
<li>Improved project reference syncing and edge case handling.</li>
</ul>]]></content:encoded>
            <category>bun</category>
            <category>typescript</category>
            <category>javascript</category>
        </item>
        <item>
            <title><![CDATA[proto v0.23 - New detection strategy, tool commands, and more]]></title>
            <link>https://moonrepo.dev/blog/proto-v0.23</link>
            <guid>https://moonrepo.dev/blog/proto-v0.23</guid>
            <pubDate>Thu, 16 Nov 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[With this release, we've reorganized our commands, improved version detection, and Windows support.]]></description>
            <content:encoded><![CDATA[<p>With this release, we've reorganized our commands, improved version detection, and Windows support.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-detect-strategy-setting">New <code>detect-strategy</code> setting<a href="https://moonrepo.dev/blog/proto-v0.23#new-detect-strategy-setting" class="hash-link" aria-label="Direct link to new-detect-strategy-setting" title="Direct link to new-detect-strategy-setting">​</a></h2>
<p>Up until now, when proto would attempt to detect a version, it would use a version from the closest
<code>.prototools</code> file, or tool specific file (<code>package.json</code>, <code>.nvmrc</code>, etc), which ever matched first.
For the most part, this works great, but what if you wanted <code>.prototools</code> to take precedence over
other files, even if found in a higher parent directory? You unfortunately couldn't.</p>
<p>To support this new flow, we're introducing a new <a href="https://moonrepo.dev/docs/proto/config"><code>~/.proto/config.toml</code></a>
setting called <a href="https://moonrepo.dev/docs/proto/config#detect-strategy"><code>detect-strategy</code></a>. This setting supports the
following values, with more possibly in the future!</p>
<ul>
<li><code>first-available</code> (default) - Will use the first available version that is found. Either from
<code>.prototools</code> or a tool specific file.</li>
<li><code>prefer-prototools</code> - Prefer a <code>.prototools</code> version, even if found in a parent directory. If none
found, falls back to tool specific file.</li>
</ul>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">~/.proto/config.toml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key property" style="color:#b7a9f9">detect-strategy</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">=</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"prefer-prototools"</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-proto-tool-command-group-breaking">New <code>proto tool</code> command group (breaking)<a href="https://moonrepo.dev/blog/proto-v0.23#new-proto-tool-command-group-breaking" class="hash-link" aria-label="Direct link to new-proto-tool-command-group-breaking" title="Direct link to new-proto-tool-command-group-breaking">​</a></h2>
<p>Our CLI surface area has been growing and we felt it was time to start grouping commands, starting
with the new <a href="https://moonrepo.dev/docs/proto/commands/plugin"><code>proto tool</code></a> command. This command will contain "not
used very often" subcommands in relation to tools and their plugins, primarily for managing plugins,
and viewing tool information and inventory. As such, we've deprecated and moved the following
top-level commands:</p>
<ul>
<li>Moved <code>proto add-plugin</code> to <code>proto tool add</code>.</li>
<li>Moved <code>proto remove-plugin</code> to <code>proto tool remove</code>.</li>
<li>Moved <code>proto plugins</code> to <code>proto tool list-plugins</code>.</li>
<li>Moved <code>proto tools</code> to <code>proto tool list</code>.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-proto-tool-info-command">New <code>proto tool info</code> command<a href="https://moonrepo.dev/blog/proto-v0.23#new-proto-tool-info-command" class="hash-link" aria-label="Direct link to new-proto-tool-info-command" title="Direct link to new-proto-tool-info-command">​</a></h2>
<p>Continuing with the changes above, we're also introducing a new command,
<a href="https://moonrepo.dev/docs/proto/commands/plugin/info"><code>proto tool info</code></a>, which displays detailed information about a
tool and its backing plugin. For example:</p>
<div class="codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-text codeBlock_RMoD thin-scrollbar" style="background-color:#00080f;color:#e5e9f1"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ proto tool info node</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">node - Node.js</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">Inventory</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  Store: ~/.proto/tools/node</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  Executable: ~/.proto/tools/node/20.0.0/bin/node</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  Globals directory: ~/.proto/tools/node/globals/bin</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  Binaries:</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    - ~/.proto/bin/node (primary)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  Shims:</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    - ~/.proto/shims/node (primary)</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">Plugin</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  Version: 0.5.2</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  Source: https://github.com/moonrepo/node-plugin/releases/download/v0.5.2/node_plugin.wasm</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>This command also supports JSON output via <code>--json</code>.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a href="https://moonrepo.dev/blog/proto-v0.23#other-changes" class="hash-link" aria-label="Direct link to Other changes" title="Direct link to Other changes">​</a></h2>
<p>View the <a href="https://github.com/moonrepo/proto/releases/tag/v0.23.0" target="_blank" rel="noopener noreferrer">official release</a> for a full list
of changes.</p>
<ul>
<li>Added support to plugins to ignore certain paths when detecting a version.</li>
<li>Updated Windows to create 3 shim files for each tool: <code>.cmd</code> (cmd.exe), <code>.ps1</code> (powershell), and
no extension (bash).</li>
</ul>]]></content:encoded>
            <category>proto</category>
        </item>
    </channel>
</rss>